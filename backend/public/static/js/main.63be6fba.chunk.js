(this["webpackJsonpaibrush-frontend"]=this["webpackJsonpaibrush-frontend"]||[]).push([[0],{110:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));n(1);var a=n(20),r=n(0),s=function(e){var t=e.aspectRatio,n=e.onChange,s=e.disabled,i=a.b[t];return Object(r.jsxs)("div",{className:"form-group",children:[Object(r.jsx)("div",{style:{minHeight:"140px",display:"flex",alignItems:"center"},children:Object(r.jsx)("div",{style:{width:i.width/8,height:i.height/8,border:"1px dashed white",margin:"auto"}})}),Object(r.jsxs)("label",{style:{width:"100%"},children:["Aspect Ratio",Object(r.jsx)("small",{className:"form-text text-muted",style:{float:"right"},children:i.displayName})]}),Object(r.jsx)("input",{type:"range",disabled:s,className:"form-control-range",min:0,max:a.b.length-1,value:t,onChange:function(e){n(parseInt(e.target.value))}})]})}},115:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));n(1);var a=n(0),r=function(e){var t=e.selectedColor,n=e.color,r=e.onClick,s="palette-button";return t===n?s+=" selected":"#000000"==n&&(s+=" black"),Object(a.jsx)("div",{className:s,style:{backgroundColor:n},onClick:function(){return r(n)}})}},119:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(4),r=n(1),s=n(0),i=function(e){var t=e.pendingCount,n=e.processingCount,i=e.onClick,c=Object(r.useState)(!1),o=Object(a.a)(c,2),u=o[0],l=o[1],d=Object(s.jsx)("i",{style:{marginTop:"20px"},className:"fa fa-hourglass-half"});return n>0&&(d=Object(s.jsx)("i",{style:{marginTop:"20px"},className:"fa fa-cog fa-spin"})),Object(s.jsxs)("div",{onMouseEnter:function(){return l(!0)},onMouseLeave:function(){return l(!1)},style:{backgroundImage:"url(/images/default.png)",backgroundSize:"contain",width:"128px",height:"128px",margin:"8px",float:"left",cursor:"pointer"},onClick:i,children:[u&&Object(s.jsxs)("div",{style:{background:"rgba(255, 255, 255, 0.5)",color:"black",width:"100%",height:"100%",lineHeight:"1",fontSize:"20px"},children:[Object(s.jsx)("br",{}),t>0&&Object(s.jsxs)("div",{style:{marginBottom:"24px"},children:[t," pending"]}),n>0&&Object(s.jsxs)("div",{children:[n," processing"]})]}),!u&&Object(s.jsx)("div",{style:{background:"rgba(255, 255, 255, 0.3)",color:"#555",width:"100%",height:"100%",fontSize:"80px"},children:d})]})}},120:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));n(1);var a=n(26),r=n(0),s=function(e){var t=e.images,n=e.onDeleteImage,s=e.onCancel,i=e.show;function c(e){return"pending"===e.status?Object(r.jsx)("i",{className:"fa fa-hourglass-half"}):"processing"===e.status?Object(r.jsx)("i",{className:"fa fa-cog fa-spin"}):void 0}var o=Object(r.jsxs)("div",{children:[Object(r.jsxs)("div",{style:{marginBottom:"8px"},children:[Object(r.jsx)("div",{style:{display:"inline-block",width:"100px"},children:"Status"}),Object(r.jsx)("div",{style:{display:"inline-block",width:"250px"},children:"Phrases"}),Object(r.jsx)("div",{style:{display:"inline-block",width:"100px"},children:"Action"})]}),t.map((function(e){return Object(r.jsxs)("div",{style:{marginBottom:"8px"},children:[Object(r.jsxs)("div",{style:{display:"inline-block",width:"100px"},children:[c(e),"\xa0",e.status]}),Object(r.jsx)("div",{style:{display:"inline-block",width:"250px"},children:(t=e.params.prompt||"",t.length>35?t.substring(0,35)+"...":t)}),Object(r.jsx)("div",{style:{display:"inline-block",width:"100px"},children:Object(r.jsxs)("button",{className:"btn btn-danger btn-sm image-popup-delete-button",onClick:function(){return n(e)},children:[Object(r.jsx)("i",{className:"fa fa-trash"}),"\xa0Delete"]})})]},e.id);var t}))]});return Object(r.jsxs)(a.a,{show:i,onHide:s,children:[Object(r.jsx)(a.a.Header,{closeButton:!0,children:Object(r.jsx)(a.a.Title,{children:"Pending Images"})}),Object(r.jsx)(a.a.Body,{children:o}),Object(r.jsx)(a.a.Footer,{children:Object(r.jsx)("button",{className:"btn btn-secondary",onClick:s,children:"Close"})})]})}},121:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(4),r=n(1),s=n(26),i=n(15),c=n(108),o=n(0),u=function(e){var t=e.text,n=Object(r.useState)(!1),s=Object(a.a)(n,2),i=s[0],u=s[1];return Object(o.jsx)(c.CopyToClipboard,{text:t,onCopy:function(){u(!0),setTimeout((function(){return u(!1)}),5e3)},children:Object(o.jsx)("span",{style:{cursor:"pointer",marginLeft:"8px"},children:Object(o.jsx)("i",{className:"fas fa-".concat(i?"check":"copy"),style:{color:i?"green":void 0}})})})},l=function(e){var t=e.assetsUrl,n=e.image,c=e.censorNSFW,l=e.onClose,d=e.onDelete,h=e.onFork,f=e.onEdit,p=e.onNSFW,b=e.onSave,m=Object(r.useRef)(null),g="".concat(t,"/").concat(n.id,".image.png?updated_at=").concat(n.updated_at);n.imageData&&(g=n.imageData);n.score;n.params.negative_prompt&&0!=n.negative_score&&n.negative_score;var j=Object(r.useState)(!1),v=Object(a.a)(j,2),O=v[0],x=v[1];Object(r.useEffect)((function(){m.current&&(m.current.onerror=function(){m.current&&(m.current.src="/images/default.png")})}),[m]);var y=n.label;return y||(y=n.params.prompt),y.indexOf(",")>0&&(y=y.substring(0,y.indexOf(","))),Object(o.jsxs)(s.a,{show:!0,onHide:l,size:"xl",children:[Object(o.jsx)(s.a.Header,{closeButton:!0,children:Object(o.jsx)(s.a.Title,{children:y})}),Object(o.jsxs)(s.a.Body,{children:[Object(o.jsx)("img",{ref:m,style:{maxWidth:"100%",maxHeight:"1024px",display:"block",marginLeft:"auto",marginRight:"auto",filter:n.nsfw&&c&&!O?"blur(30px)":""},id:"image-popup-".concat(n.id),src:g,alt:n.label}),Object(o.jsx)("div",{className:"row",children:Object(o.jsx)("div",{className:"col-lg-12"})}),Object(o.jsx)("div",{className:"row",children:Object(o.jsxs)("div",{className:"col-lg-12",children:[Object(o.jsxs)("div",{className:"image-popup-controls",style:{marginTop:"40px"},children:[function(e){var t=e.charAt(0).toUpperCase()+e.slice(1),n="fa fa-question-circle";switch(e){case i.c.Pending:n="fas fa-hourglass-half";break;case i.c.Processing:n="fas fa-cog fa-spin";break;case i.c.Completed:n="fas fa-check";break;case i.c.Saved:n="fas fa-save";break;case i.c.Error:n="fas fa-exclamation-circle"}return Object(o.jsx)(o.Fragment,{children:Object(o.jsxs)("span",{style:{fontSize:"24px"},children:[Object(o.jsx)("i",{className:"".concat(n," status-badge status-badge-").concat(e),style:{fontSize:"10px",position:"relative",top:"-1px"}}),"\xa0",t]})})}(n.status),Object(o.jsxs)("div",{style:{float:"right"},children:[h&&(n.status===i.c.Saved||n.status===i.c.Completed)&&Object(o.jsxs)("button",{className:"btn btn-secondary btn-sm image-popup-button",onClick:function(){return h(n)},style:{marginRight:"5px"},children:[Object(o.jsx)("i",{className:"fas fa-code-branch"}),"\xa0VARIATIONS"]}),d&&Object(o.jsxs)("button",{className:"btn btn-danger btn-sm image-popup-delete-button",onClick:function(){return d&&d(n)},style:{marginRight:"5px"},children:[Object(o.jsx)("i",{className:"fas fa-trash-alt"}),"\xa0DELETE"]}),f&&Object(o.jsxs)("button",{className:"btn btn-primary btn-sm image-popup-button edit-button",onClick:function(){return f&&f(n)},style:{marginRight:"5px"},children:[Object(o.jsx)("i",{className:"fas fa-edit"}),"\xa0EDIT"]}),b&&Object(o.jsxs)("button",{className:"btn btn-primary btn-sm image-popup-button",onClick:function(){return b&&b(n)},style:{marginRight:"5px"},children:[Object(o.jsx)("i",{className:"fas fa-save"}),"\xa0SAVE"]}),n.nsfw&&c&&Object(o.jsxs)("button",{className:"btn btn-primary btn-sm image-popup-button",onClick:function(){return x(!O)},style:{marginRight:"5px"},children:[Object(o.jsx)("i",{className:"fas fa-eye"}),"\xa0",O?"HIDE":"SHOW"]})]})]}),Object(o.jsxs)("div",{className:"image-popup-controls",style:{marginTop:"28px",marginBottom:"85px"},children:[Object(o.jsxs)("div",{children:["Image dimensions: ",n.params.width," x"," ",n.params.height]}),Object(o.jsxs)("div",{children:["Model: ",n.model]}),n.nsfw&&Object(o.jsxs)(o.Fragment,{children:[Object(o.jsxs)("div",{children:[Object(o.jsx)("i",{className:"fas fa-exclamation-triangle",style:{color:"orange",fontSize:"18px",position:"relative",top:"2px"}}),"\xa0May contain NSFW content"]}),p&&Object(o.jsx)("a",{href:"javascript:void(0)",onClick:function(){return p(n,!1)},children:"Mark as Safe for Work"})]}),n.params.seed&&Object(o.jsxs)("div",{children:["Seed: ",n.params.seed]}),!n.nsfw&&Object(o.jsxs)(o.Fragment,{children:[Object(o.jsxs)("div",{children:[Object(o.jsx)("i",{className:"fas fa-check",style:{color:"green",fontSize:"18px",position:"relative",top:"2px"}}),"\xa0Safe for Work"]}),p&&Object(o.jsx)("a",{href:"javascript:void(0)",onClick:function(){return p(n,!0)},children:"Mark as Not Safe for Work"})]}),Object(o.jsxs)("div",{style:{marginTop:"8px"},children:["Prompt: ",n.params.prompt,Object(o.jsx)(u,{text:n.params.prompt})]}),Object(o.jsxs)("div",{style:{marginTop:"8px"},children:["Negative Prompt: ",n.params.negative_prompt,Object(o.jsx)(u,{text:n.params.negative_prompt})]})]})]})})]})]})}},148:function(e,t,n){"use strict";(function(e){n.d(t,"b",(function(){return _})),n.d(t,"a",(function(){return R}));var a=n(4),r=n(2),s=n.n(r),i=n(5),c=n(3),o=n(16),u=n(17),l=n(31),d=n(32),h=n(1),f=n(13),p=n.n(f),b=n(19),m=n(74),g=n(59),j=n(38),v=n(18),O=n(21),x=n(91),y=n(92),w=n(45),k=n(14),C=n.n(k),S=n(64),I=n(77),N=n(56),T=n(78),D=n(84),L=n(201),M=n(0),P=p.a.create(),E=1.3,_=function(t){Object(l.a)(a,t);var n=Object(d.a)(a);function a(e){var t;Object(o.a)(this,a),(t=n.call(this,e,"enhance")).selectionTool=void 0,t.pencilTool=void 0,t.prompt="",t.negativePrompt="",t.model="Epic Diffusion",t.count=4,t.variationStrength=.35,t._dirty=!1,t.worker=void 0,t.idCounter=0,t._state="default",t.stateHandler=function(){},t.selectionControlsListener=function(){},t.maskHandler=function(){},t.imageData=[],t.selectedImageDataIndex=-1,t.selectedImageData=null,t.panning=!1,t.erasing=!1,t.progressListener=void 0,t.errorListener=void 0,t.dirtyListener=void 0,t.selectionTool=new x.b(e),t.pencilTool=new D.b(e,"mask","#FFFFFF","mask-editor"),t.selectSupported()?t.state="select":t.state="default";var r=t.selectionTool.getArgs();return t.selectSupported()||(r=Object(c.a)(Object(c.a)({},r),{},{selectionOverlay:{x:0,y:0,width:t.renderer.getWidth(),height:t.renderer.getHeight()}})),t.selectionTool.updateArgs(r),t.pencilTool.updateArgs(Object(c.a)(Object(c.a)({},t.pencilTool.getArgs()),{},{brushColor:"#FFFFFF"})),t.renderer.setCursor(void 0),t.worker=new O.a,t}return Object(u.a)(a,[{key:"dirty",get:function(){return this._dirty},set:function(e){this._dirty=e,this.dirtyListener&&this.dirtyListener(e)}},{key:"onDirty",value:function(e){this.dirtyListener=e}},{key:"onError",value:function(e){this.errorListener=e}},{key:"notifyError",value:function(e){this.errorListener&&this.errorListener(e)}},{key:"state",get:function(){return this._state},set:function(e){e!==this._state&&(this.renderer.setCursor(void 0),"select"==this._state&&this.selectionTool.destroy(),this._state=e,this.stateHandler(e),"confirm"==e?this.selectionControlsListener(!0):(this.selectionControlsListener(!1),"select"==e&&this.selectionTool.updateArgs(Object(c.a)(Object(c.a)({},this.selectionTool.getArgs()),{},{outpaint:!1}))))}},{key:"selectSupported",value:function(){return!(0===Object(y.a)(this.renderer.getWidth(),this.renderer.getHeight())&&this.renderer.getWidth())}},{key:"onMouseDown",value:function(e){if("select"!=this.state)if("mask"!=this.state){var t=this.zoomHelper.translateMouseToCanvasCoordinates(e.nativeEvent.offsetX,e.nativeEvent.offsetY),n=t.x,a=t.y;1!==e.button?"erase"==this.state&&this.selectedImageData&&(this.erasing=!0,this.selectedImageData=new ImageData(this.selectedImageData.data.slice(),this.selectedImageData.width,this.selectedImageData.height),this.erasePoint(n,a)):this.panning=!0}else this.pencilTool.onMouseDown(e);else this.selectionTool.onMouseDown(e)}},{key:"erasePoint",value:function(e,t){for(var n=this.renderer.getSelectionOverlay(),a=Math.min(n.width,n.height),r=Math.floor(a/8*E),s=e-n.x,i=t-n.y,c=this.selectedImageData,o=Math.max(0,s-r),u=Math.max(0,i-r),l=Math.min(c.width,s+r),d=Math.min(c.height,i+r),h=o;h<l;h++)for(var f=u;f<d;f++){var p=4*(f*c.width+h),b=Math.sqrt(Math.pow(h-s,2)+Math.pow(f-i,2));if(b<r){var m=b/r*E-.30000000000000004,g=Math.min(Math.floor(255*m),c.data[p+3]);c.data[p+3]=g}}this.renderer.setEditImage(c)}},{key:"updateCursor",value:function(e,t){if("erase"==this.state&&this.selectedImageData){var n=this.renderer.getSelectionOverlay(),a=Math.min(n.width,n.height),r=Math.floor(a/8);this.renderer.setCursor({color:"white",radius:r*E,type:"circle",x:e,y:t})}else this.renderer.setCursor({color:"white",radius:10,type:"crosshairs",x:e,y:t})}},{key:"onMouseMove",value:function(e){if("select"!=this.state)if("mask"!=this.state){var t=this.zoomHelper.translateMouseToCanvasCoordinates(e.nativeEvent.offsetX,e.nativeEvent.offsetY),n=t.x,a=t.y;this.panning&&this.zoomHelper.onPan(e),this.updateCursor(n,a),this.erasing&&this.erasePoint(n,a)}else this.pencilTool.onMouseMove(e);else this.selectionTool.onMouseMove(e)}},{key:"onMouseUp",value:function(e){"select"==this.state&&this.selectionTool.onMouseUp(e),"mask"==this.state&&this.pencilTool.onMouseUp(e),this.panning=!1,this.erasing=!1}},{key:"onMouseLeave",value:function(e){"select"==this.state&&this.selectionTool.onMouseLeave(e),"mask"==this.state&&this.pencilTool.onMouseLeave(e),this.panning=!1,this.erasing=!1}},{key:"onWheel",value:function(e){this.zoomHelper.onWheel(e);var t=this.zoomHelper.translateMouseToCanvasCoordinates(e.offsetX,e.offsetY),n=t.x,a=t.y;this.updateCursor(n,a)}},{key:"updateArgs",value:function(e){e=Object(c.a)(Object(c.a)({},this.getArgs()),e),this.prompt=e.prompt||"",this.negativePrompt=e.negativePrompt||"",this.model=e.model||"Epic Diffusion",this.count=e.count||4,this.variationStrength=e.variationStrength||.75,console.log("updateArgs",e)}},{key:"onChangeState",value:function(e){this.stateHandler=e}},{key:"onChangeMask",value:function(e){this.maskHandler=e}},{key:"onShowSelectionControls",value:function(e){this.selectionControlsListener=e}},{key:"onProgress",value:function(e){this.progressListener=e}},{key:"newId",value:function(){return"".concat(this.idCounter++)}},{key:"loadImageData",value:function(){var e=Object(i.a)(s.a.mark((function e(t,n,a,r){var i,c,o,u,l,d,h,f;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(O.i)(t,n);case 2:if(i=e.sent,(c=document.createElement("canvas")).width=r.width,c.height=r.height,o=c.getContext("2d")){e.next=9;break}throw new Error("Failed to get canvas context");case 9:return o.drawImage(i,0,0,r.width,r.height),u=o.getImageData(0,0,r.width,r.height),l=this.newId(),d={id:l,alphaMode:"none",feather:!0,height:this.renderer.getHeight(),width:this.renderer.getWidth(),pixels:u.data,selectionOverlay:r},a&&(d.alphaMode="mask",d.alphaPixels=a.data),e.next=16,this.worker.processRequest(d);case 16:return h=e.sent,f=new ImageData(h.pixels,u.width,u.height),c.remove(),e.abrupt("return",f);case 20:case"end":return e.stop()}}),e,this)})));return function(t,n,a,r){return e.apply(this,arguments)}}()},{key:"cancel",value:function(){"erase"==this.state?(this.state="confirm",this.selectedImageData=this.imageData[this.selectedImageDataIndex],this.renderer.setEditImage(this.selectedImageData)):(this.selectSupported()?this.state="select":this.state="default",this.imageData=[],this.renderer.setEditImage(null),this.dirty=!1)}},{key:"erase",value:function(){this.state="erase"}},{key:"mask",value:function(){this.renderer.isMasked()&&this.renderer.deleteMask(),this.renderer.createMask(),this.state="mask",this.maskHandler(!0)}},{key:"deleteMask",value:function(){this.renderer.deleteMask(),"mask"==this.state&&(this.state="default"),this.maskHandler(!1)}},{key:"updateProgress",value:function(e){this.progressListener&&this.progressListener(e)}},{key:"submit",value:function(){var t=Object(i.a)(s.a.mark((function t(n,a,r){var c,o,u,l,d,h,f,p,b,j,x,y,k,S,I,N,T,D,L,M,E,_,R,A,U,F,z=this;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.dirty=!0,this.notifyError(null),c=this.renderer.getSelectionOverlay(),o=this.renderer.getEncodedImage(c)){t.next=7;break}return console.error("No selection"),t.abrupt("return");case 7:return t.next=9,Object(O.c)(o);case 9:return o=t.sent,this.renderer.isMasked()&&(u=this.renderer.getEncodedMask(c,"mask"),l=this.renderer.getImageData(c,"mask")),d=Object(g.b)(),t.next=14,n.createTemporaryImage("jpg");case 14:return h=t.sent,f=e.from(o,"base64"),this.state="uploading",this.updateProgress(0),t.next=20,P.put(h.data.upload_url,f,{headers:{"Content-Type":"image/jpeg"},onUploadProgress:function(e){var t=e.loaded/e.total;u&&(t/=2),z.updateProgress(t)}});case 20:if(d.tmp_jpg_id=h.data.id,!u){t.next=29;break}return t.next=24,n.createTemporaryImage("png");case 24:return p=t.sent,b=e.from(u,"base64"),t.next=28,P.put(p.data.upload_url,b,{headers:{"Content-Type":"image/png"},onUploadProgress:function(e){var t=.5+e.loaded/e.total/2;z.updateProgress(t)}});case 28:d.tmp_mask_id=p.data.id;case 29:return d.label="",d.parent=r.id,d.params.prompt=this.prompt||r.params.prompt,d.params.negative_prompt=this.negativePrompt||r.params.negative_prompt,d.params.denoising_strength=this.variationStrength,d.count=this.count,d.model=this.model,d.nsfw=r.nsfw,d.params.width=c.width,d.params.height=c.height,d.params.width=64*Math.ceil(d.params.width/64),d.params.height=64*Math.ceil(d.params.height/64),d.temporary=!0,j=null,t.prev=43,t.next=46,n.createImage(d);case 46:j=t.sent.data,t.next=55;break;case 49:return t.prev=49,t.t0=t.catch(43),console.error("Error creating images",t.t0),this.notifyError("Failed to create image"),this.state="default",t.abrupt("return");case 55:if(this.state="processing",(x=j.images)&&0!==x.length){t.next=60;break}throw this.state="default",new Error("No images returned");case 60:y=!1,k=C()(),S=function(){var e=Object(i.a)(s.a.mark((function e(t){var a,r,i,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((a=JSON.parse(t)).type!==w.d||a.status!==v.b.Completed){e.next=16;break}k=C()(),r=0;case 4:if(!(r<x.length)){e.next=14;break}if(x[r].id!==a.id){e.next=11;break}return e.next=8,z.loadImageData(n,x[r].id,l,c);case 8:i=e.sent,x[r].data=i,x[r].status=v.b.Completed;case 11:r++,e.next=4;break;case 14:e.next=17;break;case 16:if(a.status==v.b.Error)for(o=0;o<x.length;o++)x[o].id===a.id&&(x[o].status=v.b.Error);case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.addMessageListener(S),t.prev=64,I=C()(),N=C()();case 67:if(y){t.next=108;break}return T=0,t.next=71,Object(m.a)(1e3);case 71:D=0;case 72:if(!(D<x.length)){t.next=79;break}if(x[D].status!==v.b.Completed&&x[D].status!==v.b.Error){t.next=76;break}return T++,t.abrupt("continue",76);case 76:D++,t.next=72;break;case 79:if(this.updateProgress(T/x.length),T===x.length&&(y=!0),!(C()().diff(N,"seconds")>10)){t.next=105;break}return L=x.filter((function(e){return e.status===v.b.Pending||e.status===v.b.Processing})).map((function(e){return e.id})),console.log("Checking pending images",L),t.next=86,n.batchGetImages(void 0,{ids:L});case 86:M=t.sent,E=M.data.images,_=E.reduce((function(e,t){return e[t.id]=t,e}),{}),R=0;case 90:if(!(R<x.length)){t.next=104;break}if(x[R].status!==v.b.Pending&&x[R].status!==v.b.Processing){t.next=101;break}if(!(A=_[x[R].id])){t.next=101;break}if(x[R].status=A.status,A.status!==v.b.Completed){t.next=101;break}return k=C()(),t.next=99,this.loadImageData(n,x[R].id,l,c);case 99:U=t.sent,x[R].data=U;case 101:R++,t.next=90;break;case 104:N=C()();case 105:(k.isAfter(I)&&C()().diff(k,"seconds")>30||C()().diff(I,"minutes")>2)&&(y=!0),t.next=67;break;case 108:return t.prev=108,a.removeMessageListener(S),t.finish(108);case 111:for(x.sort((function(e,t){return t.score-e.score})),x=x.filter((function(e){return e.status===v.b.Completed})),this.imageData=[],F=0;F<x.length;F++)x[F].data&&this.imageData.push(x[F].data);if(0!==this.imageData.length){t.next=119;break}return this.state="default",this.notifyError("No images returned"),t.abrupt("return");case 119:this.renderer.setEditImage(this.imageData[0]),this.selectedImageDataIndex=0,this.selectedImageData=this.imageData[0],this.state="confirm",this.deleteMask();case 124:case"end":return t.stop()}}),t,this,[[43,49],[64,,108,111]])})));return function(e,n,a){return t.apply(this,arguments)}}()},{key:"select",value:function(e){"left"==e&&(this.selectedImageDataIndex--,this.selectedImageDataIndex<-1&&(this.selectedImageDataIndex=this.imageData.length-1)),"right"==e&&(this.selectedImageDataIndex++,this.selectedImageDataIndex>=this.imageData.length&&(this.selectedImageDataIndex=-1)),-1===this.selectedImageDataIndex?this.selectedImageData=null:this.selectedImageData=this.imageData[this.selectedImageDataIndex],this.renderer.setEditImage(this.selectedImageData)}},{key:"onSaveImage",value:function(e){this.saveListener=e}},{key:"confirm",value:function(){this.renderer.commitSelection(),this.selectSupported()?this.state="select":this.state="default",this.imageData=[];var e=this.renderer.getEncodedImage(null);e&&this.saveListener&&this.saveListener(e,{phrases:[this.prompt],negative_phrases:[this.negativePrompt],model:this.model}),this.dirty=!1}},{key:"destroy",value:function(){return this.renderer.isMasked()&&this.renderer.deleteMask(),this.renderer.setCursor(void 0),this.worker.destroy(),!0}}]),a}(j.a),R=function(e){var t=e.api,n=e.apisocket,r=e.image,s=e.renderer,i=e.tool,c=Object(h.useState)(4),o=Object(a.a)(c,2),u=o[0],l=o[1],d=Object(h.useState)(!1),f=Object(a.a)(d,2),p=f[0],m=f[1],g=Object(h.useState)(.35),j=Object(a.a)(g,2),v=j[0],O=j[1],y=Object(h.useState)(r.params.prompt||""),w=Object(a.a)(y,2),k=w[0],C=w[1],D=Object(h.useState)(r.params.negative_prompt||""),P=Object(a.a)(D,2),E=P[0],_=P[1],R=Object(h.useState)("swinir"==r.model||"stable_diffusion"==r.model?"Epic Diffusion":r.model),A=Object(a.a)(R,2),U=A[0],F=A[1],z=Object(h.useState)(!1),B=Object(a.a)(z,2),H=B[0],W=B[1],Y=Object(h.useState)(i.state),X=Object(a.a)(Y,2),q=X[0],G=X[1],Z=Object(h.useState)(i.renderer.isMasked()),J=Object(a.a)(Z,2),V=J[0],K=J[1],$=Object(h.useState)(0),Q=Object(a.a)($,2),ee=Q[0],te=Q[1],ne=Object(h.useState)(null),ae=Object(a.a)(ne,2),re=ae[0],se=ae[1];i.onChangeState(G),i.onChangeMask(K),i.onProgress(te),i.onError(se),i.onDirty(m);var ie=i.selectionTool.getArgs().selectionOverlay,ce=u;return ie&&(ce=Object(I.a)(u,ie.width,ie.height)),"processing"==q||"uploading"==q?Object(M.jsxs)("div",{style:{marginTop:"16px"},children:[Object(M.jsx)("i",{className:"fa fa-spinner fa-spin"}),"\xa0"," ","processing"===q?"Enhancing...":"Uploading...",Object(M.jsx)("br",{}),Object(M.jsx)(S.a,{progress:ee})]}):Object(M.jsxs)("div",{style:{marginTop:"16px",marginBottom:"8px",marginLeft:"16px"},children:[re&&Object(M.jsxs)("div",{className:"alert alert-danger",role:"alert",children:[Object(M.jsx)("button",{type:"button",className:"close","data-dismiss":"alert","aria-label":"Close",onClick:function(){return se(null)},children:Object(M.jsx)("span",{"aria-hidden":"true",children:"\xd7"})}),re]}),"select"===q&&Object(M.jsxs)(M.Fragment,{children:[Object(M.jsxs)("p",{children:[Object(M.jsx)("i",{className:"fa fa-info-circle"}),"\xa0 Move the selection rectangle to the area that you want to enhance"]}),Object(M.jsx)(x.a,{renderer:s,tool:i.selectionTool,lockAspectRatio:!0})]}),"default"===q&&Object(M.jsxs)(M.Fragment,{children:[Object(M.jsxs)("p",{children:[Object(M.jsx)("i",{className:"fa fa-info-circle"}),"\xa0 Confirm the parameters below and continue"]}),Object(M.jsxs)("div",{className:"form-group",children:[Object(M.jsx)("label",{htmlFor:"prompt",children:"Prompt"}),Object(M.jsx)("input",{type:"text",className:"form-control",id:"prompt",value:k,onChange:function(e){C(e.target.value)}}),Object(M.jsx)("small",{className:"form-text text-muted",children:"Customize the text prompt here"})]}),Object(M.jsxs)("div",{className:"form-group",children:[Object(M.jsx)("label",{htmlFor:"negative-prompt",children:"Negative Prompt"}),Object(M.jsx)("input",{type:"text",className:"form-control",id:"negative-prompt",value:E,onChange:function(e){_(e.target.value)}}),Object(M.jsx)("small",{className:"form-text text-muted",children:"Customize the negative text prompt here"})]}),Object(M.jsxs)("div",{className:"form-group",children:[Object(M.jsxs)("label",{htmlFor:"count",children:["Count: ",u]}),Object(M.jsx)("input",{type:"range",className:"form-control-range",id:"count",min:"1",max:"10",step:"1",value:u,onChange:function(e){l(parseInt(e.target.value))}}),Object(M.jsx)("small",{className:"form-text text-muted",children:"Number of enhancement options"})]}),Object(M.jsxs)("div",{className:"form-group",children:[Object(M.jsxs)("label",{htmlFor:"variation-strength",children:["Variation Strength:"," ",Math.round(100*v),"%"]}),Object(M.jsx)("input",{type:"range",className:"form-control-range",id:"variation-strength",min:"0",max:"1",step:"0.05",value:v,onChange:function(e){O(parseFloat(e.target.value))}}),Object(M.jsx)("small",{className:"form-text text-muted",children:"How much variation to use"})]}),Object(M.jsxs)("div",{className:"form-group",children:[Object(M.jsx)("label",{htmlFor:"model",children:"Model"}),Object(M.jsx)("div",{children:Object(M.jsxs)("button",{type:"button",className:"btn btn-secondary light-button",onClick:function(){return W(!0)},children:[U,"\xa0",Object(M.jsx)("i",{className:"fas fa-caret-down"})]})}),Object(M.jsx)("small",{className:"form-text text-muted",children:"Select the model to use"})]}),Object(M.jsx)("div",{className:"form-group",children:Object(M.jsx)(N.a,{imagesCost:ce})})]}),"erase"===q&&Object(M.jsxs)("p",{children:[Object(M.jsx)("i",{className:"fa fa-info-circle"}),"\xa0 Erase any undesired sections before saving"]}),"mask"===q&&Object(M.jsx)(L.a,{onConfirm:function(){return i.state="default"},onRevert:function(){i.deleteMask()},tool:i.pencilTool}),Object(M.jsxs)("div",{className:"form-group",children:["select"===q&&Object(M.jsxs)("button",{type:"button",className:"btn btn-primary btn-sm",onClick:function(){i.state="default"},style:{marginRight:"8px"},children:[Object(M.jsx)("i",{className:"fa fa-magic"}),"\xa0 Continue"]}),("default"===q&&i.selectSupported()||"confirm"===q||"erase"===q)&&Object(M.jsxs)("button",{className:"btn btn-primary btn-sm",onClick:function(){i.cancel()},style:{marginRight:"8px"},children:[Object(M.jsx)("i",{className:"fa fa-times"}),"\xa0 Revert"]}),("confirm"===q||"erase"===q)&&Object(M.jsxs)("button",{className:"btn btn-primary btn-sm",onClick:function(){return i.confirm()},style:{marginRight:"8px"},children:[Object(M.jsx)("i",{className:"fa fa-save"}),"\xa0 Save"]}),"confirm"===q&&Object(M.jsx)(M.Fragment,{children:Object(M.jsxs)("button",{className:"btn btn-primary btn-sm",onClick:function(){return i.erase()},style:{marginRight:"8px"},children:[Object(M.jsx)("i",{className:"fa fa-eraser"}),"\xa0 Erase"]})}),"default"===q&&Object(M.jsxs)(M.Fragment,{children:[Object(M.jsxs)("button",{className:"btn btn-primary btn-sm",onClick:function(){i.updateArgs({count:u,variationStrength:v,prompt:k,negativePrompt:E,model:U}),i.submit(t,n,r)},style:{marginRight:"8px"},children:[Object(M.jsx)("i",{className:"fa fa-magic"}),"\xa0 Enhance"]}),Object(M.jsxs)("button",{className:"btn btn-primary btn-sm",onClick:function(){return i.mask()},style:{marginRight:"8px"},children:[Object(M.jsx)("i",{className:"fa fa-cut"}),"\xa0 Mask"]}),V&&Object(M.jsxs)("button",{className:"btn btn-danger btn-sm",onClick:function(){return i.deleteMask()},style:{marginRight:"8px"},children:[Object(M.jsx)("i",{className:"fa fa-cut"}),"\xa0 Unmask"]})]})]}),Object(M.jsx)(b.a,{when:p,message:"Are you sure you want to leave? Your changes will be lost."}),H&&Object(M.jsx)(T.a,{api:t,onCancel:function(){return W(!1)},onSelectModel:function(e){F(e),W(!1)},initialSelectedModel:U,inpainting:!1})]})}}).call(this,n(67).Buffer)},15:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return M}));var a,r,s,i,c,o,u,l=n(16),d=n(17),h=n(31),f=n(32),p=n(2),b=n.n(p),m=n(3),g=n(5),j=n(13),v=n.n(j),O=n(39),x=n(211),y="https://www.aibrush.art".replace(/\/+$/,""),w=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:y,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:v.a;Object(l.a)(this,e),this.basePath=n,this.axios=a,this.configuration=void 0,t&&(this.configuration=t,this.basePath=t.basePath||this.basePath)},k=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e,a){var r;return Object(l.a)(this,n),(r=t.call(this,a)).field=e,r.name="RequiredError",r}return n}(Object(x.a)(Error)),C="https://example.com",S=function(e,t,n){if(null===n||void 0===n)throw new k(t,"Required parameter ".concat(t," was null or undefined when calling ").concat(e,"."))},I=function(e){for(var t=new URLSearchParams(e.search),n=arguments.length,a=new Array(n>1?n-1:0),r=1;r<n;r++)a[r-1]=arguments[r];for(var s=0,i=a;s<i.length;s++){var c=i[s];for(var o in c)if(Array.isArray(c[o])){t.delete(o);var u,l=Object(O.a)(c[o]);try{for(l.s();!(u=l.n()).done;){var d=u.value;t.append(o,d)}}catch(h){l.e(h)}finally{l.f()}}else t.set(o,c[o])}e.search=t.toString()},N=function(e,t,n){var a="string"!==typeof e;return(a&&n&&n.isJsonMime?n.isJsonMime(t.headers["Content-Type"]):a)?JSON.stringify(void 0!==e?e:{}):e||""},T=function(e){return e.pathname+e.search+e.hash},D=function(e,t,n,a){return function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n,i=Object(m.a)(Object(m.a)({},e.options),{},{url:((null===a||void 0===a?void 0:a.basePath)||s)+e.url});return r.request(i)}};!function(e){e.Gauge="gauge",e.Count="count"}(a||(a={})),function(e){e.Ok="ok"}(r||(r={})),function(e){e.Canny="canny",e.Hed="hed",e.Depth="depth",e.Normal="normal",e.Openpose="openpose",e.Seg="seg",e.Scribble="scribble",e.Fakescribbles="fakescribbles",e.Hough="hough"}(s||(s={})),function(e){e.FaceRestore="face_restore",e.RemoveBackground="remove_background",e.Upscale="upscale"}(i||(i={})),function(e){e.Pending="pending",e.Processing="processing",e.Completed="completed",e.Saved="saved",e.Error="error",e.Deleted="deleted"}(c||(c={})),function(e){e.Idle="idle",e.Active="active"}(o||(o={})),function(e){e.Idle="idle",e.Active="active"}(u||(u={}));var L=function(e){var t=function(e){return{addMetrics:function(){var t=Object(g.a)(b.a.mark((function t(n){var a,r,s,i,c,o,u,l=arguments;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=l.length>1&&void 0!==l[1]?l[1]:{},r=new URL("/api/metrics",C),e&&(s=e.baseOptions),i=Object(m.a)(Object(m.a)({method:"POST"},s),a),o={},(c={})["Content-Type"]="application/json",I(r,o,a.query),u=s&&s.headers?s.headers:{},i.headers=Object(m.a)(Object(m.a)(Object(m.a)({},c),u),a.headers),i.data=N(n,i,e),t.abrupt("return",{url:T(r),options:i});case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),batchGetImages:function(){var t=Object(g.a)(b.a.mark((function t(n,a){var r,s,i,c,o,u,l,d=arguments;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=d.length>2&&void 0!==d[2]?d[2]:{},s=new URL("/api/batch-get-images",C),e&&(i=e.baseOptions),c=Object(m.a)(Object(m.a)({method:"POST"},i),r),o={},u={},void 0!==n&&(u.fields=n),o["Content-Type"]="application/json",I(s,u,r.query),l=i&&i.headers?i.headers:{},c.headers=Object(m.a)(Object(m.a)(Object(m.a)({},o),l),r.headers),c.data=N(a,c,e),t.abrupt("return",{url:T(s),options:c});case 14:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),createDepositCode:function(){var t=Object(g.a)(b.a.mark((function t(n){var a,r,s,i,c,o,u,l=arguments;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=l.length>1&&void 0!==l[1]?l[1]:{},r=new URL("/api/deposit-codes",C),e&&(s=e.baseOptions),i=Object(m.a)(Object(m.a)({method:"POST"},s),a),o={},(c={})["Content-Type"]="application/json",I(r,o,a.query),u=s&&s.headers?s.headers:{},i.headers=Object(m.a)(Object(m.a)(Object(m.a)({},c),u),a.headers),i.data=N(n,i,e),t.abrupt("return",{url:T(r),options:i});case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),createImage:function(){var t=Object(g.a)(b.a.mark((function t(n){var a,r,s,i,c,o,u,l=arguments;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=l.length>1&&void 0!==l[1]?l[1]:{},r=new URL("/api/images",C),e&&(s=e.baseOptions),i=Object(m.a)(Object(m.a)({method:"POST"},s),a),o={},(c={})["Content-Type"]="application/json",I(r,o,a.query),u=s&&s.headers?s.headers:{},i.headers=Object(m.a)(Object(m.a)(Object(m.a)({},c),u),a.headers),i.data=N(n,i,e),t.abrupt("return",{url:T(r),options:i});case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),createInviteCode:function(){var t=Object(g.a)(b.a.mark((function t(){var n,a,r,s,i,c,o=arguments;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=o.length>0&&void 0!==o[0]?o[0]:{},a=new URL("/api/invite-codes",C),e&&(r=e.baseOptions),s=Object(m.a)(Object(m.a)({method:"POST"},r),n),i={},I(a,{},n.query),c=r&&r.headers?r.headers:{},s.headers=Object(m.a)(Object(m.a)(Object(m.a)({},i),c),n.headers),t.abrupt("return",{url:T(a),options:s});case 11:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),createStripeSession:function(){var t=Object(g.a)(b.a.mark((function t(n){var a,r,s,i,c,o,u,l=arguments;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=l.length>1&&void 0!==l[1]?l[1]:{},r=new URL("/api/stripe-sessions",C),e&&(s=e.baseOptions),i=Object(m.a)(Object(m.a)({method:"POST"},s),a),o={},(c={})["Content-Type"]="application/json",I(r,o,a.query),u=s&&s.headers?s.headers:{},i.headers=Object(m.a)(Object(m.a)(Object(m.a)({},c),u),a.headers),i.data=N(n,i,e),t.abrupt("return",{url:T(r),options:i});case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),createTemporaryImage:function(){var t=Object(g.a)(b.a.mark((function t(n){var a,r,s,i,c,o,u,l=arguments;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=l.length>1&&void 0!==l[1]?l[1]:{},S("createTemporaryImage","format",n),r=new URL("/api/temporary-images",C),e&&(s=e.baseOptions),i=Object(m.a)(Object(m.a)({method:"POST"},s),a),c={},o={},void 0!==n&&(o.format=n),I(r,o,a.query),u=s&&s.headers?s.headers:{},i.headers=Object(m.a)(Object(m.a)(Object(m.a)({},c),u),a.headers),t.abrupt("return",{url:T(r),options:i});case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),deleteImage:function(){var t=Object(g.a)(b.a.mark((function t(n){var a,r,s,i,c,o,u,l=arguments;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=l.length>1&&void 0!==l[1]?l[1]:{},S("deleteImage","id",n),r="/api/images/{id}".replace("{".concat("id","}"),encodeURIComponent(String(n))),s=new URL(r,C),e&&(i=e.baseOptions),c=Object(m.a)(Object(m.a)({method:"DELETE"},i),a),o={},I(s,{},a.query),u=i&&i.headers?i.headers:{},c.headers=Object(m.a)(Object(m.a)(Object(m.a)({},o),u),a.headers),t.abrupt("return",{url:T(s),options:c});case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),discordLogin:function(){var t=Object(g.a)(b.a.mark((function t(n){var a,r,s,i,c,o,u,l=arguments;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=l.length>1&&void 0!==l[1]?l[1]:{},r=new URL("/api/discord-login",C),e&&(s=e.baseOptions),i=Object(m.a)(Object(m.a)({method:"POST"},s),a),o={},(c={})["Content-Type"]="application/json",I(r,o,a.query),u=s&&s.headers?s.headers:{},i.headers=Object(m.a)(Object(m.a)(Object(m.a)({},c),u),a.headers),i.data=N(n,i,e),t.abrupt("return",{url:T(r),options:i});case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),getAssetsUrl:function(){var t=Object(g.a)(b.a.mark((function t(){var n,a,r,s,i,c,o=arguments;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=o.length>0&&void 0!==o[0]?o[0]:{},a=new URL("/api/assets-url",C),e&&(r=e.baseOptions),s=Object(m.a)(Object(m.a)({method:"GET"},r),n),i={},I(a,{},n.query),c=r&&r.headers?r.headers:{},s.headers=Object(m.a)(Object(m.a)(Object(m.a)({},i),c),n.headers),t.abrupt("return",{url:T(a),options:s});case 11:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),getCredits:function(){var t=Object(g.a)(b.a.mark((function t(){var n,a,r,s,i,c,o=arguments;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=o.length>0&&void 0!==o[0]?o[0]:{},a=new URL("/api/credits",C),e&&(r=e.baseOptions),s=Object(m.a)(Object(m.a)({method:"GET"},r),n),i={},I(a,{},n.query),c=r&&r.headers?r.headers:{},s.headers=Object(m.a)(Object(m.a)(Object(m.a)({},i),c),n.headers),t.abrupt("return",{url:T(a),options:s});case 11:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),getFeatures:function(){var t=Object(g.a)(b.a.mark((function t(){var n,a,r,s,i,c,o=arguments;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=o.length>0&&void 0!==o[0]?o[0]:{},a=new URL("/api/features",C),e&&(r=e.baseOptions),s=Object(m.a)(Object(m.a)({method:"GET"},r),n),i={},I(a,{},n.query),c=r&&r.headers?r.headers:{},s.headers=Object(m.a)(Object(m.a)(Object(m.a)({},i),c),n.headers),t.abrupt("return",{url:T(a),options:s});case 11:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),getGlobalSettings:function(){var t=Object(g.a)(b.a.mark((function t(n){var a,r,s,i,c,o,u,l=arguments;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=l.length>1&&void 0!==l[1]?l[1]:{},S("getGlobalSettings","key",n),r="/api/global-settings/{key}".replace("{".concat("key","}"),encodeURIComponent(String(n))),s=new URL(r,C),e&&(i=e.baseOptions),c=Object(m.a)(Object(m.a)({method:"GET"},i),a),o={},I(s,{},a.query),u=i&&i.headers?i.headers:{},c.headers=Object(m.a)(Object(m.a)(Object(m.a)({},o),u),a.headers),t.abrupt("return",{url:T(s),options:c});case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),getImage:function(){var t=Object(g.a)(b.a.mark((function t(n){var a,r,s,i,c,o,u,l=arguments;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=l.length>1&&void 0!==l[1]?l[1]:{},S("getImage","id",n),r="/api/images/{id}".replace("{".concat("id","}"),encodeURIComponent(String(n))),s=new URL(r,C),e&&(i=e.baseOptions),c=Object(m.a)(Object(m.a)({method:"GET"},i),a),o={},I(s,{},a.query),u=i&&i.headers?i.headers:{},c.headers=Object(m.a)(Object(m.a)(Object(m.a)({},o),u),a.headers),t.abrupt("return",{url:T(s),options:c});case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),getImageData:function(){var t=Object(g.a)(b.a.mark((function t(n){var a,r,s,i,c,o,u,l=arguments;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=l.length>1&&void 0!==l[1]?l[1]:{},S("getImageData","id",n),r="/api/images/{id}.image.png".replace("{".concat("id","}"),encodeURIComponent(String(n))),s=new URL(r,C),e&&(i=e.baseOptions),c=Object(m.a)(Object(m.a)({method:"GET"},i),a),o={},I(s,{},a.query),u=i&&i.headers?i.headers:{},c.headers=Object(m.a)(Object(m.a)(Object(m.a)({},o),u),a.headers),t.abrupt("return",{url:T(s),options:c});case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),getImageDownloadUrls:function(){var t=Object(g.a)(b.a.mark((function t(n){var a,r,s,i,c,o,u,l=arguments;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=l.length>1&&void 0!==l[1]?l[1]:{},S("getImageDownloadUrls","id",n),r="/api/images/{id}/download-urls".replace("{".concat("id","}"),encodeURIComponent(String(n))),s=new URL(r,C),e&&(i=e.baseOptions),c=Object(m.a)(Object(m.a)({method:"GET"},i),a),o={},I(s,{},a.query),u=i&&i.headers?i.headers:{},c.headers=Object(m.a)(Object(m.a)(Object(m.a)({},o),u),a.headers),t.abrupt("return",{url:T(s),options:c});case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),getImageUploadUrls:function(){var t=Object(g.a)(b.a.mark((function t(n){var a,r,s,i,c,o,u,l=arguments;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=l.length>1&&void 0!==l[1]?l[1]:{},S("getImageUploadUrls","id",n),r="/api/images/{id}/upload-urls".replace("{".concat("id","}"),encodeURIComponent(String(n))),s=new URL(r,C),e&&(i=e.baseOptions),c=Object(m.a)(Object(m.a)({method:"GET"},i),a),o={},I(s,{},a.query),u=i&&i.headers?i.headers:{},c.headers=Object(m.a)(Object(m.a)(Object(m.a)({},o),u),a.headers),t.abrupt("return",{url:T(s),options:c});case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),getMaskData:function(){var t=Object(g.a)(b.a.mark((function t(n){var a,r,s,i,c,o,u,l=arguments;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=l.length>1&&void 0!==l[1]?l[1]:{},S("getMaskData","id",n),r="/api/images/{id}.mask.png".replace("{".concat("id","}"),encodeURIComponent(String(n))),s=new URL(r,C),e&&(i=e.baseOptions),c=Object(m.a)(Object(m.a)({method:"GET"},i),a),o={},I(s,{},a.query),u=i&&i.headers?i.headers:{},c.headers=Object(m.a)(Object(m.a)(Object(m.a)({},o),u),a.headers),t.abrupt("return",{url:T(s),options:c});case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),getModels:function(){var t=Object(g.a)(b.a.mark((function t(){var n,a,r,s,i,c,o=arguments;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=o.length>0&&void 0!==o[0]?o[0]:{},a=new URL("/api/stable-diffusion-models",C),e&&(r=e.baseOptions),s=Object(m.a)(Object(m.a)({method:"GET"},r),n),i={},I(a,{},n.query),c=r&&r.headers?r.headers:{},s.headers=Object(m.a)(Object(m.a)(Object(m.a)({},i),c),n.headers),t.abrupt("return",{url:T(a),options:s});case 11:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),getThumbnailData:function(){var t=Object(g.a)(b.a.mark((function t(n){var a,r,s,i,c,o,u,l=arguments;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=l.length>1&&void 0!==l[1]?l[1]:{},S("getThumbnailData","id",n),r="/api/images/{id}.thumbnail.png".replace("{".concat("id","}"),encodeURIComponent(String(n))),s=new URL(r,C),e&&(i=e.baseOptions),c=Object(m.a)(Object(m.a)({method:"GET"},i),a),o={},I(s,{},a.query),u=i&&i.headers?i.headers:{},c.headers=Object(m.a)(Object(m.a)(Object(m.a)({},o),u),a.headers),t.abrupt("return",{url:T(s),options:c});case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),healthcheck:function(){var t=Object(g.a)(b.a.mark((function t(){var n,a,r,s,i,c,o=arguments;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=o.length>0&&void 0!==o[0]?o[0]:{},a=new URL("/api/healthcheck",C),e&&(r=e.baseOptions),s=Object(m.a)(Object(m.a)({method:"GET"},r),n),i={},I(a,{},n.query),c=r&&r.headers?r.headers:{},s.headers=Object(m.a)(Object(m.a)(Object(m.a)({},i),c),n.headers),t.abrupt("return",{url:T(a),options:s});case 11:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),isAdmin:function(){var t=Object(g.a)(b.a.mark((function t(){var n,a,r,s,i,c,o=arguments;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=o.length>0&&void 0!==o[0]?o[0]:{},a=new URL("/api/is-admin",C),e&&(r=e.baseOptions),s=Object(m.a)(Object(m.a)({method:"GET"},r),n),i={},I(a,{},n.query),c=r&&r.headers?r.headers:{},s.headers=Object(m.a)(Object(m.a)(Object(m.a)({},i),c),n.headers),t.abrupt("return",{url:T(a),options:s});case 11:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),listImages:function(){var t=Object(g.a)(b.a.mark((function t(n,a,r,s,i){var c,o,u,l,d,h,f,p=arguments;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=p.length>5&&void 0!==p[5]?p[5]:{},o=new URL("/api/images",C),e&&(u=e.baseOptions),l=Object(m.a)(Object(m.a)({method:"GET"},u),c),d={},h={},void 0!==n&&(h.cursor=n),void 0!==a&&(h.filter=a),void 0!==r&&(h.limit=r),void 0!==s&&(h.direction=s),void 0!==i&&(h.fields=i),I(o,h,c.query),f=u&&u.headers?u.headers:{},l.headers=Object(m.a)(Object(m.a)(Object(m.a)({},d),f),c.headers),t.abrupt("return",{url:T(o),options:l});case 16:case"end":return t.stop()}}),t)})));return function(e,n,a,r,s){return t.apply(this,arguments)}}(),login:function(){var t=Object(g.a)(b.a.mark((function t(n){var a,r,s,i,c,o,u,l=arguments;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=l.length>1&&void 0!==l[1]?l[1]:{},r=new URL("/api/auth/login",C),e&&(s=e.baseOptions),i=Object(m.a)(Object(m.a)({method:"POST"},s),a),o={},(c={})["Content-Type"]="application/json",I(r,o,a.query),u=s&&s.headers?s.headers:{},i.headers=Object(m.a)(Object(m.a)(Object(m.a)({},c),u),a.headers),i.data=N(n,i,e),t.abrupt("return",{url:T(r),options:i});case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),redeemDepositCode:function(){var t=Object(g.a)(b.a.mark((function t(n){var a,r,s,i,c,o,u,l=arguments;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=l.length>1&&void 0!==l[1]?l[1]:{},S("redeemDepositCode","code",n),r="/api/deposit-codes/{code}".replace("{".concat("code","}"),encodeURIComponent(String(n))),s=new URL(r,C),e&&(i=e.baseOptions),c=Object(m.a)(Object(m.a)({method:"POST"},i),a),o={},I(s,{},a.query),u=i&&i.headers?i.headers:{},c.headers=Object(m.a)(Object(m.a)(Object(m.a)({},o),u),a.headers),t.abrupt("return",{url:T(s),options:c});case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),refresh:function(){var t=Object(g.a)(b.a.mark((function t(n){var a,r,s,i,c,o,u,l=arguments;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=l.length>1&&void 0!==l[1]?l[1]:{},r=new URL("/api/auth/refresh",C),e&&(s=e.baseOptions),i=Object(m.a)(Object(m.a)({method:"POST"},s),a),o={},(c={})["Content-Type"]="application/json",I(r,o,a.query),u=s&&s.headers?s.headers:{},i.headers=Object(m.a)(Object(m.a)(Object(m.a)({},c),u),a.headers),i.data=N(n,i,e),t.abrupt("return",{url:T(r),options:i});case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),updateGlobalSettings:function(){var t=Object(g.a)(b.a.mark((function t(n,a){var r,s,i,c,o,u,l,d,h=arguments;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=h.length>2&&void 0!==h[2]?h[2]:{},S("updateGlobalSettings","key",n),s="/api/global-settings/{key}".replace("{".concat("key","}"),encodeURIComponent(String(n))),i=new URL(s,C),e&&(c=e.baseOptions),o=Object(m.a)(Object(m.a)({method:"PUT"},c),r),l={},(u={})["Content-Type"]="application/json",I(i,l,r.query),d=c&&c.headers?c.headers:{},o.headers=Object(m.a)(Object(m.a)(Object(m.a)({},u),d),r.headers),o.data=N(a,o,e),t.abrupt("return",{url:T(i),options:o});case 14:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),updateImage:function(){var t=Object(g.a)(b.a.mark((function t(n,a){var r,s,i,c,o,u,l,d,h=arguments;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=h.length>2&&void 0!==h[2]?h[2]:{},S("updateImage","id",n),s="/api/images/{id}".replace("{".concat("id","}"),encodeURIComponent(String(n))),i=new URL(s,C),e&&(c=e.baseOptions),o=Object(m.a)(Object(m.a)({method:"PATCH"},c),r),l={},(u={})["Content-Type"]="application/json",I(i,l,r.query),d=c&&c.headers?c.headers:{},o.headers=Object(m.a)(Object(m.a)(Object(m.a)({},u),d),r.headers),o.data=N(a,o,e),t.abrupt("return",{url:T(i),options:o});case 14:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),uploadImageData:function(){var t=Object(g.a)(b.a.mark((function t(n,a){var r,s,i,c,o,u,l,d,h=arguments;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=h.length>2&&void 0!==h[2]?h[2]:{},S("uploadImageData","id",n),s="/api/images/{id}.image.png".replace("{".concat("id","}"),encodeURIComponent(String(n))),i=new URL(s,C),e&&(c=e.baseOptions),o=Object(m.a)(Object(m.a)({method:"PUT"},c),r),l={},(u={})["Content-Type"]="image/png",I(i,l,r.query),d=c&&c.headers?c.headers:{},o.headers=Object(m.a)(Object(m.a)(Object(m.a)({},u),d),r.headers),o.data=N(a,o,e),t.abrupt("return",{url:T(i),options:o});case 14:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),uploadThumbnailData:function(){var t=Object(g.a)(b.a.mark((function t(n,a){var r,s,i,c,o,u,l,d,h=arguments;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=h.length>2&&void 0!==h[2]?h[2]:{},S("uploadThumbnailData","id",n),s="/api/images/{id}.thumbnail.png".replace("{".concat("id","}"),encodeURIComponent(String(n))),i=new URL(s,C),e&&(c=e.baseOptions),o=Object(m.a)(Object(m.a)({method:"PUT"},c),r),l={},(u={})["Content-Type"]="image/png",I(i,l,r.query),d=c&&c.headers?c.headers:{},o.headers=Object(m.a)(Object(m.a)(Object(m.a)({},u),d),r.headers),o.data=N(a,o,e),t.abrupt("return",{url:T(i),options:o});case 14:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),verify:function(){var t=Object(g.a)(b.a.mark((function t(n){var a,r,s,i,c,o,u,l=arguments;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=l.length>1&&void 0!==l[1]?l[1]:{},r=new URL("/api/auth/verify",C),e&&(s=e.baseOptions),i=Object(m.a)(Object(m.a)({method:"POST"},s),a),o={},(c={})["Content-Type"]="application/json",I(r,o,a.query),u=s&&s.headers?s.headers:{},i.headers=Object(m.a)(Object(m.a)(Object(m.a)({},c),u),a.headers),i.data=N(n,i,e),t.abrupt("return",{url:T(r),options:i});case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}(e);return{addMetrics:function(n,a){return Object(g.a)(b.a.mark((function r(){var s;return b.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.addMetrics(n,a);case 2:return s=r.sent,r.abrupt("return",D(s,v.a,y,e));case 4:case"end":return r.stop()}}),r)})))()},batchGetImages:function(n,a,r){return Object(g.a)(b.a.mark((function s(){var i;return b.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,t.batchGetImages(n,a,r);case 2:return i=s.sent,s.abrupt("return",D(i,v.a,y,e));case 4:case"end":return s.stop()}}),s)})))()},createDepositCode:function(n,a){return Object(g.a)(b.a.mark((function r(){var s;return b.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.createDepositCode(n,a);case 2:return s=r.sent,r.abrupt("return",D(s,v.a,y,e));case 4:case"end":return r.stop()}}),r)})))()},createImage:function(n,a){return Object(g.a)(b.a.mark((function r(){var s;return b.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.createImage(n,a);case 2:return s=r.sent,r.abrupt("return",D(s,v.a,y,e));case 4:case"end":return r.stop()}}),r)})))()},createInviteCode:function(n){return Object(g.a)(b.a.mark((function a(){var r;return b.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.createInviteCode(n);case 2:return r=a.sent,a.abrupt("return",D(r,v.a,y,e));case 4:case"end":return a.stop()}}),a)})))()},createStripeSession:function(n,a){return Object(g.a)(b.a.mark((function r(){var s;return b.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.createStripeSession(n,a);case 2:return s=r.sent,r.abrupt("return",D(s,v.a,y,e));case 4:case"end":return r.stop()}}),r)})))()},createTemporaryImage:function(n,a){return Object(g.a)(b.a.mark((function r(){var s;return b.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.createTemporaryImage(n,a);case 2:return s=r.sent,r.abrupt("return",D(s,v.a,y,e));case 4:case"end":return r.stop()}}),r)})))()},deleteImage:function(n,a){return Object(g.a)(b.a.mark((function r(){var s;return b.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.deleteImage(n,a);case 2:return s=r.sent,r.abrupt("return",D(s,v.a,y,e));case 4:case"end":return r.stop()}}),r)})))()},discordLogin:function(n,a){return Object(g.a)(b.a.mark((function r(){var s;return b.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.discordLogin(n,a);case 2:return s=r.sent,r.abrupt("return",D(s,v.a,y,e));case 4:case"end":return r.stop()}}),r)})))()},getAssetsUrl:function(n){return Object(g.a)(b.a.mark((function a(){var r;return b.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.getAssetsUrl(n);case 2:return r=a.sent,a.abrupt("return",D(r,v.a,y,e));case 4:case"end":return a.stop()}}),a)})))()},getCredits:function(n){return Object(g.a)(b.a.mark((function a(){var r;return b.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.getCredits(n);case 2:return r=a.sent,a.abrupt("return",D(r,v.a,y,e));case 4:case"end":return a.stop()}}),a)})))()},getFeatures:function(n){return Object(g.a)(b.a.mark((function a(){var r;return b.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.getFeatures(n);case 2:return r=a.sent,a.abrupt("return",D(r,v.a,y,e));case 4:case"end":return a.stop()}}),a)})))()},getGlobalSettings:function(n,a){return Object(g.a)(b.a.mark((function r(){var s;return b.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.getGlobalSettings(n,a);case 2:return s=r.sent,r.abrupt("return",D(s,v.a,y,e));case 4:case"end":return r.stop()}}),r)})))()},getImage:function(n,a){return Object(g.a)(b.a.mark((function r(){var s;return b.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.getImage(n,a);case 2:return s=r.sent,r.abrupt("return",D(s,v.a,y,e));case 4:case"end":return r.stop()}}),r)})))()},getImageData:function(n,a){return Object(g.a)(b.a.mark((function r(){var s;return b.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.getImageData(n,a);case 2:return s=r.sent,r.abrupt("return",D(s,v.a,y,e));case 4:case"end":return r.stop()}}),r)})))()},getImageDownloadUrls:function(n,a){return Object(g.a)(b.a.mark((function r(){var s;return b.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.getImageDownloadUrls(n,a);case 2:return s=r.sent,r.abrupt("return",D(s,v.a,y,e));case 4:case"end":return r.stop()}}),r)})))()},getImageUploadUrls:function(n,a){return Object(g.a)(b.a.mark((function r(){var s;return b.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.getImageUploadUrls(n,a);case 2:return s=r.sent,r.abrupt("return",D(s,v.a,y,e));case 4:case"end":return r.stop()}}),r)})))()},getMaskData:function(n,a){return Object(g.a)(b.a.mark((function r(){var s;return b.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.getMaskData(n,a);case 2:return s=r.sent,r.abrupt("return",D(s,v.a,y,e));case 4:case"end":return r.stop()}}),r)})))()},getModels:function(n){return Object(g.a)(b.a.mark((function a(){var r;return b.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.getModels(n);case 2:return r=a.sent,a.abrupt("return",D(r,v.a,y,e));case 4:case"end":return a.stop()}}),a)})))()},getThumbnailData:function(n,a){return Object(g.a)(b.a.mark((function r(){var s;return b.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.getThumbnailData(n,a);case 2:return s=r.sent,r.abrupt("return",D(s,v.a,y,e));case 4:case"end":return r.stop()}}),r)})))()},healthcheck:function(n){return Object(g.a)(b.a.mark((function a(){var r;return b.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.healthcheck(n);case 2:return r=a.sent,a.abrupt("return",D(r,v.a,y,e));case 4:case"end":return a.stop()}}),a)})))()},isAdmin:function(n){return Object(g.a)(b.a.mark((function a(){var r;return b.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.isAdmin(n);case 2:return r=a.sent,a.abrupt("return",D(r,v.a,y,e));case 4:case"end":return a.stop()}}),a)})))()},listImages:function(n,a,r,s,i,c){return Object(g.a)(b.a.mark((function o(){var u;return b.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,t.listImages(n,a,r,s,i,c);case 2:return u=o.sent,o.abrupt("return",D(u,v.a,y,e));case 4:case"end":return o.stop()}}),o)})))()},login:function(n,a){return Object(g.a)(b.a.mark((function r(){var s;return b.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.login(n,a);case 2:return s=r.sent,r.abrupt("return",D(s,v.a,y,e));case 4:case"end":return r.stop()}}),r)})))()},redeemDepositCode:function(n,a){return Object(g.a)(b.a.mark((function r(){var s;return b.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.redeemDepositCode(n,a);case 2:return s=r.sent,r.abrupt("return",D(s,v.a,y,e));case 4:case"end":return r.stop()}}),r)})))()},refresh:function(n,a){return Object(g.a)(b.a.mark((function r(){var s;return b.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.refresh(n,a);case 2:return s=r.sent,r.abrupt("return",D(s,v.a,y,e));case 4:case"end":return r.stop()}}),r)})))()},updateGlobalSettings:function(n,a,r){return Object(g.a)(b.a.mark((function s(){var i;return b.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,t.updateGlobalSettings(n,a,r);case 2:return i=s.sent,s.abrupt("return",D(i,v.a,y,e));case 4:case"end":return s.stop()}}),s)})))()},updateImage:function(n,a,r){return Object(g.a)(b.a.mark((function s(){var i;return b.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,t.updateImage(n,a,r);case 2:return i=s.sent,s.abrupt("return",D(i,v.a,y,e));case 4:case"end":return s.stop()}}),s)})))()},uploadImageData:function(n,a,r){return Object(g.a)(b.a.mark((function s(){var i;return b.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,t.uploadImageData(n,a,r);case 2:return i=s.sent,s.abrupt("return",D(i,v.a,y,e));case 4:case"end":return s.stop()}}),s)})))()},uploadThumbnailData:function(n,a,r){return Object(g.a)(b.a.mark((function s(){var i;return b.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,t.uploadThumbnailData(n,a,r);case 2:return i=s.sent,s.abrupt("return",D(i,v.a,y,e));case 4:case"end":return s.stop()}}),s)})))()},verify:function(n,a){return Object(g.a)(b.a.mark((function r(){var s;return b.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.verify(n,a);case 2:return s=r.sent,r.abrupt("return",D(s,v.a,y,e));case 4:case"end":return r.stop()}}),r)})))()}}},M=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"addMetrics",value:function(e,t){var n=this;return L(this.configuration).addMetrics(e,t).then((function(e){return e(n.axios,n.basePath)}))}},{key:"batchGetImages",value:function(e,t,n){var a=this;return L(this.configuration).batchGetImages(e,t,n).then((function(e){return e(a.axios,a.basePath)}))}},{key:"createDepositCode",value:function(e,t){var n=this;return L(this.configuration).createDepositCode(e,t).then((function(e){return e(n.axios,n.basePath)}))}},{key:"createImage",value:function(e,t){var n=this;return L(this.configuration).createImage(e,t).then((function(e){return e(n.axios,n.basePath)}))}},{key:"createInviteCode",value:function(e){var t=this;return L(this.configuration).createInviteCode(e).then((function(e){return e(t.axios,t.basePath)}))}},{key:"createStripeSession",value:function(e,t){var n=this;return L(this.configuration).createStripeSession(e,t).then((function(e){return e(n.axios,n.basePath)}))}},{key:"createTemporaryImage",value:function(e,t){var n=this;return L(this.configuration).createTemporaryImage(e,t).then((function(e){return e(n.axios,n.basePath)}))}},{key:"deleteImage",value:function(e,t){var n=this;return L(this.configuration).deleteImage(e,t).then((function(e){return e(n.axios,n.basePath)}))}},{key:"discordLogin",value:function(e,t){var n=this;return L(this.configuration).discordLogin(e,t).then((function(e){return e(n.axios,n.basePath)}))}},{key:"getAssetsUrl",value:function(e){var t=this;return L(this.configuration).getAssetsUrl(e).then((function(e){return e(t.axios,t.basePath)}))}},{key:"getCredits",value:function(e){var t=this;return L(this.configuration).getCredits(e).then((function(e){return e(t.axios,t.basePath)}))}},{key:"getFeatures",value:function(e){var t=this;return L(this.configuration).getFeatures(e).then((function(e){return e(t.axios,t.basePath)}))}},{key:"getGlobalSettings",value:function(e,t){var n=this;return L(this.configuration).getGlobalSettings(e,t).then((function(e){return e(n.axios,n.basePath)}))}},{key:"getImage",value:function(e,t){var n=this;return L(this.configuration).getImage(e,t).then((function(e){return e(n.axios,n.basePath)}))}},{key:"getImageData",value:function(e,t){var n=this;return L(this.configuration).getImageData(e,t).then((function(e){return e(n.axios,n.basePath)}))}},{key:"getImageDownloadUrls",value:function(e,t){var n=this;return L(this.configuration).getImageDownloadUrls(e,t).then((function(e){return e(n.axios,n.basePath)}))}},{key:"getImageUploadUrls",value:function(e,t){var n=this;return L(this.configuration).getImageUploadUrls(e,t).then((function(e){return e(n.axios,n.basePath)}))}},{key:"getMaskData",value:function(e,t){var n=this;return L(this.configuration).getMaskData(e,t).then((function(e){return e(n.axios,n.basePath)}))}},{key:"getModels",value:function(e){var t=this;return L(this.configuration).getModels(e).then((function(e){return e(t.axios,t.basePath)}))}},{key:"getThumbnailData",value:function(e,t){var n=this;return L(this.configuration).getThumbnailData(e,t).then((function(e){return e(n.axios,n.basePath)}))}},{key:"healthcheck",value:function(e){var t=this;return L(this.configuration).healthcheck(e).then((function(e){return e(t.axios,t.basePath)}))}},{key:"isAdmin",value:function(e){var t=this;return L(this.configuration).isAdmin(e).then((function(e){return e(t.axios,t.basePath)}))}},{key:"listImages",value:function(e,t,n,a,r,s){var i=this;return L(this.configuration).listImages(e,t,n,a,r,s).then((function(e){return e(i.axios,i.basePath)}))}},{key:"login",value:function(e,t){var n=this;return L(this.configuration).login(e,t).then((function(e){return e(n.axios,n.basePath)}))}},{key:"redeemDepositCode",value:function(e,t){var n=this;return L(this.configuration).redeemDepositCode(e,t).then((function(e){return e(n.axios,n.basePath)}))}},{key:"refresh",value:function(e,t){var n=this;return L(this.configuration).refresh(e,t).then((function(e){return e(n.axios,n.basePath)}))}},{key:"updateGlobalSettings",value:function(e,t,n){var a=this;return L(this.configuration).updateGlobalSettings(e,t,n).then((function(e){return e(a.axios,a.basePath)}))}},{key:"updateImage",value:function(e,t,n){var a=this;return L(this.configuration).updateImage(e,t,n).then((function(e){return e(a.axios,a.basePath)}))}},{key:"uploadImageData",value:function(e,t,n){var a=this;return L(this.configuration).uploadImageData(e,t,n).then((function(e){return e(a.axios,a.basePath)}))}},{key:"uploadThumbnailData",value:function(e,t,n){var a=this;return L(this.configuration).uploadThumbnailData(e,t,n).then((function(e){return e(a.axios,a.basePath)}))}},{key:"verify",value:function(e,t){var n=this;return L(this.configuration).verify(e,t).then((function(e){return e(n.axios,n.basePath)}))}}]),n}(w)},151:function(e,t,n){"use strict";n.d(t,"b",(function(){return f})),n.d(t,"a",(function(){return p}));var a=n(4),r=n(16),s=n(17),i=n(60),c=n(29),o=n(31),u=n(32),l=n(1),d=n(38),h=n(0),f=function(e){Object(o.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e,"smudge")).brushSize=10,a.brushOpacity=.2,a.lastX=0,a.lastY=0,a.panning=!1,a.smudging=!1,a._dirty=!1,a.dirtyListener=void 0,a}return Object(s.a)(n,[{key:"dirty",get:function(){return this._dirty},set:function(e){this._dirty=e,this.dirtyListener&&this.dirtyListener(e)}},{key:"sync",value:function(){this.renderer.setCursor({type:"circle",color:"white",radius:this.brushSize/2,x:this.lastX,y:this.lastY})}},{key:"updateArgs",value:function(e){Object(i.a)(Object(c.a)(n.prototype),"updateArgs",this).call(this,e),this.brushSize=e.brushSize||10,this.brushOpacity=e.brushOpacity||.2,this.sync()}},{key:"onMouseMove",value:function(e){var t=this.zoomHelper.translateMouseToCanvasCoordinates(e.nativeEvent.offsetX,e.nativeEvent.offsetY),n=t.x,a=t.y;this.panning?this.zoomHelper.onPan(e):this.smudging&&(this.renderer.smudgeLine(this.lastX,this.lastY,n,a,this.brushSize,this.brushOpacity),this.dirty=!0),this.lastX=n,this.lastY=a,this.sync()}},{key:"onWheel",value:function(e){this.zoomHelper.onWheel(e),this.sync()}},{key:"onMouseDown",value:function(e){if(0===e.button){this.smudging=!0,this.dirty||this.renderer.copyEditImageFromBaseImage(),this.dirty=!0;var t=this.zoomHelper.translateMouseToCanvasCoordinates(e.nativeEvent.offsetX,e.nativeEvent.offsetY),n=t.x,a=t.y;this.lastX=n,this.lastY=a,this.sync()}else 1===e.button&&(this.panning=!0);this.sync()}},{key:"onMouseUp",value:function(e){this.smudging=!1,this.panning=!1,this.sync()}},{key:"onSaveImage",value:function(e){this.saveListener=e}},{key:"onDirty",value:function(e){this.dirtyListener=e}},{key:"cancel",value:function(){this.renderer.setEditImage(null),this.dirty=!1}},{key:"confirm",value:function(){this.renderer.commitSelection();var e=this.renderer.getEncodedImage(null);e&&this.saveListener&&this.saveListener(e),this.dirty=!1}},{key:"destroy",value:function(){return this.dirty&&this.renderer.commitSelection(),!0}}]),n}(d.a),p=function(e){e.renderer;var t=e.tool,n=Object(l.useState)(10),r=Object(a.a)(n,2),s=r[0],i=r[1],c=Object(l.useState)(.2),o=Object(a.a)(c,2),u=o[0],d=o[1],f=Object(l.useState)(!1),p=Object(a.a)(f,2),b=p[0],m=p[1];return t.onDirty(m),Object(l.useEffect)((function(){t.updateArgs({brushSize:s,brushOpacity:u})}),[s,u]),Object(h.jsxs)("div",{style:{marginTop:"16px"},children:[Object(h.jsxs)("div",{className:"form-group",children:[Object(h.jsxs)("label",{style:{width:"100%"},children:["Brush size",Object(h.jsxs)("small",{className:"form-text text-muted",style:{float:"right"},children:[s,"px"]})]}),Object(h.jsx)("input",{type:"range",className:"form-control-range",min:"1",max:"100",value:s,onChange:function(e){return i(parseInt(e.target.value))}})]}),Object(h.jsxs)("div",{className:"form-group",children:[Object(h.jsxs)("label",{style:{width:"100%"},children:["Brush opacity",Object(h.jsxs)("small",{className:"form-text text-muted",style:{float:"right"},children:[Math.round(100*u),"%"]})]}),Object(h.jsx)("input",{type:"range",className:"form-control-range",min:"0",max:"1",step:"0.01",value:u,onChange:function(e){return d(parseFloat(e.target.value))}})]}),Object(h.jsxs)("div",{className:"form-group",style:{marginTop:"16px",visibility:b?"visible":"hidden"},children:[Object(h.jsx)("button",{className:"btn btn-secondary",onClick:function(){return t.cancel()},children:"Revert"}),Object(h.jsx)("button",{className:"btn btn-primary",onClick:function(){return t.confirm()},style:{marginLeft:"8px"},children:"Save"})]})]})}},152:function(e,t,n){"use strict";(function(e){n.d(t,"b",(function(){return P})),n.d(t,"a",(function(){return E}));var a=n(4),r=n(2),s=n.n(r),i=n(5),c=n(3),o=n(16),u=n(17),l=n(60),d=n(29),h=n(31),f=n(32),p=n(1),b=n(13),m=n.n(b),g=n(19),j=n(74),v=n(59),O=n(38),x=n(91),y=n(18),w=n(20),k=n(21),C=n(45),S=n(14),I=n.n(S),N=n(64),T=n(56),D=n(78),L=n(0),M=m.a.create(),P=function(t){Object(h.a)(a,t);var n=Object(f.a)(a);function a(e){var t;return Object(o.a)(this,a),(t=n.call(this,e,"inpaint")).selectionTool=void 0,t.prompt="",t.negativePrompt="",t.count=4,t.brushSize=10,t._dirty=!1,t.worker=void 0,t.idCounter=0,t._state=void 0,t.stateHandler=function(){},t.selectionControlsListener=function(){},t.imageData=[],t.selectedImageDataIndex=-1,t.selectedImageData=null,t.panning=!1,t.erasing=!1,t.progressListener=void 0,t.errorListener=void 0,t.dirtyListener=void 0,t.selectionTool=new x.b(e),t.selectSupported()?(t.state="select",t.selectionTool.updateArgs({outpaint:t.getArgs().outpaint})):t.state="erase",t.worker=new k.a,t}return Object(u.a)(a,[{key:"dirty",get:function(){return this._dirty},set:function(e){this._dirty=e,this.dirtyListener&&this.dirtyListener(e)}},{key:"newId",value:function(){return"".concat(this.idCounter++)}},{key:"onError",value:function(e){this.errorListener=e}},{key:"notifyError",value:function(e){this.errorListener&&this.errorListener(e)}},{key:"state",get:function(){return this._state},set:function(e){if(e!=this._state)if("select"==this._state&&this.selectionTool.destroy(),"erase"===this._state&&this.renderer.setCursor(void 0),this._state=e,this.stateHandler(e),"confirm"==e)this.selectionControlsListener(!0);else if(this.selectionControlsListener(!1),"select"==e){var t=this.renderer.getWidth(),n=this.renderer.getHeight(),a=Math.min(t,n,512);this.selectionTool.updateArgs({selectionOverlay:{x:0,y:0,width:a,height:a}})}}},{key:"selectSupported",value:function(){return!0}},{key:"onMouseDown",value:function(e){if("select"!=this.state){var t=this.zoomHelper.translateMouseToCanvasCoordinates(e.nativeEvent.offsetX,e.nativeEvent.offsetY),n=t.x,a=t.y;1!==e.button?"erase"==this.state&&(this.erasing=!0,this.erasePoint(n,a)):this.panning=!0}else this.selectionTool.onMouseDown(e)}},{key:"erasePoint",value:function(e,t){this.dirty||(this.dirty=!0),this.renderer.erasePoint(e,t,this.brushSize),this.renderer.render()}},{key:"updateCursor",value:function(e,t){"erase"==this.state?this.renderer.setCursor({color:"white",radius:this.brushSize/2,type:"circle",x:e,y:t}):this.renderer.setCursor({color:"white",radius:10,type:"crosshairs",x:e,y:t})}},{key:"onMouseMove",value:function(e){var t=this.zoomHelper.translateMouseToCanvasCoordinates(e.nativeEvent.offsetX,e.nativeEvent.offsetY),n=t.x,a=t.y;this.updateCursor(n,a),"select"!=this.state?(this.panning&&this.zoomHelper.onPan(e),this.erasing&&this.erasePoint(n,a)):this.selectionTool.onMouseMove(e)}},{key:"onMouseUp",value:function(e){"select"==this.state&&this.selectionTool.onMouseUp(e),this.panning=!1,this.erasing=!1}},{key:"onMouseLeave",value:function(e){"select"==this.state&&this.selectionTool.onMouseLeave(e),this.panning=!1,this.erasing=!1}},{key:"onWheel",value:function(e){this.zoomHelper.onWheel(e);var t=this.zoomHelper.translateMouseToCanvasCoordinates(e.offsetX,e.offsetY),n=t.x,a=t.y;this.updateCursor(n,a)}},{key:"updateArgs",value:function(e){e=Object(c.a)(Object(c.a)({},this.getArgs()),e),Object(l.a)(Object(d.a)(a.prototype),"updateArgs",this).call(this,e),this.prompt=e.prompt||"",this.negativePrompt=e.negativePrompt||"",this.count=e.count||4,this.brushSize=e.brushSize||10,this.updateCursor(this.renderer.getWidth()/2,this.renderer.getHeight()/2),this.selectionTool.updateArgs({outpaint:e.outpaint})}},{key:"onChangeState",value:function(e){this.stateHandler=e}},{key:"onShowSelectionControls",value:function(e){this.selectionControlsListener=e}},{key:"onProgress",value:function(e){this.progressListener=e}},{key:"loadImageData",value:function(){var e=Object(i.a)(s.a.mark((function e(t,n,a,r){var i,c,o,u,l,d,h;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(k.i)(t,n);case 2:if(i=e.sent,(c=document.createElement("canvas")).width=r.width,c.height=r.height,o=c.getContext("2d")){e.next=9;break}throw new Error("Failed to get canvas context");case 9:return o.drawImage(i,0,0,r.width,r.height),u=o.getImageData(0,0,r.width,r.height),l=this.newId(),e.next=14,this.worker.processRequest({id:l,alphaMode:"alpha",alphaPixels:a.data,feather:!0,height:this.renderer.getHeight(),width:this.renderer.getWidth(),pixels:u.data,selectionOverlay:r,featherWidth:10});case 14:return d=e.sent,h=new ImageData(d.pixels,u.width,u.height),c.remove(),e.abrupt("return",h);case 18:case"end":return e.stop()}}),e,this)})));return function(t,n,a,r){return e.apply(this,arguments)}}()},{key:"cancel",value:function(){this.selectSupported()?this.state="select":this.state="erase",this.renderer.snapshot(),this.renderer.undo(),this.renderer.clearRedoStack(),this.imageData=[],this.renderer.setEditImage(null),this.dirty=!1}},{key:"updateProgress",value:function(e){this.progressListener&&this.progressListener(e)}},{key:"submit",value:function(){var t=Object(i.a)(s.a.mark((function t(n,a,r,c){var o,u,l,d,h,f,p,b,m,g,O,x,k,S,N,T,D,L,P,E,_,R,A,U,F,z,B,H,W,Y,X=this;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.notifyError(null),o=this.renderer.getSelectionOverlay()){t.next=5;break}return console.error("No selection"),t.abrupt("return");case 5:return this.getArgs().outpaint&&(o.x<0||o.y<0||o.x+o.width>this.renderer.getWidth()||o.y+o.height>this.renderer.getHeight())&&(this.renderer.expandToOverlay(),o=this.renderer.getSelectionOverlay()),this.state="uploading",this.updateProgress(0),u=this.renderer.getEncodedMask(o),l=this.renderer.getImageData(o),this.renderer.snapshot(),this.renderer.undo(),this.renderer.clearRedoStack(),d=this.renderer.getEncodedImage(o),h=[n.createTemporaryImage("png"),n.createTemporaryImage("png")],t.next=17,Promise.all(h);case 17:for(f=t.sent,p=[e.from(d,"base64"),e.from(u,"base64")],b=[0,0],m=[],g=function(e){var t=f[e].data,n=p[e];m.push(M.put(t.upload_url,n,{headers:{"Content-Type":"image/png"},onUploadProgress:function(t){b[e]=t.loaded/t.total,X.updateProgress((b[0]+b[1])/2)}}))},O=0;O<f.length;O++)g(O);return t.next=25,Promise.all(m);case 25:return(x=Object(v.b)()).label="",x.tmp_image_id=f[0].data.id,x.tmp_mask_id=f[1].data.id,x.parent=r.id,x.params.prompt=this.prompt||r.params.prompt,x.params.negative_prompt=this.negativePrompt||r.params.negative_prompt,x.params.denoising_strength=1,x.count=this.count,x.model=c,k=Object(w.c)(o.width,o.height),x.params.width=k.width,x.params.height=k.height,x.temporary=!0,S=null,t.prev=40,t.next=43,n.createImage(x);case 43:S=t.sent.data,t.next=52;break;case 46:return t.prev=46,t.t0=t.catch(40),console.error("Error creating images",t.t0),this.notifyError("Failed to create image"),this.state="select",t.abrupt("return");case 52:if(this.state="processing",this.updateProgress(0),(N=S.images)&&0!==N.length){t.next=58;break}throw this.state="select",new Error("No images returned");case 58:T=!1,D=I()(),L=function(){var e=Object(i.a)(s.a.mark((function e(t){var a,r,i,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("inpaint onMessage",t),(a=JSON.parse(t)).type!==C.d||a.status!==y.b.Completed){e.next=17;break}D=I()(),r=0;case 5:if(!(r<N.length)){e.next=15;break}if(N[r].id!==a.id){e.next=12;break}return e.next=9,X.loadImageData(n,N[r].id,l,o);case 9:i=e.sent,N[r].data=i,N[r].status=y.b.Completed;case 12:r++,e.next=5;break;case 15:e.next=18;break;case 17:if(a.status===y.b.Error)for(c=0;c<N.length;c++)N[c].id===a.id&&(N[c].status=y.b.Error);case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.addMessageListener(L),t.prev=62,P=I()(),E=I()();case 65:if(T){t.next=108;break}return _=0,t.next=69,Object(j.a)(100);case 69:R=0;case 70:if(!(R<N.length)){t.next=77;break}if(N[R].status!==y.b.Completed&&N[R].status!==y.b.Error){t.next=74;break}return _++,t.abrupt("continue",74);case 74:R++,t.next=70;break;case 77:if(this.updateProgress(_/N.length),_!==N.length){t.next=81;break}return T=!0,t.abrupt("continue",65);case 81:if(!(I()().diff(E,"seconds")>10)){t.next=105;break}return A=N.filter((function(e){return e.status===y.b.Pending||e.status===y.b.Processing})).map((function(e){return e.id})),console.log("Checking pending images",A),t.next=86,n.batchGetImages(void 0,{ids:A});case 86:U=t.sent,F=U.data.images,z=F.reduce((function(e,t){return e[t.id]=t,e}),{}),B=0;case 90:if(!(B<N.length)){t.next=104;break}if(N[B].status!==y.b.Pending&&N[B].status!==y.b.Processing){t.next=101;break}if(!(H=z[N[B].id])){t.next=101;break}if(N[B].status=H.status,H.status!==y.b.Completed){t.next=101;break}return D=I()(),t.next=99,this.loadImageData(n,N[B].id,l,o);case 99:W=t.sent,N[B].data=W;case 101:B++,t.next=90;break;case 104:E=I()();case 105:(D.isAfter(P)&&I()().diff(D,"seconds")>30||I()().diff(P,"minutes")>2)&&(T=!0),t.next=65;break;case 108:return t.prev=108,a.removeMessageListener(L),t.finish(108);case 111:for(N.sort((function(e,t){return t.score-e.score})),N=N.filter((function(e){return e.status===y.b.Completed})),this.imageData=[],Y=0;Y<N.length;Y++)N[Y].data&&this.imageData.push(N[Y].data);if(0!==this.imageData.length){t.next=119;break}return this.state="select",this.notifyError("No images returned"),t.abrupt("return");case 119:this.renderer.setEditImage(this.imageData[0]),this.selectedImageDataIndex=0,this.selectedImageData=this.imageData[0],this.state="confirm";case 123:case"end":return t.stop()}}),t,this,[[40,46],[62,,108,111]])})));return function(e,n,a,r){return t.apply(this,arguments)}}()},{key:"onDirty",value:function(e){this.dirtyListener=e}},{key:"select",value:function(e){"left"==e&&(this.selectedImageDataIndex--,this.selectedImageDataIndex<-1&&(this.selectedImageDataIndex=this.imageData.length-1)),"right"==e&&(this.selectedImageDataIndex++,this.selectedImageDataIndex>=this.imageData.length&&(this.selectedImageDataIndex=-1)),-1===this.selectedImageDataIndex?this.selectedImageData=null:this.selectedImageData=this.imageData[this.selectedImageDataIndex],this.renderer.setEditImage(this.selectedImageData)}},{key:"onSaveImage",value:function(e){this.saveListener=e}},{key:"confirm",value:function(){this.renderer.commitSelection(),this.imageData=[];var e=this.renderer.getEncodedImage(null);e&&this.saveListener&&this.saveListener(e,{phrases:[this.prompt],negative_phrases:[this.negativePrompt],selection_overlay:this.renderer.getSelectionOverlay()}),this.dirty=!1,this.selectSupported()?this.state="select":this.state="erase"}},{key:"destroy",value:function(){return!(this.dirty&&!window.confirm("Discard changes?"))&&(this.renderer.setCursor(void 0),this.renderer.setEditImage(null),this.worker.destroy(),!0)}}]),a}(O.a),E=function(e){var t=e.api,n=e.apisocket,r=e.image,s=(e.renderer,e.tool),i=Object(p.useState)(4),c=Object(a.a)(i,2),o=c[0],u=c[1],l=Object(p.useState)(r.params.prompt||""),d=Object(a.a)(l,2),h=d[0],f=d[1],b=Object(p.useState)(r.params.negative_prompt||""),m=Object(a.a)(b,2),j=m[0],v=m[1],O=Object(p.useState)(s.state),x=Object(a.a)(O,2),y=x[0],w=x[1],k=Object(p.useState)(0),C=Object(a.a)(k,2),S=C[0],I=C[1],M=Object(p.useState)(null),P=Object(a.a)(M,2),E=P[0],_=P[1],R=Object(p.useState)(10),A=Object(a.a)(R,2),U=A[0],F=A[1],z=Object(p.useState)(!1),B=Object(a.a)(z,2),H=B[0],W=B[1],Y=Object(p.useState)(s.getArgs().outpaint),X=Object(a.a)(Y,2),q=X[0],G=X[1],Z=Object(p.useState)("Deliberate Inpainting"),J=Object(a.a)(Z,2),V=J[0],K=J[1],$=Object(p.useState)(!1),Q=Object(a.a)($,2),ee=Q[0],te=Q[1];Object(p.useEffect)((function(){s.updateArgs({brushSize:U})}),[U]),s.onChangeState(w),s.onProgress(I),s.onError(_),s.onDirty(W);return"uploading"===y||"processing"===y?Object(L.jsxs)("div",{style:{marginTop:"16px"},children:[Object(L.jsx)("i",{className:"fa fa-spinner fa-spin"}),"\xa0"," ","uploading"===y?"Uploading...":"Inpainting...",Object(L.jsx)("br",{}),Object(L.jsx)(N.a,{progress:S})]}):Object(L.jsxs)("div",{style:{marginTop:"16px",marginBottom:"8px",marginLeft:"16px"},children:[E&&Object(L.jsxs)("div",{className:"alert alert-danger",role:"alert",children:[Object(L.jsx)("button",{type:"button",className:"close","data-dismiss":"alert","aria-label":"Close",onClick:function(){return _(null)},children:Object(L.jsx)("span",{"aria-hidden":"true",children:"\xd7"})}),E]}),"select"===y&&Object(L.jsxs)(L.Fragment,{children:[Object(L.jsxs)("p",{children:[Object(L.jsx)("i",{className:"fa fa-info-circle"}),"\xa0 Move the selection rectangle to the area that you want to inpaint. For outpainting, try zooming out."]}),Object(L.jsx)("div",{className:"form-group",children:Object(L.jsxs)("div",{className:"form-check",children:[Object(L.jsx)("input",{className:"form-check-input",type:"checkbox",id:"allowoutpaint",checked:!!q,onChange:function(e){G(e.target.checked),s.updateArgs({outpaint:e.target.checked})}}),Object(L.jsx)("label",{className:"form-check-label",htmlFor:"allowoutpaint",children:"Allow outpainting"})]})})]}),"erase"===y&&Object(L.jsxs)(L.Fragment,{children:[Object(L.jsxs)("p",{children:[Object(L.jsx)("i",{className:"fa fa-info-circle"}),"\xa0 Erase the area that you want to inpaint."]}),Object(L.jsxs)("div",{className:"form-group",children:[Object(L.jsxs)("label",{style:{width:"100%"},children:["Brush size",Object(L.jsxs)("small",{className:"form-text text-muted",style:{float:"right"},children:[U,"px"]})]}),Object(L.jsx)("input",{type:"range",className:"form-control-range",min:"1",max:"100",value:U,onChange:function(e){return F(parseInt(e.target.value))}})]})]}),"inpaint"===y&&Object(L.jsxs)(L.Fragment,{children:[Object(L.jsxs)("p",{children:[Object(L.jsx)("i",{className:"fa fa-info-circle"}),"\xa0 Confirm the parameters below and continue"]}),Object(L.jsxs)("div",{className:"form-group",children:[Object(L.jsx)("label",{htmlFor:"prompt",children:"Prompt"}),Object(L.jsx)("input",{type:"text",className:"form-control",id:"prompt",value:h,onChange:function(e){f(e.target.value)}}),Object(L.jsx)("small",{className:"form-text text-muted",children:"Customize the text prompt here"})]}),Object(L.jsxs)("div",{className:"form-group",children:[Object(L.jsx)("label",{htmlFor:"negativeprompt",children:"Negative prompt"}),Object(L.jsx)("input",{type:"text",className:"form-control",value:j,onChange:function(e){v(e.target.value)}}),Object(L.jsx)("small",{className:"form-text text-muted",children:"Customize the negative text prompt here"})]}),Object(L.jsxs)("div",{className:"form-group",children:[Object(L.jsxs)("label",{htmlFor:"count",children:["Count: ",o]}),Object(L.jsx)("input",{type:"range",className:"form-control-range",id:"count",min:"1",max:"10",step:"1",value:o,onChange:function(e){u(parseInt(e.target.value))}}),Object(L.jsx)("small",{className:"form-text text-muted",children:"Number of inpaint options"})]}),Object(L.jsxs)("div",{className:"form-group",children:[Object(L.jsx)("label",{htmlFor:"model",children:"Model"}),Object(L.jsx)("div",{children:Object(L.jsxs)("button",{type:"button",className:"btn btn-secondary light-button",onClick:function(){return te(!0)},children:[V,"\xa0",Object(L.jsx)("i",{className:"fas fa-caret-down"})]})}),Object(L.jsx)("small",{className:"form-text text-muted",children:"Select the inpaint model"})]}),Object(L.jsx)("div",{className:"form-group",children:Object(L.jsx)(T.a,{imagesCost:o})})]}),"confirm"===y&&Object(L.jsx)(L.Fragment,{children:Object(L.jsxs)("p",{children:["Use the ",Object(L.jsx)("i",{className:"fa fa-arrow-left"})," and"," ",Object(L.jsx)("i",{className:"fa fa-arrow-right"})," buttons to navigate between the inpaint options"]})}),Object(L.jsxs)("div",{className:"form-group",children:[(H||"confirm"===y||"erase"==y&&s.selectSupported()||"inpaint"==y)&&Object(L.jsxs)("button",{style:{marginRight:"8px"},className:"btn btn-primary btn-sm",onClick:function(){s.cancel()},children:[Object(L.jsx)("i",{className:"fa fa-times"}),"\xa0 Revert"]}),"confirm"===y&&Object(L.jsx)(L.Fragment,{children:Object(L.jsxs)("button",{className:"btn btn-primary btn-sm",onClick:function(){return s.confirm()},style:{marginRight:"8px"},children:[Object(L.jsx)("i",{className:"fa fa-save"}),"\xa0 Save"]})}),"select"==y&&Object(L.jsxs)("button",{style:{marginRight:"8px"},type:"button",className:"btn btn-primary btn-sm",onClick:function(){return s.state="erase"},children:[Object(L.jsx)("i",{className:"fa fa-eraser"}),"\xa0 Continue"]}),"erase"==y&&Object(L.jsxs)("button",{style:{marginRight:"8px"},type:"button",className:"btn btn-primary btn-sm",onClick:function(){return s.state="inpaint"},children:[Object(L.jsx)("i",{className:"fa fa-paint-brush"}),"\xa0 Continue"]}),"inpaint"===y&&Object(L.jsxs)("button",{style:{marginRight:"8px"},className:"btn btn-primary btn-sm",onClick:function(){s.updateArgs({count:o,prompt:h,negativePrompt:j}),s.submit(t,n,r,V)},children:[Object(L.jsx)("i",{className:"fa fa-paint-brush"}),"\xa0 Inpaint"]})]}),Object(L.jsx)(g.a,{when:H,message:"Are you sure you want to leave? Your changes will be lost."}),ee&&Object(L.jsx)(D.a,{api:t,onCancel:function(){return te(!1)},onSelectModel:function(e){K(e),te(!1)},initialSelectedModel:V,inpainting:!0})]})}}).call(this,n(67).Buffer)},18:function(e,t,n){"use strict";n.d(t,"a",(function(){return a.b})),n.d(t,"b",(function(){return a.c}));var a=n(15);n(16),n(17)},195:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return k}));var a=n(2),r=n.n(a),s=n(3),i=n(5),c=n(4),o=n(1),u=n(19),l=n(13),d=n.n(l),h=n(212),f=(n(261),n(196)),p=n(38),b=n(148),m=n(84),g=n(151),j=n(204),v=n(152),O=n(206),x=n(33),y=n(0),w=d.a.create();delete w.defaults.headers.common.Authorization;var k=function(t){var n=t.api,a=t.apisocket,l=t.localImages,d=Object(o.useState)(!1),k=Object(c.a)(d,2),C=k[0],S=k[1],I=[{name:"inpaint",iconClass:"fas fa-paint-brush",constructor:function(e){return new v.b(e)},defaultArgs:{},renderControls:function(e,t){return e.onShowSelectionControls(S),Object(y.jsx)(v.a,{tool:e,renderer:t,api:n,apisocket:a,image:D})}},{name:"enhance",iconClass:"fas fa-magic",constructor:function(e){return new b.b(e)},defaultArgs:{variationStrength:.75},renderControls:function(e,t){return e.onShowSelectionControls(S),Object(y.jsx)(b.a,{tool:e,renderer:t,api:n,apisocket:a,image:D})}},{name:"pencil",iconClass:"fas fa-pencil-alt",constructor:function(e){return new m.b(e,"base")},defaultArgs:{},renderControls:function(e,t){return Object(y.jsx)(m.a,{tool:e,renderer:t,colors:m.c})}},{name:"smudge",iconClass:"fas fa-hand-pointer",constructor:function(e){return new g.b(e)},defaultArgs:{},renderControls:function(e,t){return Object(y.jsx)(g.a,{tool:e,renderer:t})}},{name:"import-export",iconClass:"fas fa-file-import",constructor:function(e){return new p.a(e,"import-export")},defaultArgs:{},renderControls:function(e,t){return Object(y.jsx)(j.a,{renderer:t,tool:e,api:n})}},{name:"augment",iconClass:"fas fa-image",constructor:function(e){return new p.a(e,"augment")},defaultArgs:{},renderControls:function(e,t){return Object(y.jsx)(O.a,{renderer:t,tool:e,api:n,image:D})}}],N=Object(o.useState)(null),T=Object(c.a)(N,2),D=T[0],L=T[1],M=Object(o.useState)(null),P=Object(c.a)(M,2),E=P[0],_=P[1],R=Object(o.useState)(null),A=Object(c.a)(R,2),U=A[0],F=A[1],z=Object(o.useState)(!1),B=Object(c.a)(z,2),H=B[0],W=B[1],Y=Object(o.useState)(!1),X=Object(c.a)(Y,2),q=X[0],G=X[1],Z=Object(o.useState)(null),J=Object(c.a)(Z,2),V=J[0],K=J[1],$=Object(u.i)().id,Q=Object(u.g)(),ee=Object(o.useRef)(null),te=function(e){if(E){if(U&&!U.destroy())return;var t=e.constructor(E);F(t),t.onSaveImage((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};console.log("Saving image..."),ne(e,t)}))}},ne=function(){var e=Object(i.a)(r.a.mark((function e(t,n){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(D&&t){e.next=2;break}throw new Error("Cannot save new image without existing image");case 2:if(E){e.next=4;break}throw new Error("Cannot save new image without renderer");case 4:return K("Saving image..."),e.prev=5,a=Object(s.a)(Object(s.a)({},D),{},{params:Object(s.a)(Object(s.a)({},D.params),{},{width:E.getWidth(),height:E.getHeight()}),id:h.a(),imageData:"data:image/png;base64,".concat(t)}),e.next=9,l.saveImage(a);case 9:L(a),Q.replace("/image-editor/".concat(a.id));case 11:return e.prev=11,K(null),e.finish(11);case 14:case"end":return e.stop()}}),e,null,[[5,,11,14]])})));return function(t,n){return e.apply(this,arguments)}}();function ae(e){if(!D)return null;if("upscale"==e.name&&D.params.width*D.params.height>=4194304)return null;var t="btn btn-secondary light-button image-editor-tool-button",n=U&&U.name==e.name;return n&&(t="btn btn-primary image-editor-tool-button"),Object(y.jsxs)("div",{className:"form-group",children:[Object(y.jsx)("button",{className:t,onClick:function(){return te(e)},children:Object(y.jsx)("i",{className:e.iconClass})}),Object(y.jsx)("label",{children:e.name.charAt(0).toUpperCase()+e.name.slice(1)}),n&&e.renderControls(U,E)]},e.name)}function re(e){return e.preventDefault(),!0}return Object(o.useEffect)((function(){function t(){return(t=Object(i.a)(r.a.mark((function t(){var a,s,i,c,o,u,d,h;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l.getImage($);case 2:if(a=t.sent,s="",!a){t.next=9;break}L(a),s=a.imageData,t.next=22;break;case 9:return t.next=11,n.getImage($);case 11:return i=t.sent.data,L(i),t.next=15,n.getImageDownloadUrls($);case 15:return c=t.sent,t.next=18,w.get(c.data.image_url,{responseType:"arraybuffer"});case 18:o=t.sent,u=e.from(o.data,"binary"),d=u.toString("base64"),s="data:image/png;base64,".concat(d);case 22:(h=new Image).src=s,h.onload=function(){if(ee.current){var e=Object(f.a)(ee.current);e.setBaseImage(h),_(e)}else console.error("Failed to get canvas")};case 25:case"end":return t.stop()}}),t)})))).apply(this,arguments)}D||function(){t.apply(this,arguments)}()}),[D,$]),Object(o.useEffect)((function(){D&&U&&"upscale"==U.name&&D.params.width*D.params.height>=4194304&&te(I[0])}),[D,U]),Object(o.useEffect)((function(){E&&(te(I[0]),E.onSnapshot((function(){W(E.canUndo()),G(E.canRedo())})))}),[E]),Object(o.useEffect)((function(){if(ee.current){var e=function(e){U&&(e.preventDefault(),U.onWheel(e))};return ee.current.addEventListener("wheel",e),function(){var t;null===(t=ee.current)||void 0===t||t.removeEventListener("wheel",e)}}}),[U,ee.current]),Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)("div",{className:"row",children:Object(y.jsx)("div",{className:"col-12",children:Object(y.jsxs)("h1",{style:{fontSize:"40px",textAlign:"left"},children:[Object(y.jsx)("i",{style:{cursor:"pointer"},onClick:function(){return Q.push("/images/".concat($))},className:"fas fa-chevron-left"}),"\xa0 AI Edit"]})})}),Object(y.jsxs)("div",{className:"row",style:{marginTop:"32px",paddingBottom:"120px"},children:[Object(y.jsx)("div",{className:"col-lg-3",children:E&&Object(y.jsxs)(y.Fragment,{children:[I.map((function(e){return ae(e)})),(q||H)&&Object(y.jsx)("div",{className:"form-group",children:Object(y.jsxs)("div",{className:"btn-group",children:[Object(y.jsx)("button",{className:"btn btn-primary image-popup-button",disabled:!E||!H,onClick:function(){return E&&E.undo()},children:Object(y.jsx)("i",{className:"fas fa-undo"})}),Object(y.jsx)("button",{className:"btn btn-primary image-popup-button",disabled:!E||!q,onClick:function(){return E&&E.redo()},children:Object(y.jsx)("i",{className:"fas fa-redo"})})]})})]})}),Object(y.jsxs)("div",{className:"col-lg-9",children:[Object(y.jsx)("div",{style:{verticalAlign:"middle"},children:Object(y.jsxs)("div",{children:[Object(y.jsx)("canvas",{style:{cursor:"none",touchAction:"none",userSelect:"none"},ref:ee,className:"image-editor-canvas",onMouseDown:function(e){return re(e)&&U&&U.onMouseDown(e)},onMouseMove:function(e){return re(e)&&U&&U.onMouseMove(e)},onMouseUp:function(e){return re(e)&&U&&U.onMouseUp(e)},onMouseLeave:function(e){return re(e)&&U&&U.onMouseLeave(e)},onTouchStart:function(e){return re(e)&&U&&U.onTouchStart(e)},onTouchMove:function(e){return re(e)&&U&&U.onTouchMove(e)},onTouchEnd:function(e){return re(e)&&U&&U.onTouchEnd(e)}}),C&&Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)("button",{className:"btn btn-secondary canvas-select-left",onClick:function(){return U.select("left")},children:Object(y.jsx)("i",{className:"fas fa-chevron-left"})}),Object(y.jsx)("button",{className:"btn btn-secondary canvas-select-right",onClick:function(){return U.select("right")},children:Object(y.jsx)("i",{className:"fas fa-chevron-right"})})]})]})}),Object(y.jsx)("div",{className:"row",children:Object(y.jsxs)("button",{className:"btn btn-primary",style:{position:"absolute",left:"50%",transform:"translate(-50%, 0)"},onClick:function(){E&&E.resetView()},children:[Object(y.jsx)("i",{className:"fas fa-search-plus"}),"\xa0 Reset View"]})})]})]}),V&&Object(y.jsx)(x.a,{show:!0,title:"Please Wait",children:V})]})}}).call(this,n(67).Buffer)},196:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(16),r=n(17),s=function(){function e(t){Object(a.a)(this,e),this.canvas=t,this.undoStack=[],this.redoStack=[],this.currentSnapshot=void 0,this.backgroundLayer=void 0,this.baseImageLayer=void 0,this.editLayer=void 0,this.maskLayer=void 0,this.selectionOverlay=void 0,this.selectionOverlayPreview=void 0,this.hasSelection=!1,this.cursor=void 0,this.zoom=void 0,this.offsetX=void 0,this.offsetY=void 0,this.width=0,this.height=0,this.snapshotListener=null,t.width=512,t.height=512,this.backgroundLayer=document.createElement("canvas"),this.backgroundLayer.width=512,this.backgroundLayer.height=512,this.baseImageLayer=document.createElement("canvas"),this.editLayer=document.createElement("canvas"),this.zoom=1,this.offsetX=0,this.offsetY=0}return Object(r.a)(e,[{key:"undo",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.undoStack.length>0&&this.currentSnapshot){var t=this.undoStack.pop();e&&this.redoStack.push(this.currentSnapshot),this.currentSnapshot=t;var n=this.baseImageLayer.getContext("2d");n&&(n.clearRect(0,0,this.baseImageLayer.width,this.baseImageLayer.height),n.putImageData(t,0,0),this.render()),this.notifySnapshotListener()}}},{key:"redo",value:function(){if(this.redoStack.length>0&&this.currentSnapshot){this.undoStack.push(this.currentSnapshot);var e=this.redoStack.pop();this.currentSnapshot=e;var t=this.baseImageLayer.getContext("2d");t&&(t.putImageData(e,0,0),this.render()),this.notifySnapshotListener()}}},{key:"clearRedoStack",value:function(){this.redoStack=[],this.notifySnapshotListener()}},{key:"canUndo",value:function(){return!this.hasSelection&&this.undoStack.length>0}},{key:"canRedo",value:function(){return!this.hasSelection&&this.redoStack.length>0}},{key:"onSnapshot",value:function(e){this.snapshotListener=e}},{key:"snapshot",value:function(){var e=this.baseImageLayer.getContext("2d");if(e){var t=e.getImageData(0,0,this.baseImageLayer.width,this.baseImageLayer.height);this.currentSnapshot?(this.undoStack.push(this.currentSnapshot),this.currentSnapshot=t,this.redoStack.length>0&&(this.redoStack=[]),this.undoStack.length>10&&this.undoStack.shift()):this.currentSnapshot=t,this.notifySnapshotListener()}}},{key:"notifySnapshotListener",value:function(){this.snapshotListener&&this.snapshotListener()}},{key:"render",value:function(){var e=this.canvas.getContext("2d");e&&(e.clearRect(0,0,this.width,this.height),e.drawImage(this.backgroundLayer,0,0),e.setTransform(this.zoom,0,0,this.zoom,this.offsetX*this.zoom,this.offsetY*this.zoom),e.drawImage(this.baseImageLayer,0,0),e.drawImage(this.editLayer,0,0),this.maskLayer&&(e.globalAlpha=.3,e.drawImage(this.maskLayer,0,0),e.globalAlpha=1),this.drawOverlay(e,this.width,this.height),e.setTransform(1,0,0,1,0,0))}},{key:"createMask",value:function(){this.maskLayer=document.createElement("canvas"),this.maskLayer.width=this.width,this.maskLayer.height=this.height,this.resetMask()}},{key:"resetMask",value:function(){if(this.maskLayer){var e=this.maskLayer.getContext("2d");e&&(e.fillStyle="#000000",e.fillRect(0,0,this.width,this.height)),this.render()}}},{key:"invertMask",value:function(){if(this.maskLayer){var e=this.maskLayer.getContext("2d");if(e){for(var t=e.getImageData(0,0,this.width,this.height),n=0;n<t.data.length;n+=4)t.data[n]=255-t.data[n],t.data[n+1]=255-t.data[n+1],t.data[n+2]=255-t.data[n+2];e.putImageData(t,0,0)}this.render()}}},{key:"deleteMask",value:function(){this.maskLayer=void 0,this.render()}},{key:"isMasked",value:function(){return void 0!==this.maskLayer}},{key:"getCanvas",value:function(){return this.canvas}},{key:"initializeBackgroundLayer",value:function(){var e=this.backgroundLayer.getContext("2d");if(e){var t=e.createPattern(this.createCheckeredPattern(20,20,"#808080","#AAAAAA"),"repeat");t&&(e.fillStyle=t,e.fillRect(0,0,this.backgroundLayer.width,this.backgroundLayer.height))}}},{key:"createCheckeredPattern",value:function(e,t,n,a){var r=document.createElement("canvas");r.width=e,r.height=t;var s=r.getContext("2d");return s&&(s.fillStyle=n,s.fillRect(0,0,e,t),s.fillStyle=a,s.fillRect(0,0,e/2,t/2),s.fillRect(e/2,t/2,e/2,t/2)),r}},{key:"setBaseImage",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.baseImageLayer.getContext("2d");n&&(this.initializeBackgroundLayer(),this.baseImageLayer.width=e.width,this.baseImageLayer.height=e.height,this.editLayer.width=e.width,this.editLayer.height=e.height,this.maskLayer=void 0,this.width=e.width,this.height=e.height,n.drawImage(e,0,0),t&&this.setSelectionOverlay({x:(e.width-512)/2,y:(e.height-512)/2,width:512,height:512}),this.resetView(),this.snapshot())}},{key:"resetView",value:function(){var e=Math.max(this.width,this.height),t=this.canvas.width/e,n=0,a=0;this.width>this.height?a=(this.width-this.height)/2:this.height>this.width&&(n=(this.height-this.width)/2),this.updateZoomAndOffset(t,n,a)}},{key:"setEditImage",value:function(e){this.hasSelection=!!e;var t=this.editLayer.getContext("2d");t&&this.selectionOverlay&&(t.clearRect(0,0,this.editLayer.width,this.editLayer.height),e&&t.putImageData(e,this.selectionOverlay.x,this.selectionOverlay.y),this.hasSelection=!!e,this.render()),this.notifySnapshotListener()}},{key:"drawOverlay",value:function(e,t,n){var a=Math.max(this.width/512,this.height/512);e&&(e.strokeStyle="white",e.lineWidth=a,e.strokeRect(0,0,t,n),!this.hasSelection&&this.selectionOverlay&&(e.strokeStyle="white",e.lineWidth=a,e.strokeRect(this.selectionOverlay.x,this.selectionOverlay.y,this.selectionOverlay.width,this.selectionOverlay.height)),!this.hasSelection&&this.selectionOverlayPreview&&(e.strokeStyle="cyan",e.lineWidth=a,e.strokeRect(this.selectionOverlayPreview.x,this.selectionOverlayPreview.y,this.selectionOverlayPreview.width,this.selectionOverlayPreview.height)),this.cursor&&("circle"===this.cursor.type?(e.lineWidth=a,e.strokeStyle=this.cursor.color,e.beginPath(),e.arc(this.cursor.x,this.cursor.y,this.cursor.radius,0,2*Math.PI),e.stroke()):"circle-fill"===this.cursor.type?(e.fillStyle=this.cursor.color,e.strokeStyle=this.cursor.color,e.beginPath(),e.arc(this.cursor.x,this.cursor.y,this.cursor.radius,0,2*Math.PI),e.stroke(),e.globalAlpha=.5,e.beginPath(),e.arc(this.cursor.x,this.cursor.y,this.cursor.radius,0,2*Math.PI),e.fill(),e.globalAlpha=1):"crosshairs"==this.cursor.type?(e.strokeStyle=this.cursor.color,e.lineWidth=a,e.beginPath(),e.moveTo(this.cursor.x-this.cursor.radius,this.cursor.y),e.lineTo(this.cursor.x+this.cursor.radius,this.cursor.y),e.moveTo(this.cursor.x,this.cursor.y-this.cursor.radius),e.lineTo(this.cursor.x,this.cursor.y+this.cursor.radius),e.stroke()):"colorpicker"===this.cursor.type&&(e.lineWidth=.75*this.cursor.radius,e.strokeStyle=this.cursor.color,e.beginPath(),e.arc(this.cursor.x,this.cursor.y,this.cursor.radius,0,2*Math.PI),e.stroke(),e.lineWidth=a,e.strokeStyle="black",e.beginPath(),e.moveTo(this.cursor.x-this.cursor.radius,this.cursor.y),e.lineTo(this.cursor.x+this.cursor.radius,this.cursor.y),e.moveTo(this.cursor.x,this.cursor.y-this.cursor.radius),e.lineTo(this.cursor.x,this.cursor.y+this.cursor.radius),e.stroke())))}},{key:"setSelectionOverlay",value:function(e){this.selectionOverlay=e,this.render()}},{key:"setSelectionOverlayPreview",value:function(e){this.selectionOverlayPreview=e,this.render()}},{key:"setCursor",value:function(e){this.cursor=e,this.render()}},{key:"getSelectionOverlay",value:function(){return this.selectionOverlay}},{key:"getZoom",value:function(){return this.zoom}},{key:"getOffsetX",value:function(){return this.offsetX}},{key:"getOffsetY",value:function(){return this.offsetY}},{key:"updateZoomAndOffset",value:function(e,t,n){this.zoom=e,this.offsetX=t,this.offsetY=n,this.render()}},{key:"getWidth",value:function(){return this.width}},{key:"getHeight",value:function(){return this.height}},{key:"imageDataToEncodedImage",value:function(e){var t=document.createElement("canvas");t.width=e.width,t.height=e.height;var n=t.getContext("2d");if(n){n.putImageData(e,0,0);var a=t.toDataURL("image/png");return t.remove(),a.split(",")[1]}}},{key:"getEncodedImage",value:function(e){var t=this.getImageData(e);if(t)return this.imageDataToEncodedImage(t)}},{key:"convertErasureToMask",value:function(e){for(var t=e,n=0;n<e.data.length;n+=4){e.data[n+3]<255?(t.data[n]=255,t.data[n+1]=255,t.data[n+2]=255,t.data[n+3]=255):(t.data[n]=0,t.data[n+1]=0,t.data[n+2]=0,t.data[n+3]=255)}return t}},{key:"getEncodedMask",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"base",n=this.getImageData(e,t);if(n){if("base"===t){var a=this.convertErasureToMask(n);return this.imageDataToEncodedImage(a)}return this.imageDataToEncodedImage(n)}}},{key:"getImageData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"base";e||(e={x:0,y:0,width:this.width,height:this.height});var n="base"===t?this.baseImageLayer:this.maskLayer;if(n){var a=n.getContext("2d");if(a){var r=a.getImageData(e.x,e.y,e.width,e.height);return r}}}},{key:"commitSelection",value:function(){var e=this.baseImageLayer.getContext("2d");e&&(e.drawImage(this.editLayer,0,0),this.setEditImage(null),this.snapshot())}},{key:"drawPoint",value:function(e,t,n,a){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"base",s="base"===r?this.editLayer:this.maskLayer;if(s){var i=s.getContext("2d");i&&(i.fillStyle=a,i.beginPath(),i.arc(e,t,n/2,0,2*Math.PI),i.fill()),this.render()}}},{key:"erasePoint",value:function(e,t,n){if(!this.selectionOverlay)throw new Error("No selection overlay");var a=this.baseImageLayer.getContext("2d");if(a){for(var r=a.getImageData(e-n/2,t-n/2,n,n),s=0;s<r.data.length;s+=4){var i=s/4%n,c=Math.floor(s/4/n),o=i-n/2+e,u=this.selectionOverlay.x;u>0&&(u+=10);var l=this.selectionOverlay.x+this.selectionOverlay.width;l<this.width&&(l-=10);var d=this.selectionOverlay.y;d>0&&(d+=10);var h=this.selectionOverlay.y+this.selectionOverlay.height;h<this.canvas.height&&(h-=10);var f=c-n/2+t,p=o>u&&o<l&&(f>d&&f<h);if(!this.selectionOverlay||p)Math.sqrt(Math.pow(i-n/2,2)+Math.pow(c-n/2,2))<n/2&&(r.data[s+3]=0)}a.putImageData(r,e-n/2,t-n/2)}}},{key:"drawLine",value:function(e,t,n,a,r,s){var i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"base",c="base"===i?this.editLayer:this.maskLayer;if(c){var o=c.getContext("2d");o&&(o.strokeStyle=s,o.lineWidth=r,o.lineCap="round",o.beginPath(),o.moveTo(e,t),o.lineTo(n,a),o.stroke()),this.render()}}},{key:"smudgeLine",value:function(e,t,n,a,r,s){var i={x:n-e,y:a-t},c=Math.sqrt(i.x*i.x+i.y*i.y);i.x/=c,i.y/=c;var o=this.editLayer.getContext("2d");if(o)for(var u=0;u<c;u++){for(var l=e+u*i.x,d=t+u*i.y,h=o.getImageData(l-r/2,d-r/2,r,r),f=0,p=0,b=0,m=0,g=0;g<h.height;g++)for(var j=0;j<h.width;j++){var v=4*(g*h.width+j);if(Math.sqrt((j-r/2)*(j-r/2)+(g-r/2)*(g-r/2))<=r/2)f+=h.data[v],p+=h.data[v+1],b+=h.data[v+2],m++}for(var O=f/m,x=p/m,y=b/m,w=0;w<h.height;w++)for(var k=0;k<h.width;k++){var C=4*(w*h.width+k);Math.sqrt((k-r/2)*(k-r/2)+(w-r/2)*(w-r/2))<=r/2&&(h.data[C]=O*s+h.data[C]*(1-s),h.data[C+1]=x*s+h.data[C+1]*(1-s),h.data[C+2]=y*s+h.data[C+2]*(1-s))}o.putImageData(h,l-r/2,d-r/2)}this.render()}},{key:"getPixel",value:function(e,t){var n=this.baseImageLayer.getContext("2d");if(n){var a=n.getImageData(e,t,1,1).data;return"#"+("000000"+function(e,t,n){if(e>255||t>255||n>255)throw"Invalid color component";return(e<<16|t<<8|n).toString(16)}(a[0],a[1],a[2])).slice(-6)}return"#000000"}},{key:"copyEditImageFromBaseImage",value:function(){var e=this.editLayer.getContext("2d");e&&e.drawImage(this.baseImageLayer,0,0),this.render(),this.hasSelection=!0,this.notifySnapshotListener()}},{key:"expandToOverlay",value:function(){if(!this.selectionOverlay)throw new Error("No selection overlay");var e=Math.min(0,this.selectionOverlay.x),t=Math.min(0,this.selectionOverlay.y),n=Math.max(this.selectionOverlay.x+this.selectionOverlay.width,this.baseImageLayer.width)-e,a=Math.max(this.selectionOverlay.y+this.selectionOverlay.height,this.baseImageLayer.height)-t,r=document.createElement("canvas");r.width=n,r.height=a;var s=r.getContext("2d");s&&s.drawImage(this.baseImageLayer,Math.max(0,-1*this.selectionOverlay.x),Math.max(0,-1*this.selectionOverlay.y)),this.selectionOverlay.x<0&&(this.selectionOverlay.x=0),this.selectionOverlay.y<0&&(this.selectionOverlay.y=0),console.log("new Canvas size: ".concat(n," x ").concat(a)),this.setBaseImage(r,!1)}}]),e}();function i(e){return new s(e)}},20:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return u}));var a=n(27),r=n(16),s=n(17),i=function(){function e(t){Object(r.a)(this,e),this.displayName=void 0,this.width=void 0,this.height=void 0,this.id=void 0,this.displayName=t.displayName,this.width=t.width,this.height=t.height,this.id=t.id}return Object(s.a)(e,[{key:"scale",value:function(t){var n=this.width*t,a=this.height*t;return new e({id:this.id,displayName:this.displayName,width:64*Math.ceil(n/64),height:64*Math.ceil(a/64)})}}]),e}(),c=5,o=[{displayName:"4:1",width:1024,height:256,id:0},{displayName:"3:1",width:768,height:256,id:1},{displayName:"2:1",width:640,height:320,id:2},{displayName:"3:2",width:576,height:384,id:3},{displayName:"5:4",width:640,height:512,id:4},{displayName:"1:1",width:512,height:512,id:5},{displayName:"4:5",width:512,height:640,id:6},{displayName:"2:3",width:384,height:576,id:7},{displayName:"1:2",width:320,height:640,id:8},{displayName:"1:3",width:256,height:768,id:9},{displayName:"1:4",width:256,height:1024,id:10}].map((function(e){return new i(e)}));function u(e,t){var n=e/t,r=Object(a.a)(o);return r.sort((function(e,t){var a=e.width/e.height,r=t.width/t.height;return Math.abs(a-n)-Math.abs(r-n)})),r[0]}},201:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(4),r=n(1),s=n(115),i=n(0),c=["#FFFFFF","#000000"],o=function(e){var t=e.tool,n=e.onConfirm,o=e.onRevert,u=Object(r.useState)(10),l=Object(a.a)(u,2),d=l[0],h=l[1],f=Object(r.useState)(c[0]),p=Object(a.a)(f,2),b=p[0],m=p[1];return Object(r.useEffect)((function(){t.updateArgs({brushSize:d,brushColor:b})}),[d,b]),Object(i.jsxs)("div",{style:{marginTop:"16px"},children:[Object(i.jsxs)("div",{className:"form-group",children:[Object(i.jsxs)("label",{style:{width:"100%"},children:["Brush size",Object(i.jsxs)("small",{className:"form-text text-muted",style:{float:"right"},children:[d,"px"]})]}),Object(i.jsx)("input",{type:"range",className:"form-control-range",min:"1",max:"100",value:d,onChange:function(e){return h(parseInt(e.target.value))}})]}),Object(i.jsx)("div",{style:{display:"flex",flexDirection:"row",flexWrap:"wrap"},children:c.map((function(e,t){return Object(i.jsx)(s.a,{selectedColor:b,color:e,onClick:function(e){return m(e)}},t)}))}),Object(i.jsxs)("div",{className:"form-group",style:{marginTop:"16px"},children:[Object(i.jsx)("i",{className:"fa fa-info-circle"}),"\xa0Masking: areas that are painted white will be changed, areas that are painted black will be left unchanged."]}),Object(i.jsxs)("div",{className:"form-group",style:{marginTop:"16px"},children:[Object(i.jsx)("button",{className:"btn btn-secondary",onClick:function(){return t.renderer.invertMask()},children:"Invert"}),Object(i.jsx)("button",{className:"btn btn-secondary",onClick:o,style:{marginLeft:"8px"},children:"Cancel"}),Object(i.jsx)("button",{className:"btn btn-primary",onClick:n,style:{marginLeft:"8px"},children:"Save"})]})]})}},204:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(4),r=n(1),s=n(75),i=n.n(s),c=n(205),o=n.n(c),u=n(0),l=function(e){var t=e.renderer,n=e.tool,s=Object(r.useState)(),c=Object(a.a)(s,2),l=c[0],d=c[1];return l?Object(u.jsxs)("div",{className:"form-group",style:{marginTop:"16px"},children:[Object(u.jsxs)("button",{className:"btn btn-primary",onClick:function(){d(void 0);var e=new Image,n="data:image/png;base64,"+l;e.src=n,e.onload=function(){t.setBaseImage(e)}},children:[Object(u.jsx)("i",{className:"fas fa-times"}),"\xa0 Revert"]}),Object(u.jsxs)("button",{className:"btn btn-primary",onClick:function(){if(d(void 0),n.saveListener){var e=t.getEncodedImage(null);e&&n.saveListener(e)}},style:{marginLeft:"8px"},children:[Object(u.jsx)("i",{className:"fas fa-save"}),"\xa0 Save"]})]}):Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("div",{className:"form-group",style:{marginTop:"16px"},children:Object(u.jsxs)("label",{id:"loadimage-wrapper",className:"btn btn-primary ",style:{display:"inline"},children:[Object(u.jsx)("i",{className:"fas fa-upload"}),"\xa0 Import Image",Object(u.jsx)("input",{id:"loadimage",type:"file",style:{display:"none"},onChange:function(e){var n=e.target.files;n&&n.length>0&&i()(n[0],(function(e){var n=t.getEncodedImage(null);d(n),t.setBaseImage(e)}),{canvas:!1})}})]})}),Object(u.jsx)("div",{className:"form-group",children:Object(u.jsxs)("button",{className:"btn btn-primary",onClick:function(){!function(){var e=t.getEncodedImage(null);if(e){for(var n=atob(e),a=new ArrayBuffer(n.length),r=new Uint8Array(a),s=0;s<n.length;s++)r[s]=n.charCodeAt(s);var i=new Blob([r],{type:"image/png"});o()(i,"image.png")}}()},style:{marginLeft:"8px"},children:[Object(u.jsx)("i",{className:"fas fa-download"}),"\xa0 Export Image"]})})]})}},206:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return x}));var a=n(2),r=n.n(a),s=n(5),i=n(4),c=n(1),o=n(13),u=n.n(o),l=n(74),d=n(18),h=n(21),f=n(59),p=n(81),b=n(14),m=n.n(b),g=n(77),j=n(56),v=n(0),O=u.a.create(),x=function(t){var n=t.renderer,a=t.tool,o=t.api,u=t.image,b=Object(c.useState)(),x=Object(i.a)(b,2),y=x[0],w=x[1],k=Object(c.useState)(null),C=Object(i.a)(k,2),S=C[0],I=C[1],N=Object(c.useState)(),T=Object(i.a)(N,2),D=T[0],L=T[1],M=Object(c.useState)(null),P=Object(i.a)(M,2),E=P[0],_=P[1],R=Object(c.useState)(0),A=Object(i.a)(R,2),U=A[0],F=A[1];Object(c.useEffect)((function(){var e=new h.a;return L(e),function(){e.destroy()}}),[]);var z=function(){var t=Object(s.a)(r.a.mark((function t(n,a){var s,i,c,p,b,m,g,j,v,x,y,w,k,C;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(D){t.next=2;break}throw new Error("Image worker not initialized");case 2:return s=Object(h.h)(n),i=s.toDataURL("image/png").split(",")[1],s.remove(),(c=Object(f.b)()).label="",t.next=9,o.createTemporaryImage("png");case 9:return p=t.sent,b=e.from(i,"base64"),t.next=13,O.put(p.data.upload_url,b,{headers:{"Content-Type":"image/png"}});case 13:return c.tmp_image_id=p.data.id,c.params.prompt=u.params.prompt,c.params.negative_prompt=u.params.negative_prompt,c.params.denoising_strength=.05,c.count=1,c.model="stable_diffusion",c.nsfw=!0,c.temporary=!0,c.params.width=n.width,c.params.height=n.height,c.params.augmentation="upscale"===a?d.a.Upscale:d.a.FaceRestore,t.next=26,o.createImage(c);case 26:m=t.sent,g=m.data.images[0];case 28:if(g.status===d.b.Completed){t.next=39;break}return t.next=31,Object(l.a)(2e3);case 31:return t.next=33,o.getImage(g.id);case 33:if(j=t.sent,(g=j.data).status!==d.b.Error){t.next=37;break}throw new Error("Augmentation failed");case 37:t.next=28;break;case 39:return t.next=41,o.getImageDownloadUrls(g.id);case 41:return v=t.sent,t.next=44,O.get(v.data.image_url,{responseType:"arraybuffer"});case 44:return x=t.sent,i=Object(h.b)(x.data),t.next=48,Object(h.e)(i);case 48:return y=t.sent,s=document.createElement("canvas"),w="upscale"===a?2:1,s.width=n.width*w,s.height=n.height*w,(k=s.getContext("2d")).drawImage(y,0,0,s.width,s.height),C=k.getImageData(0,0,s.width,s.height),s.remove(),t.abrupt("return",C);case 58:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),B=function(){var e=Object(s.a)(r.a.mark((function e(t){var a,s,i,c,o;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(I(t),_(null),e.prev=2,a=n.getEncodedImage(null),w(a),s=n.getImageData(null)){e.next=8;break}return e.abrupt("return");case 8:return s.width%64+s.height%64!==0&&(i=Object(h.g)(Object(h.h)(s)),s=i.getContext("2d").getImageData(0,0,i.width,i.height)),e.next=11,z(s,t);case 11:c=e.sent,o=Object(h.h)(c),n.setBaseImage(o),o.remove(),e.next=21;break;case 17:e.prev=17,e.t0=e.catch(2),_(e.t0.message||"Augmentation failed"),F(m()().valueOf());case 21:return e.prev=21,I(null),e.finish(21);case 24:case"end":return e.stop()}}),e,null,[[2,17,21,24]])})));return function(t){return e.apply(this,arguments)}}();if(S)return Object(v.jsxs)("div",{className:"form-group",style:{marginTop:"16px"},children:[Object(v.jsx)("i",{className:"fas fa-spinner fa-spin"}),"\xa0"," ","upscale"===S?"Upscaling...":"Restoring faces..."]});if(y)return Object(v.jsxs)("div",{className:"form-group",style:{marginTop:"16px"},children:[Object(v.jsx)(p.a,{message:E,timestamp:U}),Object(v.jsxs)("button",{className:"btn btn-primary",onClick:function(){w(void 0);var e=new Image,t="data:image/png;base64,"+y;e.src=t,e.onload=function(){n.setBaseImage(e)}},children:[Object(v.jsx)("i",{className:"fas fa-times"}),"\xa0 Revert"]}),Object(v.jsxs)("button",{className:"btn btn-primary",onClick:function(){if(w(void 0),a.saveListener){var e=n.getEncodedImage(null);e&&a.saveListener(e)}},style:{marginLeft:"8px"},children:[Object(v.jsx)("i",{className:"fas fa-save"}),"\xa0 Save"]})]});if(n.getWidth()*n.getHeight()>4194304)return Object(v.jsx)("div",{style:{marginTop:"16px"},children:"This image is too large to augment."});var H=Object(g.a)(1,u.params.width,u.params.height);return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(p.a,{message:E,timestamp:U}),Object(v.jsx)("div",{className:"form-group",style:{marginTop:"16px"},children:Object(v.jsxs)("button",{className:"btn btn-primary",onClick:function(){B("upscale")},style:{marginLeft:"8px"},children:[Object(v.jsx)("i",{className:"fas fa-arrows-alt"}),"\xa0 Upscale Image 2x"]})}),Object(v.jsx)("div",{className:"form-group",style:{marginTop:"16px"},children:Object(v.jsxs)("button",{className:"btn btn-primary",onClick:function(){B("face_restore")},style:{marginLeft:"8px"},children:[Object(v.jsx)("i",{className:"fas fa-smile"}),"\xa0 Restore Faces"]})}),Object(v.jsx)("div",{className:"form-group",style:{marginTop:"16px"},children:Object(v.jsx)(j.a,{imagesCost:H})})]})}}).call(this,n(67).Buffer)},207:function(e,t,n){"use strict";n(1);var a=n(26),r=n(93),s=n(19),i=n(30),c=n(0);t.a=function(e){var t=e.show,n=e.onHide,o=Object(s.g)();return Object(c.jsxs)(a.a,{show:t,onHide:n,centered:!0,children:[Object(c.jsx)(a.a.Header,{closeButton:!0,children:Object(c.jsx)(a.a.Title,{children:"Out of Credits"})}),Object(c.jsxs)(a.a.Body,{children:["Oops! It looks like you've run out of credits for today. But don't worry, you'll receive 100 free credits tomorrow to continue creating amazing images. Can't wait? Check out our affordable ",Object(c.jsx)(i.b,{to:"/pricing",children:"pricing options"})," to get instant access to more credits and unleash your creativity without limits!"]}),Object(c.jsxs)(a.a.Footer,{children:[Object(c.jsx)(r.a,{variant:"secondary",onClick:n,children:"Close"}),Object(c.jsx)(r.a,{variant:"primary",onClick:function(){n(),o.push("/pricing")},children:"Visit Pricing Page"})]})]})}},208:function(e,t,n){"use strict";var a=n(4),r=n(1),s=n(26),i=n(93),c=n(19),o=n(0);t.a=function(e){var t=e.paymentStatus,n=Object(r.useState)(!1),u=Object(a.a)(n,2),l=u[0],d=u[1],h=Object(c.g)();Object(r.useEffect)((function(){t&&d(!0)}),[t]);var f=function(){d(!1),h.push("/")};return Object(o.jsxs)(s.a,{show:l,onHide:f,children:[Object(o.jsx)(s.a.Header,{closeButton:!0,children:Object(o.jsx)(s.a.Title,{children:"Payment Status"})}),Object(o.jsx)(s.a.Body,{children:"success"===t?"Payment succeeded!":"Payment canceled."}),Object(o.jsx)(s.a.Footer,{children:Object(o.jsx)(i.a,{variant:"secondary",onClick:f,children:"Close"})})]})}},21:function(e,t,n){"use strict";(function(e){n.d(t,"c",(function(){return d})),n.d(t,"i",(function(){return h})),n.d(t,"l",(function(){return f})),n.d(t,"j",(function(){return p})),n.d(t,"h",(function(){return b})),n.d(t,"g",(function(){return m})),n.d(t,"a",(function(){return g})),n.d(t,"d",(function(){return j})),n.d(t,"e",(function(){return v})),n.d(t,"b",(function(){return O})),n.d(t,"k",(function(){return x})),n.d(t,"f",(function(){return y})),n.d(t,"m",(function(){return w}));var a=n(2),r=n.n(a),s=n(3),i=n(5),c=n(16),o=n(17),u=n(13),l=n.n(u).a.create();function d(e){return new Promise((function(t,n){var a=new Image;a.onload=function(){var e=document.createElement("canvas");try{e.width=a.width,e.height=a.height;var n=e.getContext("2d");if(!n)throw new Error("Could not get canvas context");n.drawImage(a,0,0);var r=e.toDataURL("image/jpeg");t(r.split(",")[1])}finally{e.remove()}},a.src="data:image/png;base64,".concat(e)}))}function h(t,n){return new Promise((function(a,r){t.getImageDownloadUrls(n).then((function(t){l.get(t.data.image_url,{responseType:"arraybuffer"}).then((function(t){var n=e.from(t.data,"binary").toString("base64"),r="data:image/png;base64,".concat(n),s=new Image;s.src=r,s.onload=function(){a(s)}})).catch((function(e){return r(e)}))})).catch((function(e){return r(e)}))}))}function f(e){if(!(e.width*e.height>262144))return null;var t=document.createElement("canvas");try{t.width=e.width,t.height=e.height;var n=t.getContext("2d");if(!n)throw new Error("Could not get canvas context");n.putImageData(e,0,0);for(var a=Math.min(e.width,e.height,512),r=Math.ceil(e.width/(a-32)),s=Math.ceil(e.height/(a-32)),i=[],c=0;c<r;c++){i.push([]);for(var o=0;o<s;o++){var u=c*(a-32),l=o*(a-32),d=Math.min(u+a,e.width),h=Math.min(l+a,e.height),f=n.getImageData(u,l,d-u,h-l);i[c].push(f)}}return{numTilesX:r,numTilesY:s,tileSize:a,imageWidth:e.width,imageHeight:e.height,tiles:i}}finally{t.remove()}}function p(e){var t=document.createElement("canvas");try{t.width=e.imageWidth,t.height=e.imageHeight;var n=t.getContext("2d");if(!n)throw new Error("Could not get canvas context");for(var a=0;a<e.numTilesX;a++)for(var r=0;r<e.numTilesY;r++){var s=b(e.tiles[a][r]);n.drawImage(s,a*(e.tileSize-64),r*(e.tileSize-64))}return n.getImageData(0,0,e.imageWidth,e.imageHeight)}finally{t.remove()}}function b(e){var t=document.createElement("canvas");t.width=e.width,t.height=e.height;var n=t.getContext("2d");if(!n)throw new Error("Could not get canvas context");return n.putImageData(e,0,0),t}function m(e){var t=64*Math.ceil(e.width/64),n=64*Math.ceil(e.height/64);return t==e.width&&n==e.height?e:function(e,t,n){var a=document.createElement("canvas");try{a.width=t,a.height=n;var r=a.getContext("2d");if(!r)throw new Error("Could not get canvas context");return r.drawImage(e,0,0,t,n),a}finally{e.remove()}}(e,t,n)}var g=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3;Object(c.a)(this,e),this.workers=[],this.callbacks={},this.cursor=0;for(var n=0;n<t;n++)this.workers[n]=new Worker("".concat("","/workers/imageutil.js")),this.workers[n].addEventListener("message",this.onMessage.bind(this))}return Object(o.a)(e,[{key:"onMessage",value:function(e){var t=e.data;this.callbacks[t.id](e),delete this.callbacks[t.id]}},{key:"processRequest",value:function(){var e=Object(i.a)(r.a.mark((function e(t){var n=this;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,a){n.callbacks[t.id]=function(t){e(t.data)},n.workers[n.cursor].postMessage(Object(s.a)({},t)),n.cursor=(n.cursor+1)%n.workers.length})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"destroy",value:function(){for(var e in this.workers)this.workers[e].terminate()}}]),e}();function j(e){return new Promise((function(t,n){var a=document.createElement("canvas");a.width=128,a.height=128;var r=new Image;r.src="data:image/png;base64,".concat(e),r.onload=function(){var e=a.getContext("2d");if(!e)throw new Error("Could not create canvas context");a.width=128,a.height=128;var n=r.width/r.height,s=n>1?r.width:r.height*n,i=n>1?r.width/n:r.height,c=(r.width-s)/2,o=(r.height-i)/2;e.drawImage(r,c,o,s,i,0,0,128,128);var u=a.toDataURL("image/png").split(",")[1];t(u)}}))}function v(e){return new Promise((function(t,n){var a=new Image;a.src="data:image/png;base64,".concat(e),a.onload=function(){t(a)}}))}function O(t){return e.from(t,"binary").toString("base64")}function x(e,t,n,a){return new Promise((function(r,s){var i=document.createElement("canvas");i.width=t,i.height=n;var c=new Image;c.src="data:image/".concat(a,";base64,").concat(e),c.onload=function(){var e=i.getContext("2d");if(!e)throw new Error("Could not create canvas context");i.width=t,i.height=n,e.drawImage(c,0,0,c.width,c.height,0,0,t,n);var a=i.toDataURL("image/${format}").split(",")[1];r(a)}}))}function y(e){for(var t=atob(e),n=[],a=0;a<t.length;a++)n.push(t.charCodeAt(a));return new Blob([new Uint8Array(n)],{type:"image/png"})}function w(e,t){return new Promise((function(n,a){var r=new XMLHttpRequest;r.open("PUT",e,!0),r.setRequestHeader("Content-Type","image/png"),r.onload=function(){r.status<400&&n()},r.onerror=function(e){a(e)},r.send(t)}))}}).call(this,n(67).Buffer)},217:function(e,t,n){},238:function(e,t,n){},239:function(e,t,n){},249:function(e,t){},261:function(e,t,n){},33:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));n(1);var a=n(26),r=n(0),s=function(e){var t=e.show,n=e.title,s=e.children;return Object(r.jsxs)(a.a,{show:t,backdrop:"static",keyboard:!1,children:[Object(r.jsx)(a.a.Header,{closeButton:!0,children:Object(r.jsx)(a.a.Title,{children:n||"Processing"})}),Object(r.jsx)(a.a.Body,{children:s||Object(r.jsx)("div",{className:"d-flex justify-content-center",children:Object(r.jsx)("div",{className:"spinner-border",role:"status",children:Object(r.jsx)("span",{className:"sr-only",children:"Please Wait..."})})})})]})}},377:function(e,t,n){},378:function(e,t,n){},379:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),s=n(49),i=n.n(s),c=(n(217),n(2)),o=n.n(c),u=n(5),l=n(4),d=n(13),h=n.n(d),f=n(30),p=n(19),b=(n(238),n(239),n(15)),m=n(3),g=n(16),j=n(17),v=n(14),O=n.n(v),x=function(){function e(){Object(g.a)(this,e),this.db=null}return Object(j.a)(e,[{key:"init",value:function(){var e=this;return new Promise((function(t,n){var a=indexedDB.open("aibrush",4);a.onupgradeneeded=function(e){var t,n,r=a.result;r.objectStoreNames.contains("images")?t=null===(n=a.transaction)||void 0===n?void 0:n.objectStore("images"):t=r.createObjectStore("images",{keyPath:"id"});t.createIndex("updated_at","updated_at",{unique:!1}),t.createIndex("deleted_at","deleted_at",{unique:!1}),console.log("Local images store updated")},a.onsuccess=function(n){e.db=a.result,console.log("Local images store initialized"),t()},a.onerror=function(e){console.error("error opening indexeddb",e),n(e)}}))}},{key:"hydrateImage",value:function(e){if(!e)return e;if(!e.params){var t=e;e.params={prompt:t.phrases.join(", "),negative_prompt:t.negative_phrases.join(", "),width:t.width,height:t.height,denoising_strength:t.stable_diffusion_strength,steps:t.iterations}}return e}},{key:"getImage",value:function(){var e=Object(u.a)(o.a.mark((function e(t){var n,a,r,s=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.db){e.next=2;break}throw new Error("not initialized");case 2:return n=this.db.transaction(["images"]),a=n.objectStore("images"),r=a.get(t),e.abrupt("return",new Promise((function(e,t){r.onsuccess=function(t){e(s.hydrateImage(r.result))},r.onerror=function(e){console.error("error getting image",e),t(e)}})));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"saveImage",value:function(){var e=Object(u.a)(o.a.mark((function e(t){var n,a,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.db){e.next=2;break}throw new Error("not initialized");case 2:return e.next=4,this.cleanupDeletedImages();case 4:return n=this.db.transaction(["images"],"readwrite"),a=n.objectStore("images"),r=a.put(Object(m.a)(Object(m.a)({},t),{},{updated_at:O()().valueOf()})),e.abrupt("return",new Promise((function(e,t){r.onsuccess=function(t){e()},r.onerror=function(e){console.error("error saving image",e),t(e)}})));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"hardDeleteImage",value:function(){var e=Object(u.a)(o.a.mark((function e(t){var n,a,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.db){e.next=2;break}throw new Error("not initialized");case 2:return n=this.db.transaction(["images"],"readwrite"),a=n.objectStore("images"),r=a.delete(t),e.abrupt("return",new Promise((function(e,n){r.onsuccess=function(n){console.log("image ".concat(t," permanently deleted")),e()},r.onerror=function(e){console.error("error deleting image",e),n(e)}})));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"deleteImage",value:function(){var e=Object(u.a)(o.a.mark((function e(t){var n,a,r,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.db){e.next=2;break}throw new Error("not initialized");case 2:return e.next=4,this.getImage(t);case 4:if(n=e.sent){e.next=8;break}return console.error("image not found",t),e.abrupt("return");case 8:if(!n.deleted_at&&"completed"===n.status){e.next=10;break}return e.abrupt("return",this.hardDeleteImage(t));case 10:return a=this.db.transaction(["images"],"readwrite"),r=a.objectStore("images"),s=r.put(Object(m.a)(Object(m.a)({},n),{},{deleted_at:O()().valueOf()})),e.abrupt("return",new Promise((function(e,t){s.onsuccess=function(t){e()},s.onerror=function(e){console.error("error deleting image",e),t(e)}})));case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"listImages",value:function(){var e=Object(u.a)(o.a.mark((function e(t,n,a,r){var s,i,c,u,l,d=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.db){e.next=2;break}throw new Error("not initialized");case 2:return s=this.db.transaction(["images"]),i=s.objectStore("images"),c=i.index("updated_at"),u="next"==n?IDBKeyRange.lowerBound(t):IDBKeyRange.upperBound(t),l=c.openCursor(u,n),e.abrupt("return",new Promise((function(e,t){var n=[];l.onsuccess=function(t){var s=l.result;if(s){var i=d.hydrateImage(s.value),c=(i.params.prompt||"").toLowerCase();i.deleted_at||r&&!c.includes(r.toLowerCase())||n.push(i),n.length<a?s.continue():e(n)}else e(n)},l.onerror=function(e){console.error("error listing images",e),t(e)}})));case 8:case"end":return e.stop()}}),e,this)})));return function(t,n,a,r){return e.apply(this,arguments)}}()},{key:"clearImages",value:function(){var e=Object(u.a)(o.a.mark((function e(){var t,n,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.db){e.next=2;break}throw new Error("not initialized");case 2:return t=this.db.transaction(["images"],"readwrite"),n=t.objectStore("images"),a=n.clear(),e.abrupt("return",new Promise((function(e,t){a.onsuccess=function(t){e()},a.onerror=function(e){console.error("error clearing images",e),t(e)}})));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getDeletedImages",value:function(){var e=Object(u.a)(o.a.mark((function e(t){var n,a,r,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.db){e.next=2;break}throw new Error("not initialized");case 2:return n=this.db.transaction(["images"]),a=n.objectStore("images"),r=a.index("deleted_at"),s=r.openCursor(t?IDBKeyRange.upperBound(t):IDBKeyRange.lowerBound(1),t?"prev":"next"),e.abrupt("return",new Promise((function(e,t){var n=[];s.onsuccess=function(t){var a=s.result;if(a){var r=a.value;n.length<50&&r.deleted_at&&n.push(a.value),a.continue()}else e(n)},s.onerror=function(e){console.error("error listing images",e),t(e)}})));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"clearDeletedImages",value:function(){var e=Object(u.a)(o.a.mark((function e(){var t,n,a=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.db){e.next=2;break}throw new Error("not initialized");case 2:return e.next=4,this.getDeletedImages();case 4:t=e.sent;case 5:if(!(t.length>0)){e.next=14;break}return n=t.map((function(e){return a.hardDeleteImage(e.id)})),e.next=9,Promise.all(n);case 9:return e.next=11,this.getDeletedImages();case 11:t=e.sent,e.next=5;break;case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"cleanupDeletedImages",value:function(){var e=Object(u.a)(o.a.mark((function e(){var t,n,a=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getDeletedImages(O()().subtract(1,"hours").valueOf());case 2:t=e.sent;case 3:if(!(t.length>0)){e.next=12;break}return n=t.map((function(e){return a.hardDeleteImage(e.id)})),e.next=7,Promise.all(n);case 7:return e.next=9,this.getDeletedImages(O()().subtract(1,"hours").valueOf());case 9:t=e.sent,e.next=3;break;case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();var y=n(107),w=n.n(y),k=n(0);console.log(Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}));var C=function(e){var t=Object(a.useState)(""),n=Object(l.a)(t,2),r=n[0],s=n[1],i=Object(a.useState)(!1),c=Object(l.a)(i,2),d=c[0],h=c[1],f=Object(a.useState)(""),p=Object(l.a)(f,2),b=p[0],m=p[1],g=Object(a.useState)(""),j=Object(l.a)(g,2),v=j[0],O=j[1],x=window.location.search,y=w.a.parse(x.substring(1)).invite_code,C=function(){var t=Object(u.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(O(""),r.match(/^[^@]+@[^@]+\.[^@]+$/)){t.next=4;break}return O("Invalid email address"),t.abrupt("return");case 4:return t.prev=4,t.next=7,e.client.login({email:r,invite_code:y});case 7:h(!0),t.next=14;break;case 10:t.prev=10,t.t0=t.catch(4),console.error(t.t0),O("Could not login");case 14:case"end":return t.stop()}}),t,null,[[4,10]])})));return function(){return t.apply(this,arguments)}}(),S=function(){var t=Object(u.a)(o.a.mark((function t(){var n;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return O(""),t.prev=1,t.next=4,e.client.verify({email:r,code:b});case 4:n=t.sent,e.onLogin(n.data),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(1),console.error(t.t0),O("Failed to verify code");case 12:case"end":return t.stop()}}),t,null,[[1,8]])})));return function(){return t.apply(this,arguments)}}();return Object(k.jsx)(k.Fragment,{children:Object(k.jsxs)("div",{className:"row",style:{height:"100vh",marginLeft:"0px",marginRight:"0px"},children:[Object(k.jsx)("div",{className:"col-md-6 login-splash",children:Object(k.jsx)("img",{className:"center-cropped",src:"/images/scifi-dreamland.png"})}),Object(k.jsxs)("div",{className:"col-md-6",children:[Object(k.jsx)("div",{style:{fontWeight:500,fontSize:"48px",marginTop:"200px"},children:"AiBrush"}),Object(k.jsx)("div",{style:{marginLeft:"10%",marginRight:"10%",marginTop:"88px",marginBottom:"24px"},children:"Login With Email"}),v&&Object(k.jsx)("p",{className:"text-danger",children:v}),v&&Object(k.jsxs)("p",{className:"text-info",children:["If you don't have an account yet, request one by sending an email to"," ",Object(k.jsx)("a",{href:"mailto:admin@aibrush.art",children:"admin@aibrush.art"})]}),Object(k.jsxs)("div",{style:{marginLeft:"10%",marginRight:"10%",marginTop:"24px",textAlign:"left"},children:[d&&Object(k.jsxs)(k.Fragment,{children:[Object(k.jsxs)("div",{className:"form-group",children:[Object(k.jsx)("label",{htmlFor:"verifyCode",children:"Verify Code"}),Object(k.jsx)("input",{type:"text",className:"form-control",id:"verifyCode",placeholder:"Verification Code",value:b,onChange:function(e){return m(e.target.value)}})]}),Object(k.jsx)("button",{className:"btn btn-secondary",onClick:function(){return h(!1)},children:"Cancel"}),"\xa0",Object(k.jsx)("button",{type:"button",className:"btn btn-primary",onClick:function(e){e.preventDefault(),S()},children:"Verify"})]}),!d&&Object(k.jsxs)(k.Fragment,{children:[Object(k.jsxs)("div",{className:"form-group",children:[Object(k.jsx)("label",{htmlFor:"email",children:"Email address"}),Object(k.jsx)("input",{type:"email",className:"form-control",id:"email","aria-describedby":"emailHelp",placeholder:"Enter email",value:r,onChange:function(e){return s(e.target.value.trim())}})]}),Object(k.jsx)("button",{type:"button",className:"btn btn-primary",style:{float:"right"},onClick:function(e){e.preventDefault(),C()},children:"Login"})]})]}),Object(k.jsxs)("div",{style:{marginLeft:"10%",marginRight:"10%",marginTop:"88px",marginBottom:"24px"},children:[Object(k.jsx)("hr",{}),"OR"]}),Object(k.jsx)("div",{style:{marginLeft:"10%",marginRight:"10%",marginTop:"24px"},children:Object(k.jsxs)("a",{href:function(){var e=window.location.host,t=window.location.protocol,n="".concat(t,"//").concat(e,"/discord-login");return"https://discord.com/api/oauth2/authorize?client_id=".concat("1043951225944678490","&redirect_uri=").concat(n,"&response_type=code&scope=identify%20email")}(),className:"btn btn-primary",children:[Object(k.jsx)("i",{className:"fab fa-discord"})," Login With Discord"]})})]})]})})},S=function(e){var t=e.onCredentialsRefreshed,n=e.onCredentialsExpired,r=e.api,s=e.credentials;return Object(a.useEffect)((function(){var e=setInterval((function(){s&&s.refreshToken&&r.refresh({refreshToken:s.refreshToken}).then((function(e){t(e.data)})).catch((function(){n()}))}),3e5);return function(){clearInterval(e)}}),[s,r,t]),Object(k.jsx)("div",{})},I=function(e){var t=e.api,n=Object(a.useState)(!0),r=Object(l.a)(n,2),s=r[0],i=r[1];return Object(a.useEffect)((function(){var e=setInterval((function(){t.healthcheck().then((function(){return i(!0)})).catch((function(){return i(!1)}))}),5e3);return function(){return clearInterval(e)}}),[t]),Object(k.jsx)("div",{className:"alert alert-danger",role:"alert",style:{display:s?"none":"block"},children:Object(k.jsx)("strong",{children:"Looks like we're having some trouble reaching the server."})})},N=n(27),T=n(389),D=n(385),L=n(93),M=n(386),P=n(108),E=n.n(P),_=function(e){var t=e.api,n=Object(a.useState)(100),r=Object(l.a)(n,2),s=r[0],i=r[1],c=Object(a.useState)(null),d=Object(l.a)(c,2),h=d[0],f=d[1],p=Object(a.useState)(!1),b=Object(l.a)(p,2),m=b[0],g=b[1],j=function(){var e=Object(u.a)(o.a.mark((function e(n){var a,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),a={amount:s},e.next=4,t.createDepositCode(a);case 4:r=e.sent,f(r.data.code);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(k.jsxs)("div",{children:[Object(k.jsx)("h4",{children:"Generate deposit code"}),Object(k.jsx)(T.a,{onSubmit:j,style:{marginTop:"16px"},children:Object(k.jsxs)(D.a,{className:"mb-3",children:[Object(k.jsx)("label",{style:{fontSize:"24px",marginRight:"8px"},children:"Amount:"}),Object(k.jsx)(T.a.Control,{type:"number",placeholder:"Amount",value:s,onChange:function(e){return i(parseInt(e.target.value))}}),Object(k.jsx)(D.a.Append,{children:Object(k.jsx)(L.a,{variant:"primary",type:"submit",style:{marginLeft:"16px"},children:"Generate Code"})})]})}),h&&Object(k.jsxs)("div",{className:"mb-3",children:[Object(k.jsx)("strong",{children:"Generated Code: "})," ",h,Object(k.jsx)(E.a,{text:h,onCopy:function(){g(!0),setTimeout((function(){return g(!1)}),3e3)},children:Object(k.jsx)(L.a,{variant:"secondary",className:"ml-2",children:"Copy to clipboard"})})]}),m&&Object(k.jsx)(M.a,{variant:"success",children:"Code copied to clipboard!"})]})},R=function(e){var t=e.api,n=Object(a.useState)({minimum_worker_allocations:{stable_diffusion:0,stable_diffusion_inpainting:0,swinir:0}}),r=Object(l.a)(n,2),s=r[0],i=r[1],c=Object(a.useState)(!1),d=Object(l.a)(c,2),h=d[0],f=d[1],p=function(){var e=Object(u.a)(o.a.mark((function e(){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getGlobalSettings("workers");case 2:n=e.sent,i(n.data.settings_json);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),b=function(){var e=Object(u.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f(!0),e.prev=1,e.next=4,t.updateGlobalSettings("workers",{settings_json:s});case 4:return e.prev=4,f(!1),e.finish(4);case 7:case"end":return e.stop()}}),e,null,[[1,,4,7]])})));return function(){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){p()}),[]),Object(k.jsxs)("div",{style:{paddingBottom:"48px"},children:[Object(k.jsx)("div",{className:"row",children:Object(k.jsx)("div",{className:"col-12",children:Object(k.jsx)("h1",{children:"Global Settings"})})}),Object(k.jsx)("div",{className:"row",children:Object(k.jsx)("div",{className:"col-12",children:Object(k.jsx)("div",{className:"spacer"})})}),Object(k.jsx)("div",{className:"row",children:Object(k.jsxs)("div",{className:"col-12",children:[Object(k.jsxs)("label",{htmlFor:"stable_diffusion",children:["stable_diffusion: ",s.minimum_worker_allocations.stable_diffusion]}),Object(k.jsx)("input",{style:{marginLeft:"16px"},type:"range",min:0,max:10,value:s.minimum_worker_allocations.stable_diffusion,className:"form-range",id:"stable_diffusion",onChange:function(e){i(Object(m.a)(Object(m.a)({},s),{},{minimum_worker_allocations:Object(m.a)(Object(m.a)({},s.minimum_worker_allocations),{},{stable_diffusion:parseInt(e.target.value)})}))}})]})}),Object(k.jsx)("div",{className:"row",children:Object(k.jsxs)("div",{className:"col-12",children:[Object(k.jsxs)("label",{htmlFor:"stable_diffusion_inpainting",children:["stable_diffusion_inpainting: ",s.minimum_worker_allocations.stable_diffusion_inpainting]}),Object(k.jsx)("input",{style:{marginLeft:"16px"},type:"range",min:0,max:10,value:s.minimum_worker_allocations.stable_diffusion_inpainting,className:"form-range",id:"stable_diffusion_inpainting",onChange:function(e){i(Object(m.a)(Object(m.a)({},s),{},{minimum_worker_allocations:Object(m.a)(Object(m.a)({},s.minimum_worker_allocations),{},{stable_diffusion_inpainting:parseInt(e.target.value)})}))}})]})}),Object(k.jsx)("div",{className:"row",children:Object(k.jsxs)("div",{className:"col-12",children:[Object(k.jsxs)("label",{htmlFor:"swinir",children:["swinir: ",s.minimum_worker_allocations.swinir]}),Object(k.jsx)("input",{style:{marginLeft:"16px"},type:"range",min:0,max:10,value:s.minimum_worker_allocations.swinir,className:"form-range",id:"swinir",onChange:function(e){i(Object(m.a)(Object(m.a)({},s),{},{minimum_worker_allocations:Object(m.a)(Object(m.a)({},s.minimum_worker_allocations),{},{swinir:parseInt(e.target.value)})}))}})]})}),Object(k.jsx)("div",{className:"row",children:Object(k.jsx)("div",{className:"col-12",children:Object(k.jsx)("button",{className:"btn btn-primary",onClick:b,disabled:h,children:h?Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)("i",{className:"fas fa-spinner fa-spin"}),"\xa0 Saving..."]}):"Save"})})})]})},A=function(e){var t=e.api,n=Object(a.useState)([]),r=Object(l.a)(n,2);r[0],r[1];return Object(k.jsxs)("div",{style:{paddingBottom:"48px"},children:[Object(k.jsx)("div",{className:"row",children:Object(k.jsx)("div",{className:"col-12",children:Object(k.jsx)("h1",{children:"Admin features"})})}),Object(k.jsx)("div",{className:"row",children:Object(k.jsx)("div",{className:"col-12",children:Object(k.jsx)("div",{className:"spacer"})})}),Object(k.jsx)("div",{className:"row",children:Object(k.jsx)("div",{className:"col-12",children:Object(k.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{height:"100%"},children:Object(k.jsx)(_,{api:t})})})}),Object(k.jsx)("hr",{}),Object(k.jsx)(R,{api:t})]})},U=n(195),F=n(57),z=n(33),B=function(e){var t=e.api,n=e.assetsUrl,r=Object(a.useState)([]),s=Object(l.a)(r,2),i=s[0],c=s[1],d=Object(a.useState)(!1),h=Object(l.a)(d,2),f=h[0],b=h[1],m=Object(p.g)(),g=function(){var e=Object(u.a)(o.a.mark((function e(){var n,a,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=O()().add(-24,"hours").valueOf(),e.next=3,t.listImages(a,"",100,"asc");case 3:r=e.sent,c(((null===(n=r.data.images)||void 0===n?void 0:n.filter((function(e){return!!e.deleted_at})))||[]).sort((function(e,t){return e.deleted_at&&t.deleted_at?t.deleted_at-e.deleted_at:0})));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),j=function(){var e=Object(u.a)(o.a.mark((function e(n){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c(i.filter((function(e){return e.id!==n.id}))),e.next=3,t.deleteImage(n.id);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),v=function(){var e=Object(u.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return b(!0),e.prev=1,e.next=4,Promise.all(i.map((function(e){return t.deleteImage(e.id)})));case 4:c([]);case 5:return e.prev=5,b(!1),e.finish(5);case 8:case"end":return e.stop()}}),e,null,[[1,,5,8]])})));return function(){return e.apply(this,arguments)}}(),x=function(){var e=Object(u.a)(o.a.mark((function e(n){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c(i.filter((function(e){return e.id!==n.id}))),e.next=3,t.updateImage(n.id,{deleted_at:null});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){g()}),[t]),Object(k.jsxs)("div",{children:[Object(k.jsxs)("div",{children:[Object(k.jsx)("div",{className:"row",children:Object(k.jsxs)("div",{className:"col-12",children:[Object(k.jsxs)("h1",{style:{fontSize:"40px",textAlign:"left"},children:[Object(k.jsx)("i",{style:{cursor:"pointer"},onClick:function(){return m.goBack()},className:"fas fa-chevron-left"}),"\xa0 Deleted Images"]}),Object(k.jsxs)("button",{className:"btn btn-danger btn-sm image-popup-delete-button",onClick:v,style:{float:"right",marginRight:"8px"},children:[Object(k.jsx)("i",{className:"fa fa-trash"}),"\xa0Delete All"]})]})}),Object(k.jsxs)("div",{className:"row",style:{marginTop:"32px"},children:[Object(k.jsx)("div",{className:"col-sm-2 offset-sm-2",children:"Image"}),Object(k.jsx)("div",{className:"col-sm-8",children:"Action"})]}),i.map((function(e){return Object(k.jsxs)("div",{className:"row",style:{marginTop:"16px",borderBottom:"1px solid #303030"},children:[Object(k.jsx)("div",{className:"col-sm-2 offset-sm-2",children:Object(k.jsx)(F.a,{assetsUrl:n,image:e,censorNSFW:!0})}),Object(k.jsxs)("div",{className:"col-sm-8",style:{paddingTop:"64px",paddingBottom:"64px"},children:[Object(k.jsxs)("button",{className:"btn btn-danger btn-sm image-popup-delete-button",onClick:function(){return j(e)},style:{marginRight:"8px"},children:[Object(k.jsx)("i",{className:"fa fa-trash"}),"\xa0Delete"]}),Object(k.jsxs)("button",{className:"btn btn-primary btn-sm image-popup-restore-button",onClick:function(){return x(e)},children:[Object(k.jsx)("i",{className:"fa fa-undo"}),"\xa0Restore"]})]})]},e.id)}))]}),Object(k.jsx)(z.a,{show:f,title:"Deleting Images",children:"Please wait while we delete all images..."})]})},H=n(95),W=n(45),Y=function(e){var t=e.client,n=e.onLogin,r=Object(p.g)(),s=new URLSearchParams(window.location.search).get("code");return Object(a.useEffect)((function(){s?(console.log("logging in with code",s),t.discordLogin({code:s}).then((function(e){console.log("login result",e),e.data.accessToken&&n(e.data),r.push("/")}))):r.push("/")}),[]),null},X=function(e){var t=e.localImages,n=Object(a.useState)([]),r=Object(l.a)(n,2),s=r[0],i=r[1],c=Object(a.useState)(!1),d=Object(l.a)(c,2),h=d[0],f=d[1],b=Object(p.g)(),g=function(){var e=Object(u.a)(o.a.mark((function e(){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getDeletedImages();case 2:n=e.sent,i(n);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),j=function(){var e=Object(u.a)(o.a.mark((function e(n){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i(s.filter((function(e){return e.id!==n.id}))),e.next=3,t.deleteImage(n.id);case 3:s.length<=5&&g();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),v=function(){var e=Object(u.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f(!0),e.prev=1,e.next=4,t.clearDeletedImages();case 4:i([]);case 5:return e.prev=5,f(!1),e.finish(5);case 8:case"end":return e.stop()}}),e,null,[[1,,5,8]])})));return function(){return e.apply(this,arguments)}}(),O=function(){var e=Object(u.a)(o.a.mark((function e(n){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i(s.filter((function(e){return e.id!==n.id}))),e.next=3,t.saveImage(Object(m.a)(Object(m.a)({},n),{},{deleted_at:void 0}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){g()}),[t]),Object(k.jsxs)("div",{children:[Object(k.jsxs)("div",{children:[Object(k.jsx)("div",{className:"row",children:Object(k.jsxs)("div",{className:"col-12",children:[Object(k.jsxs)("h1",{style:{fontSize:"40px",textAlign:"left"},children:[Object(k.jsx)("i",{style:{cursor:"pointer"},onClick:function(){return b.goBack()},className:"fas fa-chevron-left"}),"\xa0 Deleted Images"]}),Object(k.jsxs)("button",{className:"btn btn-danger btn-sm image-popup-delete-button",onClick:v,style:{float:"right",marginRight:"8px"},children:[Object(k.jsx)("i",{className:"fa fa-trash"}),"\xa0Delete All"]})]})}),Object(k.jsxs)("div",{className:"row",style:{marginTop:"32px"},children:[Object(k.jsx)("div",{className:"col-sm-2 offset-sm-2",children:"Image"}),Object(k.jsx)("div",{className:"col-sm-8",children:"Action"})]}),s.map((function(e){return Object(k.jsxs)("div",{className:"row",style:{marginTop:"16px",borderBottom:"1px solid #303030"},children:[Object(k.jsx)("div",{className:"col-sm-2 offset-sm-2",children:Object(k.jsx)(F.a,{assetsUrl:"",image:e,censorNSFW:!0})}),Object(k.jsxs)("div",{className:"col-sm-8",style:{paddingTop:"64px",paddingBottom:"64px"},children:[Object(k.jsxs)("button",{className:"btn btn-danger btn-sm image-popup-delete-button",onClick:function(){return j(e)},style:{marginRight:"8px"},children:[Object(k.jsx)("i",{className:"fa fa-trash"}),"\xa0Delete"]}),Object(k.jsxs)("button",{className:"btn btn-primary btn-sm image-popup-restore-button",onClick:function(){return O(e)},children:[Object(k.jsx)("i",{className:"fa fa-undo"}),"\xa0Restore"]})]})]},e.id)}))]}),Object(k.jsx)(z.a,{show:h,title:"Deleting Images",children:"Please wait while we delete all images..."})]})},q=n(71),G=n(39),Z=n(43),J=n(117),V=n.n(J),K=n(21),$=n(118),Q=n(121),ee=n(119),te=n(120),ne=function(){function e(t){Object(g.a)(this,e),this.dbConfig=void 0,this.db=null,this.dbConfig=t}return Object(j.a)(e,[{key:"createDB",value:function(){var e=Object(u.a)(o.a.mark((function e(){var t=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var a=indexedDB.open(t.dbConfig.dbName);a.onupgradeneeded=function(){a.result.createObjectStore(t.dbConfig.storeName)},a.onsuccess=function(){e(a.result)},a.onerror=function(){n(a.error)}})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"getDB",value:function(){var e=Object(u.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.db){e.next=4;break}return e.next=3,this.createDB();case 3:this.db=e.sent;case 4:return e.abrupt("return",this.db);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getItem",value:function(){var e=Object(u.a)(o.a.mark((function e(t){var n,a=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getDB();case 2:return n=e.sent,e.abrupt("return",new Promise((function(e,r){var s=n.transaction(a.dbConfig.storeName).objectStore(a.dbConfig.storeName).get(t);s.onsuccess=function(){e(s.result)},s.onerror=function(){e(null)}})));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setItem",value:function(){var e=Object(u.a)(o.a.mark((function e(t,n){var a,r=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getDB();case 2:return a=e.sent,e.abrupt("return",new Promise((function(e,s){var i=a.transaction(r.dbConfig.storeName,"readwrite").objectStore(r.dbConfig.storeName).put(n,t);i.onsuccess=function(){e()},i.onerror=function(){e()}})));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"deleteItem",value:function(){var e=Object(u.a)(o.a.mark((function e(t){var n,a=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getDB();case 2:return n=e.sent,e.abrupt("return",new Promise((function(e,r){var s=n.transaction(a.dbConfig.storeName,"readwrite").objectStore(a.dbConfig.storeName).delete(t);s.onsuccess=function(){e()},s.onerror=function(){e()}})));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),ae=new(function(){function e(){Object(g.a)(this,e),this.kvstore=void 0,this.kvstore=new ne({dbName:"saved-images",storeName:"images"})}return Object(j.a)(e,[{key:"listImages",value:function(){var e=Object(u.a)(o.a.mark((function e(t,n,a,r,s){var i,c,u,l,d,h,f,p,b,m,g;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.listImages(n,a,r,s,"id,updated_at,deleted_at");case 2:if((i=e.sent).data.images){e.next=5;break}return e.abrupt("return",void 0);case 5:c=[],u=[],l=Object(G.a)(i.data.images),e.prev=8,l.s();case 10:if((d=l.n()).done){e.next=23;break}if(!(h=d.value).deleted_at){e.next=17;break}return e.next=15,this.kvstore.deleteItem(h.id);case 15:e.next=21;break;case 17:return e.next=19,this.kvstore.getItem(h.id);case 19:(f=e.sent)&&f.updated_at===h.updated_at?c.push(f):u.push(h.id);case 21:e.next=10;break;case 23:e.next=28;break;case 25:e.prev=25,e.t0=e.catch(8),l.e(e.t0);case 28:return e.prev=28,l.f(),e.finish(28);case 31:if(!(u.length>0)){e.next=54;break}return e.next=34,t.batchGetImages(void 0,{ids:u});case 34:if(!(p=e.sent).data.images){e.next=54;break}b=Object(G.a)(p.data.images),e.prev=37,b.s();case 39:if((m=b.n()).done){e.next=46;break}return g=m.value,e.next=43,this.kvstore.setItem(g.id,g);case 43:c.push(g);case 44:e.next=39;break;case 46:e.next=51;break;case 48:e.prev=48,e.t1=e.catch(37),b.e(e.t1);case 51:return e.prev=51,b.f(),e.finish(51);case 54:return e.abrupt("return",c);case 55:case"end":return e.stop()}}),e,this,[[8,25,28,31],[37,48,51,54]])})));return function(t,n,a,r,s){return e.apply(this,arguments)}}()}]),e}()),re=function(e){var t=e.api,n=e.apiSocket,r=e.assetsUrl,s=Object(a.useState)(!1),i=Object(l.a)(s,2),c=i[0],d=(i[1],Object(a.useState)(null)),h=Object(l.a)(d,2),f=h[0],g=h[1],j=Object(a.useState)(null),v=Object(l.a)(j,2),x=(v[0],v[1],Object(a.useState)(!1)),y=Object(l.a)(x,2),w=y[0],C=y[1],S=Object(a.useState)([]),I=Object(l.a)(S,2),T=I[0],D=I[1],L=Object(a.useState)(null),M=Object(l.a)(L,2),P=(M[0],M[1]),E=Object(a.useState)(!0),_=Object(l.a)(E,2),R=_[0],A=_[1],U=Object(a.useState)(""),B=Object(l.a)(U,2),H=B[0],Y=B[1],X=Object(a.useState)(""),J=Object(l.a)(X,2),K=J[0],ne=J[1],re=Object(a.useState)(!1),se=Object(l.a)(re,2),ie=se[0],ce=se[1],oe=Object(a.useState)(!1),ue=Object(l.a)(oe,2),le=ue[0],de=ue[1],he=Object(a.useState)({}),fe=Object(l.a)(he,2),pe=fe[0],be=fe[1],me=Object(a.useState)(!0),ge=Object(l.a)(me,2),je=ge[0],ve=ge[1],Oe=Object(p.i)().id,xe=Object(p.g)();Object(a.useEffect)((function(){var e=setTimeout((function(){Y(K)}),500);return function(){clearTimeout(e)}}),[K]),Object(a.useEffect)((function(){if(Oe){var e=T.find((function(e){return e.id===Oe}));e&&g(e),t.getImage(Oe).then((function(e){g(e.data)}))}else g(null)}),[Oe]);Object(a.useEffect)((function(){t&&function(){var e=Object(u.a)(o.a.mark((function e(){var n,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Initial load images"),P(null),A(!0),e.prev=3,n=O()().add(1,"minutes").valueOf(),e.next=7,ae.listImages(t,n,H,100,"desc");case 7:return(a=e.sent)&&(console.log("Initial load images",a.length),D(a.sort(we))),e.abrupt("return",0);case 12:e.prev=12,e.t0=e.catch(3),P("Could not load images"),console.error(e.t0);case 16:case"end":return e.stop()}}),e,null,[[3,12]])})));return function(){return e.apply(this,arguments)}}()()}),[t,H]),Object(a.useEffect)((function(){if(t){var e=function(){var e=Object(u.a)(o.a.mark((function e(n){var a,r,s,i,c,u,l,d;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return P(null),a=n.reduce((function(e,t){return Math.max(e,t.updated_at)}),0),e.prev=2,e.next=5,ae.listImages(t,a+1,H,100,"asc");case 5:if(r=e.sent){s=a,i=Object(G.a)(r);try{for(i.s();!(c=i.n()).done;)(u=c.value).updated_at>s&&(s=u.updated_at)}catch(o){i.e(o)}finally{i.f()}l=r.filter((function(e){return n.findIndex((function(t){return t.id===e.id}))<0})),d=r.filter((function(e){return n.findIndex((function(t){return t.id===e.id}))>=0})),D((function(e){var t,n={},a=Object(G.a)(l);try{for(a.s();!(t=a.n()).done;){var r=t.value;r.deleted_at&&(n[r.id]=!0,console.log("Deleting image ".concat(r.id," from list")))}}catch(o){a.e(o)}finally{a.f()}var s,i=Object(G.a)(d);try{for(i.s();!(s=i.n()).done;){var c=s.value;c.deleted_at&&(n[c.id]=!0,console.log("Deleting image ".concat(c.id," from list")))}}catch(o){i.e(o)}finally{i.f()}return e=e.filter((function(e){return!n[e.id]})),[].concat(Object(N.a)(e.map((function(e){var t=d.find((function(t){return t.id===e.id}));return t||e}))),Object(N.a)(l.filter((function(e){return!e.deleted_at})))).sort(we)}))}return e.abrupt("return",n);case 10:e.prev=10,e.t0=e.catch(2),P("Could not load images"),console.error(e.t0);case 14:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t){return e.apply(this,arguments)}}(),n=setInterval((function(){e(T)}),6e4);return function(){clearInterval(n)}}}),[t,T,H]),Object(a.useEffect)((function(){var e=T.map((function(e){return e.id})),t=new Set(e);e.length!==t.size&&D((function(t){return t.filter((function(t,n){return e.indexOf(t.id)===n})).sort(we)}))}),[T]),Object(a.useEffect)((function(){var e=function(){var e=Object(u.a)(o.a.mark((function e(n){var a,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((a=JSON.parse(n)).type!==W.d&&a.type!==W.c){e.next=8;break}return e.next=4,t.getImage(a.id);case 4:if(!(r=e.sent).data.temporary){e.next=7;break}return e.abrupt("return");case 7:D((function(e){var t=e.findIndex((function(e){return e.id===r.data.id}));return(t>=0?e.map((function(e){return e.id===r.data.id?r.data:e})):[].concat(Object(N.a)(e),[r.data])).sort(we)}));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return n.addMessageListener(e),function(){n.removeMessageListener(e)}}),[n]);var ye=function(e){return e.status===b.c.Pending||e.status===b.c.Processing},we=function(e,t){if(ye(e)&&!ye(t))return-1;if(!ye(e)&&ye(t))return 1;if(e.parent===t.parent&&e.params.prompt==t.params.prompt&&e.status!==b.c.Pending&&t.status!==b.c.Pending){var n=e.score,a=t.score;return""!==e.params.prompt.trim()&&(n-=e.negative_score),""!==t.params.prompt.trim()&&(a-=t.negative_score),n==a?t.updated_at-e.updated_at:a-n}return t.updated_at-e.updated_at},ke=function(){var e=Object(u.a)(o.a.mark((function e(){var n,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=O()().valueOf(),T.forEach((function(e){n=Math.min(n,e.updated_at)})),e.next=4,ae.listImages(t,n-1,H,100,"desc");case 4:(a=e.sent)&&a.length>0?D((function(e){var t=e.reduce((function(e,t){return e[t.id]=t,e}),{});return a=(a||[]).filter((function(e){return!t[e.id]})),[].concat(Object(N.a)(e),Object(N.a)(a||[])).sort(we)})):A(!1);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ce=function(){var e=Object(u.a)(o.a.mark((function e(n){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.deleteImage(n.id);case 3:e.next=9;break;case 5:e.prev=5,e.t0=e.catch(0),console.error(e.t0),P("Error deleting image");case 9:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}(),Se=function(){var e=Object(u.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:xe.push({pathname:"/",search:"?parent=".concat(t.id)});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ie=function(){var e=Object(u.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:xe.push("/image-editor/".concat(t.id));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ne=function(e){ie?be(Object(m.a)(Object(m.a)({},pe),{},Object(q.a)({},e.id,!pe[e.id]))):xe.push("/saved/".concat(e.id))},Te=function(){var e=Object(u.a)(o.a.mark((function e(){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,de(!0),n=Object.keys(pe).map((function(e){return t.deleteImage(e)})),e.next=5,Promise.all(n);case 5:D((function(e){return e.filter((function(e){return!pe[e.id]}))})),be({}),ce(!1),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),console.error(e.t0),P("Error deleting images");case 14:return e.prev=14,de(!1),e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[0,10,14,17]])})));return function(){return e.apply(this,arguments)}}(),De=T.filter((function(e){return!e.deleted_at&&(e.status===b.c.Completed||e.status===b.c.Saved)})),Le=T.filter((function(e){return!e.deleted_at&&(e.status===b.c.Pending||e.status===b.c.Processing)})),Me=Le.filter((function(e){return e.status===b.c.Pending})),Pe=Le.filter((function(e){return e.status===b.c.Processing}));return Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)("h1",{style:{fontSize:"40px",textAlign:"left"},children:"Welcome to AiBrush - Saved"}),Object(k.jsxs)("div",{className:"saved-images",style:{marginTop:"48px",paddingBottom:"48px"},children:[Object(k.jsx)("div",{style:{textAlign:"left"},children:Object(k.jsxs)("div",{className:"input-group",style:{marginBottom:"16px"},children:[Object(k.jsx)("input",{style:{},value:K,type:"search",className:"form-control image-search",placeholder:"Search...",onChange:function(e){return ne(e.target.value)}}),Object(k.jsxs)("div",{style:{float:"right"},children:[!ie&&Object(k.jsxs)(k.Fragment,{children:[Object(k.jsxs)("button",{style:{display:"inline"},className:"btn btn-primary image-popup-button",onClick:function(){return ve(!je)},children:[!je&&Object(k.jsx)("i",{className:"fas fa-eye"}),je&&Object(k.jsx)("i",{className:"fas fa-eye-slash"})]}),Object(k.jsxs)(Z.a,{style:{display:"inline",marginLeft:"8px"},children:[Object(k.jsx)(Z.a.Toggle,{variant:"danger",children:Object(k.jsx)("i",{className:"fas fa-trash"})}),Object(k.jsxs)(Z.a.Menu,{children:[Object(k.jsx)(Z.a.Item,{onClick:function(){return ce(!0)},children:"Bulk Delete"}),Object(k.jsx)(Z.a.Item,{onClick:function(){return xe.push("/deleted-images")},children:"View Deleted Images"})]})]})]}),ie&&Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)("button",{className:"btn btn-primary image-popup-button",onClick:function(){ce(!1),be({})},children:"Cancel"}),Object(k.jsx)("button",{style:{marginLeft:"8px"},className:"btn image-popup-delete-button",onClick:function(){Te()},children:"Delete"})]})]})]})}),Object(k.jsxs)($.a,{dataLength:T.length,next:ke,hasMore:R,loader:Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)("hr",{}),Object(k.jsx)("h4",{children:"Loading..."})]}),children:[Le.length>0&&Object(k.jsx)(ee.a,{pendingCount:Me.length,processingCount:Pe.length,onClick:function(){C(!0)}}),De.map((function(e){return Object(k.jsx)(F.a,{image:e,assetsUrl:r,onClick:Ne,bulkDelete:ie&&pe[e.id],censorNSFW:je},e.id)}))]})]}),f&&Object(k.jsx)(Q.a,{assetsUrl:r,image:f,onClose:function(){return xe.push("/saved")},onDelete:function(e){Ce(e),D(T.filter((function(t){return t.id!==e.id}))),xe.push("/saved")},onFork:function(e){Se(e)},onEdit:function(e){Ie(e)},onNSFW:function(e,n){t.updateImage(e.id,{nsfw:n}).then((function(t){D((function(n){return n.map((function(n){return n.id===e.id?t.data:n}))})),g(t.data)}))},censorNSFW:je}),Object(k.jsx)(V.a,{}),Object(k.jsx)(z.a,{show:c,title:"Creating images",children:Object(k.jsx)("p",{children:"Please wait while we create your image."})}),Object(k.jsx)(z.a,{show:le,title:"Deleting images",children:Object(k.jsx)("p",{children:"Please wait while we delete your images."})}),Object(k.jsx)(te.a,{images:Le,onCancel:function(){return C(!1)},show:w,onDeleteImage:function(e){Ce(e),D(T.filter((function(t){return t.id!==e.id})))}})]})},se=n(75),ie=n.n(se),ce=n(212),oe=function(){var e=Object(a.useState)(),t=Object(l.a)(e,2),n=t[0],r=t[1],s=Object(a.useState)(),i=Object(l.a)(s,2),c=i[0],d=i[1],h=Object(a.useState)(),f=Object(l.a)(h,2),p=f[0],b=f[1];Object(a.useEffect)((function(){var e=new K.a;return b(e),function(){e.destroy()}}),[]);var m=function(e){var t=document.createElement("canvas");t.width=e.width,t.height=e.height;var n=t.getContext("2d");if(!n)throw new Error("Could not get canvas context");return n.putImageData(e,0,0),t},g=function(e){console.log("upscaling image data",e.width,e.height);var t=document.createElement("canvas");t.width=2*e.width,t.height=2*e.height;var n=t.getContext("2d");if(!n)throw new Error("Could not get canvas context");var a=m(e);return n.drawImage(a,0,0,t.width,t.height),t},j=function(){var e=Object(u.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(p){e.next=2;break}throw new Error("Image worker not initialized");case 2:(n=t.target.files)&&n.length>0&&ie()(n[0],function(){var e=Object(u.a)(o.a.mark((function e(t){var n,a,s,i,c,u,l,h,f,b,j,v,O,x,y;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=(n=t).toDataURL("image/png"),r(a),!(s=n.getContext("2d"))){e.next=37;break}if(i=s.getImageData(0,0,n.width,n.height),c=Object(K.l)(i)){e.next=10;break}return d(a),e.abrupt("return");case 10:console.log("splitResult",{numTilesX:c.numTilesX,numTilesY:c.numTilesY,tileSize:c.tileSize}),c.tileSize*=2,c.imageWidth*=2,c.imageHeight*=2,u=0;case 15:if(!(u<c.numTilesX)){e.next=32;break}l=0;case 17:if(!(l<c.numTilesY)){e.next=29;break}return h=c.tiles[u][l],f=g(h),b=f.getContext("2d").getImageData(0,0,f.width,f.height),j=ce.a(),e.next=24,p.processRequest({id:j,alphaMode:"none",feather:!0,width:c.imageWidth,height:c.imageHeight,pixels:b.data,selectionOverlay:{x:u*(c.tileSize-64),y:l*(c.tileSize-64),width:f.width,height:f.height},upscale:!0,featherWidth:64});case 24:v=e.sent,c.tiles[u][l]=new ImageData(v.pixels,f.width,f.height);case 26:l++,e.next=17;break;case 29:u++,e.next=15;break;case 32:O=Object(K.j)(c),console.log("upscaled image data size",O.width,O.height),x=m(O),y=x.toDataURL("image/png"),d(y);case 37:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{canvas:!0});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(k.jsxs)("div",{children:[Object(k.jsx)("input",{type:"file",onChange:j}),n&&c&&Object(k.jsxs)("div",{children:["Original:",Object(k.jsx)("br",{}),Object(k.jsx)("img",{src:n}),Object(k.jsx)("br",{}),"Upscaled:",Object(k.jsx)("br",{}),Object(k.jsx)("img",{src:c})]})]})},ue=function(e){var t=e.api,n=e.apisocket,r=Object(a.useState)({free_credits:0,paid_credits:0}),s=Object(l.a)(r,2),i=s[0],c=s[1];return Object(a.useEffect)((function(){var e=function(){var e=Object(u.a)(o.a.mark((function e(){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getCredits();case 2:n=e.sent,c(n.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e();var a=setInterval(e,6e4),r=function(t){JSON.parse(t).type===W.b&&e()};return n.addMessageListener(r),function(){clearInterval(a),n.removeMessageListener(r)}}),[t,n]),Object(k.jsxs)("div",{children:[Object(k.jsxs)("div",{style:{color:"#00f0f0"},children:[Object(k.jsx)("span",{children:"Paid credits: "}),Object(k.jsx)("span",{children:i.paid_credits})]}),Object(k.jsxs)("div",{children:[Object(k.jsx)("span",{children:"Free credits: "}),Object(k.jsx)("span",{children:i.free_credits})]})]})},le=n(387),de=n(194),he=n(209),fe=n(391),pe=(n(377),function(e){var t=e.title,n=e.price,a=e.description,r=e.buttonText,s=e.onButtonClick;return Object(k.jsx)(fe.a,{style:{width:"18rem",textAlign:"center"},className:"mb-4",children:Object(k.jsxs)(fe.a.Body,{children:[Object(k.jsx)(fe.a.Text,{style:{textAlign:"right",marginBottom:"8px"},children:Object(k.jsxs)("h3",{children:["$",n]})}),Object(k.jsx)(fe.a.Title,{style:{textAlign:"left",marginTop:"0px",marginBottom:"24px"},children:Object(k.jsx)("i",{style:{fontSize:"40px",paddingRight:"8px"},className:"font-weight-bold gradient-title",children:t})}),Object(k.jsx)(fe.a.Text,{children:a}),Object(k.jsx)(L.a,{variant:"primary",onClick:s,children:r})]})})}),be=(n(378),n(26)),me=n(388),ge=function(e){var t=e.state,n=e.onHide;return Object(k.jsx)(be.a,{show:!0,onHide:"busy"===t?void 0:n,centered:!0,children:function(){switch(t){case"busy":return Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)(be.a.Header,{children:Object(k.jsx)(be.a.Title,{children:"Redeeming Code"})}),Object(k.jsxs)(be.a.Body,{className:"text-center",children:[Object(k.jsx)(me.a,{animation:"border"}),Object(k.jsx)("p",{children:"Processing your code..."})]})]});case"success":return Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)(be.a.Header,{children:Object(k.jsx)(be.a.Title,{children:"Code Redeemed"})}),Object(k.jsx)(be.a.Body,{className:"text-center",children:Object(k.jsx)("p",{children:"Your code has been successfully redeemed! You should see an update to your credits balance shortly."})}),Object(k.jsx)(be.a.Footer,{children:Object(k.jsx)(L.a,{variant:"primary",onClick:n,children:"Close"})})]});case"failure":return Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)(be.a.Header,{children:Object(k.jsx)(be.a.Title,{children:"Code Redemption Failed"})}),Object(k.jsx)(be.a.Body,{className:"text-center",children:Object(k.jsx)("p",{children:"Something went wrong. Please try again later or contact support."})}),Object(k.jsx)(be.a.Footer,{children:Object(k.jsx)(L.a,{variant:"danger",onClick:n,children:"Close"})})]});default:return null}}()})},je=function(e){var t=e.api,n=Object(a.useState)(""),r=Object(l.a)(n,2),s=r[0],i=r[1],c=Object(a.useState)(void 0),d=Object(l.a)(c,2),h=d[0],f=d[1],p=Object(a.useState)(void 0),b=Object(l.a)(p,2),m=b[0],g=b[1],j=function(){var e=Object(u.a)(o.a.mark((function e(n){var a,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(m){e.next=3;break}return alert("Payments are not working right now. Please contact support at admin@aibrush.art."),e.abrupt("return");case 3:return console.log("buying product",n),a="".concat(window.location.protocol,"//").concat(window.location.host),e.next=7,t.createStripeSession({product_id:n,success_url:"".concat(a,"/stripe-success"),cancel_url:"".concat(a,"/stripe-cancel")});case 7:return r=e.sent,console.log("got session id",r.data),e.next=11,m.redirectToCheckout({sessionId:r.data.session_id});case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){(function(){var e=Object(u.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(he.a)("pk_live_51MB0zEC2IU2ctHz653kY6uo9UcwgPxmcw2ISGzThAAQMtklAV2kfuceigzlL9LjCNyXCJkcIouVajlX8ErrRtWaz00Tqobzi2s");case 2:if(t=e.sent){e.next=6;break}return console.error("Failed to load Stripe library"),e.abrupt("return");case 6:g(t);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]),Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)("h2",{children:"Unlock the Power of AI"}),Object(k.jsx)("div",{style:{display:"flex",justifyContent:"center",marginTop:"40px"},children:Object(k.jsx)("p",{style:{fontSize:"20px",textAlign:"center"},className:"pricing-page-desc",children:"Generate stunning images with our state-of-the-art Stable Diffusion AI with over 100 models to choose from. Purchase credits to create your unique masterpieces without breaking the bank. Choose from our flexible credit packages and get started today!"})}),Object(k.jsxs)(le.a,{className:"justify-content-center",style:{maxWidth:"1200px",margin:"64px auto"},children:[Object(k.jsx)(de.a,{lg:4,className:"d-flex justify-content-center",children:Object(k.jsx)(pe,{title:"Starter",price:2,description:"Dip your toes into the world of AI-generated art with 600 credits. Perfect for first-time users who want to explore the possibilities.",buttonText:"Buy Now",onButtonClick:function(){j("starter")}})}),Object(k.jsx)(de.a,{lg:4,className:"d-flex justify-content-center",children:Object(k.jsx)(pe,{title:"Creative",price:5,description:"Fuel your creativity with 2000 credits, offering great value for budding artists and enthusiasts. Unleash your potential!",buttonText:"Buy Now",onButtonClick:function(){j("creative")}})}),Object(k.jsx)(de.a,{lg:4,className:"d-flex justify-content-center",children:Object(k.jsx)(pe,{title:"Pro",price:10,description:"Get the ultimate AI art experience with 6000 credits. Ideal for professionals and prolific creators who demand the best.",buttonText:"Buy Now",onButtonClick:function(){j("pro")}})})]}),Object(k.jsx)(le.a,{className:"justify-content-center mt-5",children:Object(k.jsxs)(de.a,{lg:6,children:[Object(k.jsx)("h2",{className:"text-center mb-4",children:"Redeem Code"}),Object(k.jsx)("p",{className:"text-center",children:"Have a gift code from our awesome admin? Enter it here to redeem your free credits and start creating!"}),Object(k.jsxs)(T.a,{onSubmit:function(e){e.preventDefault(),f("busy"),i(""),t.redeemDepositCode(s).then((function(){f("success")})).catch((function(){f("failure")}))},children:[Object(k.jsx)(T.a.Group,{controlId:"redeemCode",children:Object(k.jsx)(T.a.Control,{type:"text",placeholder:"Enter code here",value:s,onChange:function(e){return i(e.target.value)}})}),Object(k.jsx)("div",{className:"text-center",style:{marginBottom:"50px"},children:Object(k.jsx)(L.a,{variant:"primary",type:"submit",children:"Redeem"})})]})]})}),h&&Object(k.jsx)(ge,{state:h,onHide:function(){return f(void 0)}})]})},ve={apiUrl:""},Oe=h.a.create(),xe=new b.a(void 0,localStorage.getItem("apiUrl")||ve.apiUrl,Oe),ye=new W.a,we=new x;function ke(e){e.accessToken&&(Oe.defaults.headers.common.Authorization="Bearer ".concat(e.accessToken))}var Ce=function(){var e=Object(a.useState)(null),t=Object(l.a)(e,2),n=t[0],r=t[1],s=Object(a.useState)("/api/images"),i=Object(l.a)(s,2),c=i[0],d=i[1],h=Object(a.useState)(!1),b=Object(l.a)(h,2),m=b[0],g=b[1],j=Object(a.useState)(null),v=Object(l.a)(j,2),O=v[0],x=v[1],y=function(){r(null),localStorage.removeItem("credentials"),Oe.defaults.headers.common.Authorization=void 0},w=function(){var e=Object(u.a)(o.a.mark((function e(){var t,n,a,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("App.init"),e.next=3,we.init();case 3:if(xe.getAssetsUrl().then((function(e){return d(e.data.assets_url)})),xe.getFeatures().then((function(e){return x(e.data)})),!(t=localStorage.getItem("credentials"))){e.next=28;break}return e.prev=7,ke(n=JSON.parse(t)),e.next=12,xe.refresh({refreshToken:n.refreshToken});case 12:return a=e.sent,r(a.data),localStorage.setItem("credentials",JSON.stringify(a.data)),ke(a.data),e.next=18,xe.isAdmin();case 18:s=e.sent,g(!!s.data.is_admin),ye.updateToken(a.data.accessToken),ye.connect(),e.next=28;break;case 24:e.prev=24,e.t0=e.catch(7),console.log(e.t0),localStorage.removeItem("credentials");case 28:case"end":return e.stop()}}),e,null,[[7,24]])})));return function(){return e.apply(this,arguments)}}(),N=function(){var e=Object(u.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:localStorage.setItem("credentials",JSON.stringify(t)),r(t),ke(t),ye.updateToken(t.accessToken),ye.connect();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){w()}),[]),Object(k.jsxs)("div",{className:"App",children:[Object(k.jsx)(S,{api:xe,credentials:n,onCredentialsRefreshed:N,onCredentialsExpired:function(){y()}}),Object(k.jsx)(I,{api:xe}),Object(k.jsxs)(f.a,{children:[!n&&Object(k.jsxs)(p.d,{children:[Object(k.jsx)(p.b,{path:"/",exact:!0,children:Object(k.jsx)(C,{client:xe,onLogin:N})}),Object(k.jsx)(p.b,{path:"/discord-login",children:Object(k.jsx)(Y,{client:xe,onLogin:N})}),Object(k.jsx)(p.b,{path:"*",children:Object(k.jsx)(C,{client:xe,onLogin:N})})]}),n&&Object(k.jsxs)("div",{className:"container",children:[Object(k.jsxs)("div",{className:"row",children:[Object(k.jsx)("div",{className:"col-lg-12",children:n&&Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)("button",{className:"btn btn-primary top-button",onClick:function(){return y()},children:Object(k.jsx)("i",{className:"fas fa-sign-out-alt"})}),Object(k.jsx)(f.b,{className:"btn btn-primary top-button",to:"/saved",children:Object(k.jsx)("i",{className:"fas fa-save"})}),Object(k.jsx)(f.b,{className:"btn btn-primary top-button",to:"/",children:Object(k.jsx)("i",{className:"fas fa-home"})}),Object(k.jsx)("a",{className:"btn btn-primary top-button",href:"https://discord.gg/HYcFpDeqKJ",target:"_blank",children:Object(k.jsx)("i",{className:"fab fa-discord"})}),Object(k.jsx)(f.b,{className:"btn top-button pulse",to:"/pricing",style:{width:"47px"},children:Object(k.jsx)("i",{className:"fas fa-bolt"})})]})}),Object(k.jsx)("div",{className:"col-lg-12",style:{textAlign:"right"},children:Object(k.jsx)(ue,{api:xe,apisocket:ye})})]}),Object(k.jsxs)(p.d,{children:[Object(k.jsx)(p.b,{path:"/",exact:!0,children:Object(k.jsx)(H.a,{api:xe,apiSocket:ye,assetsUrl:c,localImages:we})}),Object(k.jsx)(p.b,{path:"/stripe-success",children:Object(k.jsx)(H.a,{api:xe,apiSocket:ye,assetsUrl:c,localImages:we,paymentStatus:"success"})}),Object(k.jsx)(p.b,{path:"/stripe-cancel",children:Object(k.jsx)(H.a,{api:xe,apiSocket:ye,assetsUrl:c,localImages:we,paymentStatus:"canceled"})}),Object(k.jsx)(p.b,{path:"/images/:id",children:Object(k.jsx)(H.a,{api:xe,apiSocket:ye,assetsUrl:c,localImages:we})}),Object(k.jsx)(p.b,{path:"/saved",exact:!0,children:Object(k.jsx)(re,{api:xe,apiSocket:ye,assetsUrl:c})}),Object(k.jsx)(p.b,{path:"/saved/:id",exact:!0,children:Object(k.jsx)(re,{api:xe,apiSocket:ye,assetsUrl:c})}),Object(k.jsx)(p.b,{path:"/image-editor/:id",children:Object(k.jsx)(U.a,{api:xe,apisocket:ye,assetsUrl:c,localImages:we})}),Object(k.jsx)(p.b,{path:"/deleted-images",children:Object(k.jsx)(B,{api:xe,assetsUrl:c})}),Object(k.jsx)(p.b,{path:"/local-deleted-images",children:Object(k.jsx)(X,{localImages:we})}),Object(k.jsx)(p.b,{path:"/pricing",children:Object(k.jsx)(je,{api:xe})}),Object(k.jsx)(p.b,{path:"/testpage",children:Object(k.jsx)(oe,{})}),m&&Object(k.jsx)(k.Fragment,{children:Object(k.jsx)(p.b,{path:"/admin",children:Object(k.jsx)(A,{api:xe})})})]}),Object(k.jsxs)("div",{style:{position:"fixed",bottom:"0",left:"0",width:"100%",height:"50px",paddingTop:"16px",backgroundColor:"#000000"},children:[O&&O.privacy_uri&&Object(k.jsx)("a",{href:O.privacy_uri,target:"_blank",children:"Privacy Policy"}),O&&O.terms_uri&&Object(k.jsx)("a",{href:O.terms_uri,target:"_blank",style:{marginLeft:"20px"},children:"Terms of Service"}),Object(k.jsx)("a",{href:"mailto:admin@aibrush.art",style:{marginLeft:"20px"},children:"Contact"}),Object(k.jsxs)("span",{style:{float:"right",marginRight:"50px"},children:["Powered by the"," ",Object(k.jsx)("a",{href:"https://stablehorde.net/",target:"_blank",children:"Stable Horde"})]})]})]})]})]})},Se=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,392)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,s=t.getLCP,i=t.getTTFB;n(e),a(e),r(e),s(e),i(e)}))};i.a.render(Object(k.jsx)(r.a.StrictMode,{children:Object(k.jsx)(Ce,{})}),document.getElementById("root")),Se()},38:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(16),r=n(17),s=function(){function e(t){Object(a.a)(this,e),this.renderer=t,this.startTouches=void 0,this.startZoom=1,this.startOffsetX=0,this.startOffsetY=0,this.startTouches=null}return Object(r.a)(e,[{key:"onWheel",value:function(e){var t=this.renderer.getZoom(),n=this.renderer.getZoom(),a=this.renderer.getOffsetX(),r=this.renderer.getOffsetY(),s=this.translateMouseToCanvasCoordinates(e.offsetX,e.offsetY);e.deltaY<0?n+=.1*n:n-=.1*n,n=Math.max(.1,Math.min(n,8));var i=s.x- -a,c=s.y- -r;a-=i*(n/t)-i,r-=c*(n/t)-c,this.renderer.updateZoomAndOffset(n,a,r)}},{key:"onPan",value:function(e){var t=e.movementX,n=e.movementY,a=e.target.getBoundingClientRect();t=t/a.width*512,n=n/a.height*512;var r=this.renderer.getZoom(),s=this.renderer.getOffsetX(),i=this.renderer.getOffsetY();s+=t/r,i+=n/r,this.renderer.updateZoomAndOffset(r,s,i)}},{key:"onTouchStart",value:function(e){2===e.touches.length&&(this.startTouches=e.touches,this.startZoom=this.renderer.getZoom(),this.startOffsetX=this.renderer.getOffsetX(),this.startOffsetY=this.renderer.getOffsetY())}},{key:"onTouchMove",value:function(e){if(this.startTouches){var t=this.renderer.getCanvas().getBoundingClientRect(),n=this.startTouches[0],a=this.startTouches[1],r=e.touches[0],s=e.touches[1],i=Math.sqrt(Math.pow(n.clientX-a.clientX,2)+Math.pow(n.clientY-a.clientY,2)),c=Math.sqrt(Math.pow(r.clientX-s.clientX,2)+Math.pow(r.clientY-s.clientY,2)),o=this.startZoom*(c/i),u=(n.clientX+a.clientX)/2,l=(n.clientY+a.clientY)/2,d=(r.clientX+s.clientX)/2,h=(r.clientY+s.clientY)/2,f=this.translateMouseToCanvasCoordinates(u-t.left,l-t.top),p=this.translateMouseToCanvasCoordinates(d-t.left,h-t.top),b=this.startOffsetX,m=this.startOffsetY,g=p.x-f.x,j=p.y-f.y,v=p.x- -this.renderer.getOffsetX(),O=p.y- -this.renderer.getOffsetY();b-=v*(o/this.startZoom)-v-g*(c/i),m-=O*(o/this.startZoom)-O-j*(c/i),this.renderer.updateZoomAndOffset(o,b,m)}}},{key:"onTouchEnd",value:function(e){this.startTouches=null}},{key:"translateMouseToCanvasCoordinates",value:function(e,t,n,a,r){var s=e,i=t;n=n||this.renderer.getZoom(),a=a||this.renderer.getOffsetX(),r=r||this.renderer.getOffsetY(),s/=n,i/=n;var c=this.renderer.getCanvas().getBoundingClientRect();return s=s/c.width*512,i=i/c.height*512,{x:s=Math.round(s-a),y:i=Math.round(i-r)}}},{key:"translateCanvasToMouseCoordinates",value:function(e,t,n,a,r){n=n||this.renderer.getZoom(),e+=a=a||this.renderer.getOffsetX(),t+=r=r||this.renderer.getOffsetY(),e*=n,t*=n;var s=this.renderer.getCanvas().getBoundingClientRect();return{x:e=Math.round(e/this.renderer.getWidth()*s.width),y:t=Math.round(t/this.renderer.getHeight()*s.height)}}}]),e}(),i=function(){function e(t,n){Object(a.a)(this,e),this.renderer=t,this.name=n,this.saveListener=function(){},this.touchHandle=void 0,this.zoomHelper=void 0,this._pinchZooming=!1,this._panning=!1,this.zoomHelper=new s(t)}return Object(r.a)(e,[{key:"getArgs",value:function(){return JSON.parse(localStorage.getItem("tool_args_".concat(this.name))||"{}")}},{key:"updateArgs",value:function(e){localStorage.setItem("tool_args_".concat(this.name),JSON.stringify(e))}},{key:"onMouseDown",value:function(e){1===e.button&&(this._panning=!0)}},{key:"onMouseMove",value:function(e){this._panning&&this.zoomHelper.onPan(e);var t=this.zoomHelper.translateMouseToCanvasCoordinates(e.nativeEvent.offsetX,e.nativeEvent.offsetY),n=t.x,a=t.y;this._updateCursor(n,a)}},{key:"_updateCursor",value:function(e,t){this.renderer.setCursor({color:"white",radius:10,type:"crosshairs",x:e,y:t})}},{key:"onMouseUp",value:function(e){this._panning&&(this._panning=!1)}},{key:"onMouseLeave",value:function(e){}},{key:"onTouchStart",value:function(e){var t=this;this.touchHandle&&window.clearTimeout(this.touchHandle);for(var n=[],a=0;a<e.touches.length;a++){var r=e.touches[a];n.push({identifier:r.identifier,clientX:r.clientX,clientY:r.clientY,pageX:r.pageX,pageY:r.pageY,screenX:r.screenX,screenY:r.screenY,target:null})}e={touches:n},this.touchHandle=window.setTimeout((function(){if(t.touchHandle=void 0,2===e.touches.length)t._pinchZooming=!0,t.zoomHelper.onTouchStart(e);else{var n=t.renderer.getCanvas().getBoundingClientRect(),a=e.touches[0];a&&t.onMouseDown({type:"touch",button:0,nativeEvent:{offsetX:a.clientX-n.left,offsetY:a.clientY-n.top}})}}),200)}},{key:"onTouchMove",value:function(e){if(2===e.touches.length)this.zoomHelper.onTouchMove(e);else{var t=this.renderer.getCanvas().getBoundingClientRect(),n=e.touches[0];n&&this.onMouseMove({type:"touch",button:0,nativeEvent:{offsetX:n.clientX-t.left,offsetY:n.clientY-t.top}})}}},{key:"onTouchEnd",value:function(e){this._pinchZooming?(this._pinchZooming=!1,this.zoomHelper.onTouchEnd(e)):this.onMouseUp({button:0,type:"touch"})}},{key:"onKeyDown",value:function(e){}},{key:"onKeyUp",value:function(e){}},{key:"onWheel",value:function(e){this.zoomHelper.onWheel(e)}},{key:"destroy",value:function(){return!0}},{key:"onShowSelectionControls",value:function(e){}},{key:"select",value:function(e){}},{key:"onSaveImage",value:function(e){this.saveListener=e}}]),e}()},45:function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return u}));var a=n(39),r=n(16),s=n(17),i="image_updated",c="image_deleted",o="credits_updated",u=function(){function e(){Object(r.a)(this,e),this.client=void 0,this.accessToken=void 0,this.messageListeners=[]}return Object(s.a)(e,[{key:"updateToken",value:function(e){this.accessToken=e}},{key:"addMessageListener",value:function(e){this.messageListeners.push(e)}},{key:"removeMessageListener",value:function(e){this.messageListeners=this.messageListeners.filter((function(t){return t!==e}))}},{key:"connect",value:function(){var e=this;if(!this.accessToken)throw new Error("unauthenticated");if(this.client)this.client.close();else{this.client=new WebSocket("".concat("wss","://").concat("www.aibrush.art")),this.client.onerror=function(e){return console.error(e)},this.client.onopen=function(){console.log("websocket connected"),e.client.send(e.accessToken)},this.client.onmessage=function(t){console.log("server push",t.data);var n,r=Object(a.a)(e.messageListeners);try{for(r.s();!(n=r.n()).done;){(0,n.value)(t.data)}}catch(s){r.e(s)}finally{r.f()}},this.client.onclose=function(){console.log("websocket closed"),e.client=void 0,setTimeout((function(){return e.connect()}),500)}}}}]),e}()},50:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return c}));var a=n(16),r=n(17),s=function(){function e(t,n){Object(a.a)(this,e),this.key=void 0,this.listSize=void 0,this.key=t,this.listSize=n}return Object(r.a)(e,[{key:"getRecentItems",value:function(){var e=localStorage.getItem(this.key);return e?JSON.parse(e):[]}},{key:"saveRecentItems",value:function(e){localStorage.setItem(this.key,JSON.stringify(e))}},{key:"addItem",value:function(e){var t=this.getRecentItems(),n=t.indexOf(e);-1!==n&&t.splice(n,1),t.unshift(e),t.length>this.listSize&&t.pop(),this.saveRecentItems(t)}},{key:"getItems",value:function(){return this.getRecentItems()}}]),e}(),i=new s("recent-models",20),c=new s("recent-negative-prompts",20);new s("recent-positive-prompts",20)},56:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(0),r=function(e){var t=e.imagesCost;return Object(a.jsx)("div",{style:{textAlign:"left"},children:Object(a.jsxs)("span",{className:"helptext",style:{color:"#00f0f0"},children:["Cost: ",t," credit",t>1?"s":"","\xa0",Object(a.jsx)("i",{className:"fas fa-info-circle",style:{cursor:"pointer"},onClick:function(){return alert("The cost is based on the image count and the size of each image. A single 512x512 image costs 1 credit.")}})]})})}},57:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(4),r=n(1),s=n(14),i=n.n(s),c=n(15),o=n(0),u=function(e){var t=e.assetsUrl,n=e.image,s=e.censorNSFW,u=e.bulkDelete,l=e.onClick,d="".concat(t,"/").concat(n.id,".thumbnail.png?updated_at=").concat(n.updated_at),h=Object(r.useState)(""),f=Object(a.a)(h,2),p=f[0],b=f[1];Object(r.useEffect)((function(){if(i()().diff(i()(n.updated_at),"minutes")<1){b("");var e=setTimeout((function(){b("&retry")}),3e3);return function(){return clearTimeout(e)}}}),[n.id,n.updated_at]);var m=n.label;""===n.label&&(m=n.params.prompt||""),-1!==m.indexOf(",")&&(m=m.substring(0,m.indexOf(",")));var g="image-thumbnail";u&&(g+=" bulk-delete");var j="url(".concat(d).concat(p,"), url(/images/default.png)");return n.imageData&&(j="url(".concat(n.imageData,"), url(/images/default.png)")),Object(o.jsxs)("div",{className:g,style:{backgroundImage:j,backgroundRepeat:"no-repeat",backgroundPosition:"center",filter:n.nsfw&&s?"blur(8px)":void 0},onClick:function(){return l&&l(n)},children:[!u&&Object(o.jsx)("div",{className:"image-thumbnail-label",children:m}),u&&Object(o.jsx)("div",{className:"image-thumbnail-label",children:Object(o.jsx)("input",{type:"checkbox",style:{width:"20px",height:"20px",marginLeft:"16px",marginTop:"16px"},checked:!0,readOnly:!0})}),n.status===c.c.Pending&&Object(o.jsx)("div",{className:"image-thumbnail-pending",children:Object(o.jsx)("i",{style:{marginTop:"20px"},className:"fa fa-hourglass-half"})}),n.status===c.c.Processing&&Object(o.jsx)("div",{className:"image-thumbnail-pending",children:Object(o.jsx)("i",{style:{marginTop:"20px"},className:"fa fa-cog fa-spin"})})]})}},59:function(e,t,n){"use strict";n.d(t,"b",(function(){return N})),n.d(t,"a",(function(){return D}));var a=n(2),r=n.n(a),s=n(5),i=n(4),c=n(1),o=n(18),u=n(20),l=n(75),d=n.n(l),h=n(110),f=n(21),p=["Epic Diffusion","Rev Animated","Anything v3","Hentai Diffusion","Ranma Diffusion","URPM","Deliberate","GTA5 Artwork Diffusion","ChilloutMix","Realism Engine","AIO Pixel Art","Microworlds","Microchars","OrbAI","App Icon Diffusion"],b=["canny","hed","depth","normal","openpose","seg","scribble","fakescribbles","hough"],m=n(389),g=n(192),j=n(83),v=n(193),O=n(0),x=function(e){var t=e.seed,n=e.setSeed,a=Object(c.useState)(!1),r=Object(i.a)(a,2),s=r[0],o=r[1];return Object(O.jsxs)(m.a,{children:[Object(O.jsx)(g.a,{children:Object(O.jsx)(j.a,{type:"checkbox",label:"Use Custom Seed",checked:s,onChange:function(e){return o(!s),void n(s?"":Math.floor(1e9*Math.random()).toString())}})}),s&&Object(O.jsx)(g.a,{children:Object(O.jsx)(v.a,{type:"text",placeholder:"Enter seed",value:t,onChange:function(e){return n(e.target.value)}})})]})},y=n(78),w=n(77),k=n(56),C=n(50),S=n(43),I=function(e){var t=e.value,n=e.onChange,a=e.history,r=Object(c.useState)(!1),s=Object(i.a)(r,2),o=s[0],u=s[1];return Object(O.jsxs)("div",{children:[Object(O.jsx)(v.a,{value:t,onChange:function(e){n(e.target.value)},onClick:function(){u(!o)},onBlur:function(){setTimeout((function(){return u(!1)}),200)}}),Object(O.jsxs)(S.a,{show:o,onSelect:function(e){e&&n(e),u(!1)},children:[Object(O.jsx)(S.a.Toggle,{variant:"success",id:"dropdown-basic",style:{height:"0px",padding:"0px",visibility:"hidden",position:"absolute"}}),Object(O.jsx)(S.a.Menu,{style:{width:"100%",overflow:"hidden"},children:a.map((function(e,t){return Object(O.jsx)(S.a.Item,{eventKey:e,children:e},t)}))})]})]})};function N(){return{params:{prompt:"",negative_prompt:T(),width:512,height:512,steps:20,denoising_strength:.75},label:"",encoded_image:"",encoded_mask:"",model:"Epic Diffusion",count:4}}function T(){return C.b.getItems()[0]||"low quality, distorted, deformed, dull, boring, plain, ugly, noise"}var D=function(e){var t=e.api,n=e.parent,a=e.creating,l=(e.assetsUrl,e.onSubmit),m=e.onCancel,g=e.onEdit,j=Object(c.useState)(""),v=Object(i.a)(j,2),S=v[0],D=v[1],L=Object(c.useState)(T()),M=Object(i.a)(L,2),P=M[0],E=M[1],_=Object(c.useState)(4),R=Object(i.a)(_,2),A=R[0],U=R[1],F=Object(c.useState)(.75),z=Object(i.a)(F,2),B=z[0],H=z[1],W=Object(c.useState)(u.a),Y=Object(i.a)(W,2),X=Y[0],q=Y[1],G=Object(c.useState)(null),Z=Object(i.a)(G,2),J=Z[0],V=Z[1],K=Object(c.useState)(!1),$=Object(i.a)(K,2),Q=$[0],ee=$[1],te=Object(c.useState)(""),ne=Object(i.a)(te,2),ae=ne[0],re=ne[1],se=Object(c.useState)("Epic Diffusion"),ie=Object(i.a)(se,2),ce=ie[0],oe=ie[1],ue=Object(c.useState)(!1),le=Object(i.a)(ue,2),de=le[0],he=le[1],fe=Object(c.useState)(),pe=Object(i.a)(fe,2),be=pe[0],me=pe[1],ge=Object(c.useState)(7.5),je=Object(i.a)(ge,2),ve=je[0],Oe=je[1],xe=Object(c.useState)(""),ye=Object(i.a)(xe,2),we=ye[0],ke=ye[1],Ce=Object(c.useState)(1),Se=Object(i.a)(Ce,2),Ie=Se[0],Ne=Se[1],Te=u.b[u.a],De=Object(c.useState)(u.b[u.a]),Le=Object(i.a)(De,2),Me=Le[0],Pe=Le[1],Ee=Object(c.useState)(Te.width),_e=Object(i.a)(Ee,2),Re=_e[0],Ae=_e[1],Ue=Object(c.useState)(Te.height),Fe=Object(i.a)(Ue,2),ze=Fe[0],Be=Fe[1],He=function(){D(""),E(C.b.getItems()[0]||T),ee(!1),V(null),q(u.a),Pe(u.b[u.a]),re(""),ke("")},We=function(){var e=Object(s.a)(r.a.mark((function e(t){var a,s,i;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(P&&C.b.addItem(P),t.preventDefault(),(a=N()).params.prompt=S||"",a.params.negative_prompt=P||"",a.count=we?1:A,a.parent=J||void 0,a.params.denoising_strength=B,a.nsfw=!0,a.model=ce,a.temporary=!0,a.params.controlnet_type=be,a.params.cfg_scale=ve,a.params.seed=we||void 0,n?(s=Object(u.c)(n.params.width,n.params.height).scale(Ie),a.params.width=s.width,a.params.height=s.height):(i=Object(u.c)(Me.width,Me.height).scale(Ie),a.params.width=i.width,a.params.height=i.height),!ae){e.next=19;break}return e.next=18,Object(f.k)(ae,a.params.width,a.params.height,"png");case 18:a.encoded_image=e.sent;case 19:He(),l(a);case 21:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ye=function(){var e=Object(s.a)(r.a.mark((function e(t){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.target.files&&t.target.files[0]){e.next=3;break}return e.abrupt("return");case 3:d()(n,(function(e){if(e instanceof HTMLCanvasElement){var t=e.width,n=e.height,a=Object(u.c)(t,n),r=document.createElement("canvas");r.width=t,r.height=n;var s=r.getContext("2d");if(s){s.drawImage(e,0,0,r.width,r.height);var i=r.toDataURL("image/png").split(",")[1];re(i),q(u.b.findIndex((function(e){return e.id===a.id}))),Pe(a),Ae(t),Be(n),r.remove()}}}),{maxWidth:4096,maxHeight:4096,canvas:!0});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(c.useEffect)((function(){if(n){var e=n.imageData;e&&re(e.split(",")[1]),D(n.params.prompt||""),E(n.params.negative_prompt||T()),U(4),V(n.id),ee(!0),H(n.params.denoising_strength||.75),oe(p.indexOf(n.model)>-1?n.model:"Epic Diffusion"),Oe(n.params.cfg_scale||7.5)}else He()}),[n]),Object(c.useEffect)((function(){ae||me(void 0)}),[ae]);var Xe=Me.scale(Ie),qe=Object(w.a)(A,Xe.width,Xe.height);return Object(O.jsxs)("form",{onSubmit:We,children:[Object(O.jsxs)("div",{className:"homepage-prompt",children:[Object(O.jsxs)("div",{className:"input-group",children:[Object(O.jsx)("input",{className:"form-control prompt",placeholder:"What would you like to create?",value:S,onChange:function(e){return D(e.target.value)}}),Object(O.jsxs)("div",{className:"input-group-append",children:[Object(O.jsxs)("select",{className:"form-control prompt-count",style:{borderTopLeftRadius:"0px"},value:we?1:A,onChange:function(e){return U(parseInt(e.target.value))},disabled:!!we,children:[Object(O.jsx)("option",{value:1,children:"1"}),Object(O.jsx)("option",{children:"2"}),Object(O.jsx)("option",{children:"3"}),Object(O.jsx)("option",{children:"4"}),Object(O.jsx)("option",{children:"5"}),Object(O.jsx)("option",{children:"6"}),Object(O.jsx)("option",{children:"7"}),Object(O.jsx)("option",{children:"8"}),Object(O.jsx)("option",{children:"9"}),Object(O.jsx)("option",{children:"10"})]}),Object(O.jsxs)("button",{type:"submit",className:"btn btn-secondary light-button",style:{marginLeft:"8px"},disabled:!S||a,children:[!a&&Object(O.jsx)("i",{className:"fas fa-paint-brush"}),a&&Object(O.jsx)("i",{className:"fas fa-spinner fa-spin"})]})]})]}),Object(O.jsx)(k.a,{imagesCost:qe}),Object(O.jsxs)("div",{style:{marginTop:"24px"},children:[Object(O.jsx)("a",{href:"javascript:void(0)",onClick:function(){return ee(!Q)},style:{color:"white",textDecoration:"underline"},children:"Advanced"}),"\xa0",Q?Object(O.jsx)("i",{className:"fas fa-chevron-up"}):Object(O.jsx)("i",{className:"fas fa-chevron-down"})]}),Q&&Object(O.jsxs)("div",{className:"homepage-prompt-advanced",children:[ae&&Object(O.jsxs)("div",{className:"form-group",children:[Object(O.jsx)("label",{children:"Init Image"}),Object(O.jsx)("img",{style:{display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"100%"},src:"data:image/png;base64,".concat(ae)})]}),!n&&!ae&&Object(O.jsx)(h.a,{aspectRatio:X,onChange:function(e){q(e),Pe(u.b[e])}}),Object(O.jsx)("div",{className:"form-group",children:Object(O.jsxs)("div",{style:{display:"block",maxWidth:ae?"350px":"180px",marginTop:"40px",marginRight:"auto",marginLeft:"auto"},children:[Object(O.jsxs)("label",{id:"loadimage-wrapper",className:"btn btn-primary ",style:{display:"inline"},children:[Object(O.jsx)("i",{className:"fas fa-upload"}),"\xa0",ae||n?"Replace":"Upload",Object(O.jsx)("input",{id:"loadimage",type:"file",style:{display:"none"},onChange:Ye})]}),ae&&Object(O.jsxs)("label",{className:"btn btn-secondary",onClick:function(){return re("")},style:{display:"inline"},children:[Object(O.jsx)("i",{className:"fas fa-trash"}),"\xa0 Remove"]})]})}),Object(O.jsxs)("div",{className:"form-group",children:[Object(O.jsx)("label",{htmlFor:"model",children:"Model"}),Object(O.jsx)("div",{children:Object(O.jsxs)("button",{type:"button",className:"btn btn-secondary light-button",onClick:function(){return he(!0)},children:[ce,"\xa0",Object(O.jsx)("i",{className:"fas fa-caret-down"})]})})]}),Object(O.jsxs)("div",{className:"form-group",children:[Object(O.jsx)("label",{htmlFor:"negativePrompt",children:"Negative Prompt"}),Object(O.jsx)(I,{history:C.b.getItems(),value:P,onChange:E}),Object(O.jsx)("span",{className:"helptext",children:'Try descriptive words like "blurry" or "distorted"'})]}),!we&&Object(O.jsxs)("div",{className:"form-group",children:[Object(O.jsxs)("label",{htmlFor:"count",children:["Count: ",A]}),Object(O.jsx)("input",{type:"range",className:"form-control-range",id:"count",min:"1",max:"10",value:A,onChange:function(e){return U(parseInt(e.target.value))}}),Object(O.jsx)("span",{className:"helptext",children:"This is how many images you want to generate"})]}),Object(O.jsxs)("div",{className:"form-group",children:[Object(O.jsxs)("label",{htmlFor:"size",children:["Size: ",Xe.width," x ",Xe.height]}),Object(O.jsx)("input",{type:"range",className:"form-control-range",id:"size",min:"1",max:"2",step:"0.1",value:Ie,onChange:function(e){return Ne(parseFloat(e.target.value))}}),Object(O.jsx)("span",{className:"helptext",children:"This allows you to adjust the size of your images. Larger images cost more credits."})]}),(J||ae)&&Object(O.jsxs)("div",{className:"form-group",children:[Object(O.jsxs)("label",{htmlFor:"variationStrength",children:["Variation Strength:\xa0",(100*B).toFixed(0),"%"]}),Object(O.jsx)("input",{type:"range",className:"form-control-range",id:"variationStrength",min:"0.05",max:"0.95",step:"0.05",value:B,onChange:function(e){return H(parseFloat(e.target.value))}}),Object(O.jsx)("span",{className:"helptext",children:"This is how much variation you want to see from the parent image"})]}),ae&&Object(O.jsxs)("div",{className:"form-group",children:[Object(O.jsx)("label",{htmlFor:"controlNetType",children:"Control Net Type"}),Object(O.jsxs)("select",{className:"form-control",id:"controlNetType",value:be,onChange:function(e){return me(e.target.value)},children:[Object(O.jsx)("option",{value:"",children:"None"}),b.map((function(e){return Object(O.jsx)("option",{value:e,children:e},"type-".concat(e))}))]}),Object(O.jsxs)("span",{className:"helptext",children:["Controlnet is an advanced way of controlling the output of image generation. You can read more about it"," ",Object(O.jsx)("a",{target:"_blank",href:"https://bootcamp.uxdesign.cc/controlnet-and-stable-diffusion-a-game-changer-for-ai-image-generation-83555cb942fc",children:"here."})]})]}),Object(O.jsxs)("div",{className:"form-group",children:[Object(O.jsxs)("label",{children:["CFG Scale: ",ve.toFixed(1)]}),Object(O.jsx)("input",{type:"range",className:"form-control-range",min:"1",max:"20",step:"0.5",value:ve,onChange:function(e){return Oe(parseFloat(e.target.value))}}),Object(O.jsx)("span",{className:"helptext",children:"Adjust the CFG scale to control how much the image looks like the prompt."})]}),Object(O.jsx)(x,{seed:we,setSeed:ke}),Object(O.jsx)("div",{className:"form-group",style:{minHeight:"20px"},children:Object(O.jsxs)("div",{className:"float-right",children:[n&&Object(O.jsxs)("button",{type:"button",className:"btn btn-secondary light-button",onClick:function(){He(),m()},children:[Object(O.jsx)("i",{className:"fas fa-times"}),"\xa0CANCEL"]}),Object(O.jsxs)("button",{type:"submit",className:"btn btn-primary",style:{marginLeft:"8px"},disabled:!S||a,children:[!a&&Object(O.jsx)("i",{className:"fas fa-paint-brush"}),a&&Object(O.jsx)("i",{className:"fas fa-spinner fa-spin"}),"\xa0PAINT"]}),ae&&Object(O.jsxs)("button",{type:"button",className:"btn btn-secondary light-button",onClick:function(){if(ae){P&&C.b.addItem(P);var e=N();e.params.prompt=S||"",e.params.negative_prompt=P||"",e.count=1,e.parent=J||void 0,e.params.denoising_strength=B,e.status=o.b.Completed,e.params.width=Re,e.params.height=ze,e.params.cfg_scale=ve,e.nsfw=!0,e.model=ce,ae&&(e.encoded_image=ae),He(),g(e)}else console.error("Cannot edit without existing image")},style:{marginLeft:"8px"},disabled:!S||a,children:[Object(O.jsx)("i",{className:"fas fa-edit"}),"\xa0EDIT"]})]})})]})]}),de&&Object(O.jsx)(y.a,{api:t,onCancel:function(){return he(!1)},onSelectModel:function(e){oe(e),he(!1)},initialSelectedModel:ce,inpainting:!1})]})}},64:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(0),r=function(e){var t=e.progress;return Object(a.jsx)("div",{className:"progress",style:{height:"20px",marginTop:"16px"},children:Object(a.jsxs)("div",{className:"progress-bar",role:"progressbar",style:{width:"".concat(100*t,"%")},"aria-valuenow":100*t,"aria-valuemin":0,"aria-valuemax":100,children:[Math.round(100*t),"%"]})})}},74:function(e,t,n){"use strict";function a(e){return new Promise((function(t){return window.setTimeout(t,e)}))}n.d(t,"a",(function(){return a}))},77:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));function a(e,t,n){return Math.max(e*Math.floor(t*n/262144),1)}},78:function(e,t,n){"use strict";var a=n(4),r=n(1),s=n(26),i=n(389),c=n(387),o=n(194),u=n(93),l=n(13),d=n.n(l),h=n(390),f=n(0),p=function(e){var t=e.models,n=e.onSelectModel,s=e.selectedModel,i=Object(r.useState)(window.innerWidth<576?.3*window.innerHeight:.7*window.innerHeight),c=Object(a.a)(i,2),o=c[0],u=c[1];return Object(r.useEffect)((function(){var e=function(){var e=.7*window.innerHeight;window.innerWidth<576&&(e=.3*window.innerHeight),u(e)};return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}),[]),Object(f.jsx)(h.a,{style:{maxHeight:"".concat(o,"px"),overflowY:"auto",border:"1px solid #808080",marginBottom:"8px"},children:t.map((function(e){return Object(f.jsx)(h.a.Item,{active:s===e.name,onClick:function(){return n(e)},style:{cursor:"pointer"},children:e.name},e.name)}))})},b=n(16),m=n(17),g=new(function(){function e(){Object(b.a)(this,e),this.storage=void 0,this.storage=window.localStorage}return Object(m.a)(e,[{key:"setItem",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3600,a={value:t,expiry:Date.now()+1e3*n};this.storage.setItem(e,JSON.stringify(a))}},{key:"getItem",value:function(e){try{var t=this.storage.getItem(e);if(!t)return null;var n=JSON.parse(t);return Date.now()>n.expiry?(this.storage.removeItem(e),null):n.value}catch(a){return console.error(a),null}}},{key:"removeItem",value:function(e){this.storage.removeItem(e)}},{key:"clear",value:function(){this.storage.clear()}}]),e}());var j=n(50);d.a.create(),t.a=function(e){var t=e.api,n=e.initialSelectedModel,l=e.onSelectModel,d=e.onCancel,h=e.inpainting,b=function(e,t){var n=Object(r.useState)((function(){var n=g.getItem(e);return null!==n?n:t})),s=Object(a.a)(n,2),i=s[0],c=s[1];return Object(r.useEffect)((function(){g.setItem(e,i)}),[e,i]),[i,c]}("models",[]),m=Object(a.a)(b,2),v=m[0],O=m[1],x=Object(r.useState)(null),y=Object(a.a)(x,2),w=y[0],k=y[1],C=Object(r.useState)(""),S=Object(a.a)(C,2),I=S[0],N=S[1],T=v.filter((function(e){return e.inpainting===h&&e.name.toLowerCase().includes(I.toLowerCase())}));return Object(r.useEffect)((function(){var e=function(e,t){j.a.addItem(e.name);var n=j.a.getItems(),a={};n.forEach((function(e,t){a[e]=t}));var r=t.sort((function(e,t){var n=a[e.name],r=a[t.name];return void 0===n&&void 0===r?0:void 0===n?1:void 0===r?-1:n-r}));O(r)};if(v&&0!==v.length){var a=v.find((function(e){return e.name===n}))||v[0];k(a),e(a,v)}else t.getModels().then((function(t){console.log(t);var a=t.data[n]||Object.values(t.data)[0];console.log("Selected model:",a),k(a),e(a,Object.values(t.data))}))}),[t,v]),Object(r.useEffect)((function(){n&&j.a.addItem(n)}),[n]),Object(f.jsx)(f.Fragment,{children:Object(f.jsxs)(s.a,{show:!0,onHide:d,size:"xl",children:[Object(f.jsx)(s.a.Header,{closeButton:!0,children:Object(f.jsx)(s.a.Title,{children:"Select Model"})}),Object(f.jsxs)(s.a.Body,{children:[Object(f.jsx)(i.a.Control,{type:"text",placeholder:"Search",value:I,onChange:function(e){N(e.target.value)}}),Object(f.jsxs)(c.a,{className:"mt-3",children:[Object(f.jsx)(o.a,{sm:4,children:Object(f.jsx)(p,{models:T,onSelectModel:function(e){k(e)},selectedModel:(null===w||void 0===w?void 0:w.name)||""})}),Object(f.jsx)(o.a,{sm:8,children:w&&Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("h5",{children:w.name}),Object(f.jsx)("p",{children:w.description}),w.showcases&&w.showcases.length>0&&Object(f.jsx)("img",{src:w.showcases[0],alt:"Showcase",style:{width:"70%"}})]})})]})]}),Object(f.jsxs)(s.a.Footer,{children:[Object(f.jsx)(u.a,{variant:"secondary",onClick:d,children:"Cancel"}),Object(f.jsx)(u.a,{variant:"primary",onClick:function(){console.log("Selected model:",w),w&&l(w.name)},disabled:!w,children:"Select"})]})]})})}},81:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return o}));var a=n(4),r=n(1),s=n(0),i=function(e){var t=e.message,n=e.timestamp,i=e.alertType,c=Object(r.useState)(!!t),o=Object(a.a)(c,2),u=o[0],l=o[1];return Object(r.useEffect)((function(){if(l(!!t),t){var e=setTimeout((function(){l(!1)}),1e4);return function(){clearTimeout(e)}}}),[t,n]),u?Object(s.jsxs)("div",{className:"alert alert-".concat(i," ").concat(u?"show":"hide"),children:[Object(s.jsx)("button",{type:"button",className:"close",onClick:function(){return l(!1)},children:"\xd7"}),t]}):null},c=function(e){var t=e.message,n=e.timestamp;return Object(s.jsx)(i,{message:t||"",timestamp:n,alertType:"danger"})},o=function(e){var t=e.message,n=e.timestamp;return Object(s.jsx)(i,{message:t||"",timestamp:n,alertType:"success"})}},84:function(e,t,n){"use strict";n.d(t,"c",(function(){return g})),n.d(t,"b",(function(){return j})),n.d(t,"a",(function(){return v}));var a=n(4),r=n(27),s=n(16),i=n(17),c=n(60),o=n(29),u=n(31),l=n(32),d=n(1),h=n(38),f=n(115),p=n(210),b=n(0),m=function(e){var t=e.color,n=e.onColorSelected,r=Object(d.useState)(!1),s=Object(a.a)(r,2),i=s[0],c=s[1],o=Object(d.useState)(t),u=Object(a.a)(o,2),l=u[0],h=u[1];return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("button",{className:"color-picker",onClick:function(){c(!i),i&&n(l)},children:Object(b.jsx)("i",{className:"fas fa-plus"})}),i?Object(b.jsxs)("div",{style:{position:"absolute",zIndex:2},children:[Object(b.jsx)("div",{style:{position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"},onClick:function(){c(!1),i&&n(l)}}),Object(b.jsx)(p.a,{color:l,onChange:function(e){return h(e.hex)},onChangeComplete:function(e){return h(e.hex)}})]}):null]})},g=["#FFFFFF","#5A2C02","#386EB6","#6B31A1","#CB2C26","#000000","#888888","#50B050","#FBDB37","#E88D2D"],j=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e,a){var r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:g[0],c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"pencil";return Object(s.a)(this,n),(r=t.call(this,e,c)).layer=a,r.brushColor=i,r.brushSize=10,r.panning=!1,r.isDrawing=!1,r.lastX=0,r.lastY=0,r.colorPicking=!1,r.lastPickedColor="#000000",r._dirty=!1,r.dirtyListener=void 0,r.colorPickedListener=void 0,r}return Object(i.a)(n,[{key:"dirty",get:function(){return this._dirty},set:function(e){this._dirty=e,this.dirtyListener&&this.dirtyListener(e)}},{key:"sync",value:function(){this.colorPicking?this.renderer.setCursor({x:this.lastX,y:this.lastY,radius:this.renderer.getWidth()/20,color:this.lastPickedColor,type:"colorpicker"}):this.renderer.setCursor({x:this.lastX,y:this.lastY,radius:this.brushSize/2,color:this.brushColor,type:"circle-fill"})}},{key:"updateArgs",value:function(e){Object(c.a)(Object(o.a)(n.prototype),"updateArgs",this).call(this,e),this.brushSize=e.brushSize||10,this.brushColor=e.brushColor||g[0],this.sync()}},{key:"onMouseDown",value:function(e){if(!this.colorPicking){if(0===e.button){var t=this.zoomHelper.translateMouseToCanvasCoordinates(e.nativeEvent.offsetX,e.nativeEvent.offsetY),n=t.x,a=t.y;this.renderer.drawPoint(n,a,this.brushSize,this.brushColor,this.layer),this.isDrawing=!0,this.lastX=n,this.lastY=a,this.dirty=!0}else 1===e.button&&(this.panning=!0);this.sync()}}},{key:"onMouseMove",value:function(e){var t=this.zoomHelper.translateMouseToCanvasCoordinates(e.nativeEvent.offsetX,e.nativeEvent.offsetY),n=t.x,a=t.y;this.colorPicking?this.lastPickedColor=this.renderer.getPixel(n,a):this.panning?this.zoomHelper.onPan(e):this.isDrawing&&(this.renderer.drawLine(this.lastX,this.lastY,n,a,this.brushSize,this.brushColor,this.layer),this.dirty=!0),this.lastX=n,this.lastY=a,this.sync()}},{key:"onMouseUp",value:function(e){0===e.button?(this.isDrawing=!1,this.colorPicking&&(this.colorPicking=!1,this.brushColor=this.lastPickedColor,this.colorPickedListener&&this.colorPickedListener(this.lastPickedColor))):1===e.button&&(this.panning=!1),this.sync()}},{key:"onWheel",value:function(e){this.zoomHelper.onWheel(e),this.sync()}},{key:"cancel",value:function(){this.renderer.setEditImage(null),this.dirty=!1}},{key:"confirm",value:function(){this.renderer.commitSelection();var e=this.renderer.getEncodedImage(null);e&&this.saveListener&&this.saveListener(e),this.dirty=!1}},{key:"onSaveImage",value:function(e){this.saveListener=e}},{key:"onDirty",value:function(e){this.dirtyListener=e}},{key:"destroy",value:function(){return this.dirty&&this.renderer.commitSelection(),!0}},{key:"beginColorpicker",value:function(){this.colorPicking=!0,this.sync()}},{key:"onColorPicked",value:function(e){this.colorPickedListener=e}}]),n}(h.a);var v=function(e){e.renderer;var t=e.tool,n=e.colors,s=Object(d.useState)(10),i=Object(a.a)(s,2),c=i[0],o=i[1],u=Object(d.useState)(n[0]),l=Object(a.a)(u,2),h=l[0],p=l[1],g=Object(d.useState)(n),j=Object(a.a)(g,2),v=j[0],O=j[1],x=Object(d.useState)(!1),y=Object(a.a)(x,2),w=y[0],k=y[1];t.onDirty(k),Object(d.useEffect)((function(){t.updateArgs({brushSize:c,brushColor:h,palette:v})}),[c,h,v]);var C=function(e){p(e),O(function(e,t){return-1===e.indexOf(t)&&(e=[t].concat(Object(r.a)(e))),e.length>30&&(e=e.slice(0,30)),e}(v,e))};return t.onColorPicked(C),Object(b.jsxs)("div",{style:{marginTop:"16px"},children:[Object(b.jsxs)("div",{className:"form-group",children:[Object(b.jsxs)("label",{style:{width:"100%"},children:["Brush size",Object(b.jsxs)("small",{className:"form-text text-muted",style:{float:"right"},children:[c,"px"]})]}),Object(b.jsx)("input",{type:"range",className:"form-control-range",min:"1",max:"100",value:c,onChange:function(e){return o(parseInt(e.target.value))}})]}),Object(b.jsxs)("div",{style:{display:"flex",flexDirection:"row",flexWrap:"wrap"},children:[v.map((function(e,t){return Object(b.jsx)(f.a,{selectedColor:h,color:e,onClick:function(e){return p(e)}},t)})),Object(b.jsx)("button",{className:"color-picker",onClick:function(){return t.beginColorpicker()},children:Object(b.jsx)("i",{className:"fas fa-eye-dropper"})}),Object(b.jsx)(m,{color:h,onColorSelected:function(e){return C(e)}})]}),Object(b.jsxs)("div",{className:"form-group",style:{marginTop:"16px",visibility:w?"visible":"hidden"},children:[Object(b.jsx)("button",{className:"btn btn-secondary",onClick:function(){return t.cancel()},children:"Revert"}),Object(b.jsx)("button",{className:"btn btn-primary",onClick:function(){return t.confirm()},style:{marginLeft:"8px"},children:"Save"})]})]})}},91:function(e,t,n){"use strict";n.d(t,"b",(function(){return g})),n.d(t,"a",(function(){return j}));var a=n(4),r=n(3),s=n(16),i=n(17),c=n(60),o=n(29),u=n(31),l=n(32),d=n(1),h=n(38),f=n(110),p=n(92),b=n(20),m=n(0),g=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var a;return Object(s.a)(this,n),(a=t.call(this,e,"select")).selectionOverlay=void 0,a.selectionOverlayPreview=void 0,a.outpaint=void 0,a.panning=!1,a}return Object(i.a)(n,[{key:"updateArgs",value:function(e){e=Object(r.a)(Object(r.a)({},this.getArgs()),e),Object(c.a)(Object(o.a)(n.prototype),"updateArgs",this).call(this,e),this.selectionOverlay=e.selectionOverlay||{x:0,y:0,width:512,height:512},this.outpaint=e.outpaint,this.outpaint||(this.selectionOverlay=this.clamp(this.selectionOverlay)),this.sync()}},{key:"clamp",value:function(e){var t=this.renderer.getWidth(),n=this.renderer.getHeight(),a=e.x,r=e.y,s=e.width,i=e.height;return a=Math.max(0,Math.min(a,t-this.selectionOverlay.width)),r=Math.max(0,Math.min(r,n-e.height)),{x:a=Math.min(a,t-e.width),y:r=Math.min(r,n-e.height),width:s=Math.min(s,t),height:i=Math.min(i,n)}}},{key:"sync",value:function(){this.renderer.setSelectionOverlay(this.selectionOverlay),this.renderer.setSelectionOverlayPreview(this.selectionOverlayPreview)}},{key:"onMouseDown",value:function(e){"touch"==e.type?this.onMouseMove(e):0===e.button?(this.selectionOverlay=this.selectionOverlayPreview,this.selectionOverlayPreview=void 0,this.sync(),this.updateArgs({selectionOverlay:this.selectionOverlay})):1===e.button&&(this.panning=!0)}},{key:"onMouseMove",value:function(e){this.renderer.getWidth(),this.renderer.getHeight();if(this.panning)this.zoomHelper.onPan(e);else{var t=this.zoomHelper.translateMouseToCanvasCoordinates(e.nativeEvent.offsetX,e.nativeEvent.offsetY),n=t.x,a=t.y;n=16*Math.round(n/16),a=16*Math.round(a/16),n-=256,a-=256,this.selectionOverlayPreview={x:n,y:a,width:this.selectionOverlay.width,height:this.selectionOverlay.height},this.outpaint||(this.selectionOverlayPreview=this.clamp(this.selectionOverlayPreview)),this.sync()}}},{key:"onMouseUp",value:function(e){0===e.button&&"touch"==e.type&&(this.selectionOverlay=this.selectionOverlayPreview,this.selectionOverlayPreview=void 0,this.sync(),this.updateArgs({selectionOverlay:this.selectionOverlay})),this.panning=!1}},{key:"onMouseLeave",value:function(e){this.selectionOverlayPreview=void 0,this.panning=!1,this.sync()}},{key:"onWheel",value:function(e){this.zoomHelper.onWheel(e)}},{key:"destroy",value:function(){return this.renderer.setSelectionOverlayPreview(void 0),!0}}]),n}(h.a),j=function(e){var t=e.renderer,n=e.tool,r=e.lockAspectRatio,s=e.outpaint,i=Object(p.a)(t.getWidth(),t.getHeight()),c=Object(d.useState)(b.a),o=Object(a.a)(c,2),u=o[0],l=o[1],h=Object(d.useState)(1),g=Object(a.a)(h,2),j=g[0],v=g[1];function O(e,a){var r=n.getArgs(),i=b.b[e];if(r.selectionOverlay){var c=r.selectionOverlay.width-i.width*a,o=r.selectionOverlay.height-i.height*a;r.selectionOverlay.width=Math.round(i.width*a),r.selectionOverlay.height=Math.round(i.height*a),r.selectionOverlay.x+=c/2,r.selectionOverlay.y+=o/2,s||(r.selectionOverlay.x=Math.round(Math.max(0,Math.min(r.selectionOverlay.x,t.getWidth()-r.selectionOverlay.width))),r.selectionOverlay.y=Math.round(Math.max(0,Math.min(r.selectionOverlay.y,t.getHeight()-r.selectionOverlay.height))))}n.updateArgs({selectionOverlay:r.selectionOverlay})}return Object(d.useEffect)((function(){if(0===Object(p.a)(t.getWidth(),t.getHeight())&&r){var e=Object(b.c)(t.getWidth(),t.getHeight());l(e.id),n.updateArgs({selectionOverlay:{x:0,y:0,width:e.width,height:e.height},outpaint:s})}else{var a=n.getArgs();if(a.selectionOverlay){var i=Object(b.c)(a.selectionOverlay.width,a.selectionOverlay.height);l(i.id),v(a.selectionOverlay.width/i.width),n.updateArgs(a)}else a.selectionOverlay={x:0,y:0,width:b.b[u].width,height:b.b[u].height},a.outpaint=s,n.updateArgs(a)}}),[n]),Object(m.jsxs)(m.Fragment,{children:[i>0&&Object(m.jsx)(f.a,{aspectRatio:u,onChange:function(e){O(e,j),l(e)}}),Object(m.jsxs)("div",{className:"form-group",children:[Object(m.jsxs)("label",{htmlFor:"size",style:{width:"100%"},children:["Size",Object(m.jsxs)("small",{className:"form-text text-muted",style:{float:"right"},children:[Math.round(100*j),"%"]})]}),Object(m.jsx)("input",{type:"range",className:"form-control-range",id:"size",min:"1",max:"2",step:"0.1",value:j,onChange:function(e){O(u,parseFloat(e.target.value)),v(parseFloat(e.target.value))}})]})]})}},92:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(20);function r(e,t){for(var n=0;n<a.b.length;n++){var r=a.b[n];if(e*t<=r.width*r.height)return 0}e/=2,t/=2;for(var s=0;s<a.b.length;s++){var i=a.b[s];if(e*t<=i.width*i.height)return 1}return 2}},95:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return U}));var a=n(71),r=n(3),s=n(2),i=n.n(s),c=n(27),o=n(39),u=n(5),l=n(4),d=n(1),h=n(212),f=n(13),p=n.n(f),b=n(107),m=n.n(b),g=n(43),j=n(19),v=n(14),O=n.n(v),x=n(117),y=n.n(x),w=n(15),k=n(57),C=n(59),S=n(21),I=n(118),N=n(121),T=n(33),D=n(119),L=n(120),M=n(81),P=n(64),E=n(207),_=n(208),R=n(0),A=p.a.create();delete A.defaults.headers.common.Authorization;var U=function(t){var n=t.api,s=(t.apiSocket,t.assetsUrl),f=t.localImages,p=t.paymentStatus,b=Object(d.useState)(!1),v=Object(l.a)(b,2),x=v[0],U=v[1],F=Object(d.useState)(null),z=Object(l.a)(F,2),B=z[0],H=z[1],W=Object(d.useState)(null),Y=Object(l.a)(W,2),X=Y[0],q=Y[1],G=Object(d.useState)(!1),Z=Object(l.a)(G,2),J=Z[0],V=Z[1],K=Object(d.useState)(!1),$=Object(l.a)(K,2),Q=$[0],ee=$[1],te=Object(d.useState)(0),ne=Object(l.a)(te,2),ae=ne[0],re=ne[1],se=Object(d.useState)(!1),ie=Object(l.a)(se,2),ce=ie[0],oe=ie[1],ue=Object(d.useState)([]),le=Object(l.a)(ue,2),de=le[0],he=le[1],fe=Object(d.useState)(null),pe=Object(l.a)(fe,2),be=pe[0],me=pe[1],ge=Object(d.useState)(0),je=Object(l.a)(ge,2),ve=je[0],Oe=je[1],xe=Object(d.useState)(null),ye=Object(l.a)(xe,2),we=ye[0],ke=ye[1],Ce=Object(d.useState)(0),Se=Object(l.a)(Ce,2),Ie=Se[0],Ne=Se[1],Te=Object(d.useState)(!0),De=Object(l.a)(Te,2),Le=De[0],Me=De[1],Pe=Object(d.useState)(""),Ee=Object(l.a)(Pe,2),_e=Ee[0],Re=Ee[1],Ae=Object(d.useState)(""),Ue=Object(l.a)(Ae,2),Fe=Ue[0],ze=Ue[1],Be=Object(d.useState)(!1),He=Object(l.a)(Be,2),We=He[0],Ye=He[1],Xe=Object(d.useState)(!1),qe=Object(l.a)(Xe,2),Ge=qe[0],Ze=qe[1],Je=Object(d.useState)({}),Ve=Object(l.a)(Je,2),Ke=Ve[0],$e=Ve[1],Qe=Object(d.useState)(!0),et=Object(l.a)(Qe,2),tt=et[0],nt=et[1],at=Object(d.useState)(!1),rt=Object(l.a)(at,2),st=rt[0],it=rt[1],ct=Object(j.i)().id,ot=Object(j.g)(),ut=Object(j.h)(),lt=function(e){me(e),Oe(O()().valueOf())};Object(d.useEffect)((function(){var e=setTimeout((function(){Re(Fe)}),500);return function(){clearTimeout(e)}}),[Fe]),Object(d.useEffect)((function(){if(ct){var e=de.find((function(e){return e.id===ct}));e&&H(e),f.getImage(ct).then((function(e){H(e),e||ot.replace("/")}))}else H(null)}),[ct]);var dt=function(){var t=Object(u.a)(i.a.mark((function t(a){var r,s,u,l,d,h,p,b,m,g;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(U(!0),q(null),me(null),window.scrollTo(0,0),re(0),t.prev=5,!a.encoded_image){t.next=18;break}return t.next=9,Object(S.c)(a.encoded_image);case 9:return r=t.sent,t.next=12,n.createTemporaryImage("jpg");case 12:return s=t.sent,u=e.from(r,"base64"),t.next=16,A.put(s.data.upload_url,u,{headers:{"Content-Type":"image/jpeg"},onUploadProgress:function(e){var t=e.loaded/e.total;re(t)}});case 16:a.encoded_image=void 0,a.tmp_jpg_id=s.data.id;case 18:return t.next=20,n.createImage(a);case 20:if((l=t.sent).data.images){d=Object(o.a)(l.data.images||[]);try{for(d.s();!(h=d.n()).done;)p=h.value,f.saveImage(p)}catch(be){d.e(be)}finally{d.f()}he((function(e){return[].concat(Object(c.a)(l.data.images),Object(c.a)(e)).sort(mt)}))}else lt("Could not create images");t.next=31;break;case 24:if(t.prev=24,t.t0=t.catch(5),console.error(t.t0),!(null===(b=t.t0.response)||void 0===b||null===(m=b.data)||void 0===m||null===(g=m.message)||void 0===g?void 0:g.includes("credits"))){t.next=30;break}return it(!0),t.abrupt("return");case 30:lt("Error creating images");case 31:return t.prev=31,U(!1),t.finish(31);case 34:case"end":return t.stop()}}),t,null,[[5,24,31,34]])})));return function(e){return t.apply(this,arguments)}}(),ht=function(){var e=Object(u.a)(i.a.mark((function e(t){var n,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return U(!0),q(null),me(null),window.scrollTo(0,0),e.prev=4,n=t.encoded_image,a={created_at:O()().valueOf(),updated_at:O()().valueOf(),created_by:"",params:{steps:20,width:t.params.width,height:t.params.height,prompt:t.params.prompt,negative_prompt:t.params.negative_prompt,denoising_strength:t.params.denoising_strength},label:"",id:h.a(),model:t.model,negative_score:0,nsfw:!!t.nsfw,parent:t.parent,score:0,status:w.c.Completed,temporary:!1,imageData:"data:image/png;base64,".concat(n)},e.next=9,f.saveImage(a);case 9:ot.push("/image-editor/".concat(a.id)),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(4),console.error(e.t0),lt("Error creating image");case 16:return e.prev=16,U(!1),e.finish(16);case 19:case"end":return e.stop()}}),e,null,[[4,12,16,19]])})));return function(t){return e.apply(this,arguments)}}(),ft=function(){var e=Object(u.a)(i.a.mark((function e(t,n){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Object(r.a)(Object(r.a)({},t),{},{nsfw:n}),e.next=3,f.saveImage(t);case 3:he((function(e){return e.map((function(e){return t.id===e.id?Object(r.a)(Object(r.a)({},e),{},{nsfw:n}):e}))})),H(t);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),pt=function(){var e=Object(u.a)(i.a.mark((function e(t){var n,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Initial load images"),me(null),Me(!0),e.prev=3,n=O()().add(1,"minutes").valueOf(),e.next=7,f.listImages(n,"prev",100,t);case 7:return a=e.sent,he(a.sort(mt)),e.abrupt("return");case 12:e.prev=12,e.t0=e.catch(3),lt("Could not load images"),console.error(e.t0);case 16:case"end":return e.stop()}}),e,null,[[3,12]])})));return function(t){return e.apply(this,arguments)}}();Object(d.useEffect)((function(){pt(_e)}),[_e]),Object(d.useEffect)((function(){if(n){var t=!1,a=function(){var a=Object(u.a)(i.a.mark((function a(s){var o,u,l,d,h,p,b,m,g,j,v,O;return i.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!t){a.next=2;break}return a.abrupt("return");case 2:if(t=!0,0!==(o=s.filter((function(e){return"pending"===e.status||"processing"===e.status}))).length){a.next=6;break}return a.abrupt("return");case 6:return u=o.reduce((function(e,t){return e[t.id]=t,e}),{}),a.prev=7,a.next=10,n.batchGetImages("id,status,nsfw,error",{ids:o.map((function(e){return e.id}))});case 10:if(!(l=a.sent).data.images){a.next=44;break}d=l.data.images||[],h=!1,p=0;case 15:if(!(p<d.length)){a.next=43;break}if(b=d[p],u[b.id].status!==b.status&&(h=!0),b=Object(r.a)(Object(r.a)({},u[b.id]),b),d[p]=b,b.status!=w.c.Error){a.next=27;break}return lt(b.error||"Some images failed to generate, please make sure your prompt doesn't violate our terms of service"),a.next=24,n.deleteImage(b.id);case 24:return a.next=26,f.deleteImage(b.id);case 26:return a.abrupt("continue",40);case 27:if(b.status!==w.c.Completed){a.next=38;break}return a.next=30,n.getImageDownloadUrls(b.id);case 30:return m=a.sent,a.next=33,A.get(m.data.image_url,{responseType:"arraybuffer"});case 33:g=a.sent,j=e.from(g.data,"binary"),v=j.toString("base64"),O="data:image/png;base64,".concat(v),b.imageData=O;case 38:return a.next=40,f.saveImage(b);case 40:p++,a.next=15;break;case 43:h&&he((function(e){return Object(c.a)(e.map((function(e){var t=d.find((function(t){return t.id===e.id}));return t||e}))).sort(mt)}));case 44:a.next=50;break;case 46:a.prev=46,a.t0=a.catch(7),lt("Could not load images"),console.error(a.t0);case 50:return a.prev=50,t=!1,a.finish(50);case 53:case"end":return a.stop()}}),a,null,[[7,46,50,53]])})));return function(e){return a.apply(this,arguments)}}(),s=setInterval((function(){a(de)}),2e3);return function(){clearInterval(s)}}}),[n,de,_e]),Object(d.useEffect)((function(){(function(){var t=Object(u.a)(i.a.mark((function t(){var a,s,c,o,u,l,d;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(a=m.a.parse(ut.search,{ignoreQueryPrefix:!0})).parent){t.next=22;break}return V(!0),t.prev=3,t.next=6,n.getImage(a.parent);case 6:if(!(s=t.sent).data){t.next=19;break}return t.next=10,n.getImageDownloadUrls(s.data.id);case 10:return c=t.sent,t.next=13,A.get(c.data.image_url,{responseType:"arraybuffer"});case 13:o=t.sent,u=e.from(o.data,"binary"),l=u.toString("base64"),d="data:image/png;base64,".concat(l),q(Object(r.a)(Object(r.a)({},s.data),{},{imageData:d})),ot.push("/");case 19:return t.prev=19,V(!1),t.finish(19);case 22:case"end":return t.stop()}}),t,null,[[3,,19,22]])})));return function(){return t.apply(this,arguments)}})()()}),[ut.search]);var bt=function(e){return e.status===w.c.Pending||e.status===w.c.Processing},mt=function(e,t){if(bt(e)&&!bt(t))return-1;if(!bt(e)&&bt(t))return 1;if(e.parent===t.parent&&e.params.prompt==t.params.prompt&&e.status!==w.c.Pending&&t.status!==w.c.Pending){var n=e.score,a=t.score;return""!==e.params.prompt.trim()&&(n-=e.negative_score),""!==t.params.prompt.trim()&&(a-=t.negative_score),n==a?t.updated_at-e.updated_at:a-n}return t.updated_at-e.updated_at},gt=function(){var e=Object(u.a)(i.a.mark((function e(){var t,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=O()().valueOf(),de.forEach((function(e){t=Math.min(t,e.updated_at)})),e.next=4,f.listImages(t-1,"prev",100,_e);case 4:(n=e.sent).length>0?he((function(e){var t=e.reduce((function(e,t){return e[t.id]=t,e}),{});return n=n.filter((function(e){return!t[e.id]})),[].concat(Object(c.a)(e),Object(c.a)(n)).filter((function(e){return!e.deleted_at})).sort(mt)})):Me(!1);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),jt=function(){var e=Object(u.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f.deleteImage(t.id);case 3:he((function(e){return e.filter((function(e){return e.id!==t.id}))})),ot.push("/"),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0),lt("Error deleting image");case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),vt=function(){var e=Object(u.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:q(t),ot.push("/"),window.scrollTo(0,0);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ot=function(){var t=Object(u.a)(i.a.mark((function t(a){var r,s,c,o,u,l,d,h;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return ee(!0),t.prev=1,ot.push("/"),r={count:1,params:a.params,status:w.c.Saved,temporary:!1,label:"",model:a.model},s=a.imageData.split(",")[1],c=e.from(s,"base64"),t.next=8,Object(S.d)(s);case 8:return o=t.sent,u=e.from(o,"base64"),t.next=12,n.createImage(r);case 12:return l=t.sent,d=l.data.images[0].id,t.next=16,n.getImageUploadUrls(d);case 16:return h=t.sent,t.next=19,A.put(h.data.thumbnail_url,u,{headers:{"Content-Type":"image/png"},onUploadProgress:function(e){var t=e.loaded/e.total;re(t/2)}});case 19:return t.next=21,A.put(h.data.image_url,c,{headers:{"Content-Type":"image/png"},onUploadProgress:function(e){var t=e.loaded/e.total;re(t/2+.5)}});case 21:return t.next=23,f.hardDeleteImage(a.id);case 23:he((function(e){return e.filter((function(e){return e.id!==a.id}))})),ke("Image saved"),Ne(O()().valueOf()),t.next=32;break;case 28:t.prev=28,t.t0=t.catch(1),console.error(t.t0),lt("Error saving image");case 32:return t.prev=32,ee(!1),t.finish(32);case 35:case"end":return t.stop()}}),t,null,[[1,28,32,35]])})));return function(e){return t.apply(this,arguments)}}(),xt=function(){var e=Object(u.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:ot.push("/image-editor/".concat(t.id));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),yt=function(e){We?$e(Object(r.a)(Object(r.a)({},Ke),{},Object(a.a)({},e.id,!Ke[e.id]))):ot.push("/images/".concat(e.id))},wt=function(){var e=Object(u.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,Ze(!0),t=Object.keys(Ke).map((function(e){return f.deleteImage(e)})),e.next=5,Promise.all(t);case 5:he((function(e){return e.filter((function(e){return!Ke[e.id]}))})),$e({}),Ye(!1),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),console.error(e.t0),lt("Error deleting images");case 14:return e.prev=14,Ze(!1),e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[0,10,14,17]])})));return function(){return e.apply(this,arguments)}}(),kt=de.filter((function(e){return!e.deleted_at&&(e.status===w.c.Completed||e.status===w.c.Saved)})),Ct=de.filter((function(e){return!e.deleted_at&&(e.status===w.c.Pending||e.status===w.c.Processing)})),St=Ct.filter((function(e){return e.status===w.c.Pending})),It=Ct.filter((function(e){return e.status===w.c.Processing}));return Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)("h1",{style:{fontSize:"40px",textAlign:"left"},children:"Welcome to AiBrush - Home"}),Object(R.jsx)(M.a,{message:be,timestamp:ve}),Object(R.jsx)(M.b,{message:we,timestamp:Ie}),Object(R.jsx)(C.a,{api:n,assetsUrl:s,creating:x,onSubmit:dt,onEdit:ht,parent:X,onCancel:function(){return q(null),void window.scrollTo(0,0)}}),Object(R.jsx)("hr",{}),Object(R.jsxs)("div",{className:"homepage-images",style:{marginTop:"48px",paddingBottom:"48px"},children:[Object(R.jsx)("div",{style:{textAlign:"left"},children:Object(R.jsxs)("div",{className:"input-group",style:{marginBottom:"16px"},children:[Object(R.jsx)("input",{style:{},value:Fe,type:"search",className:"form-control image-search",placeholder:"Search...",onChange:function(e){return ze(e.target.value)}}),Object(R.jsxs)("div",{style:{float:"right"},children:[!We&&Object(R.jsxs)(R.Fragment,{children:[Object(R.jsxs)("button",{style:{display:"inline"},className:"btn btn-primary image-popup-button",onClick:function(){return nt(!tt)},children:[!tt&&Object(R.jsx)("i",{className:"fas fa-eye"}),tt&&Object(R.jsx)("i",{className:"fas fa-eye-slash"})]}),Object(R.jsxs)(g.a,{style:{display:"inline",marginLeft:"8px"},children:[Object(R.jsx)(g.a.Toggle,{variant:"danger",children:Object(R.jsx)("i",{className:"fas fa-trash"})}),Object(R.jsxs)(g.a.Menu,{children:[Object(R.jsx)(g.a.Item,{onClick:function(){return Ye(!0)},children:"Bulk Delete"}),Object(R.jsx)(g.a.Item,{onClick:function(){return ot.push("/local-deleted-images")},children:"View Deleted Images"})]})]})]}),We&&Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)("button",{className:"btn btn-primary image-popup-button",onClick:function(){Ye(!1),$e({})},children:"Cancel"}),Object(R.jsx)("button",{style:{marginLeft:"8px"},className:"btn image-popup-delete-button",onClick:function(){wt()},children:"Delete"})]})]})]})}),Object(R.jsxs)(I.a,{dataLength:de.length,next:gt,hasMore:Le,loader:Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)("hr",{}),Object(R.jsx)("h4",{children:"Loading..."})]}),children:[Ct.length>0&&Object(R.jsx)(D.a,{pendingCount:St.length,processingCount:It.length,onClick:function(){oe(!0)}}),kt.map((function(e){return Object(R.jsx)(k.a,{image:e,assetsUrl:s,onClick:yt,bulkDelete:We&&Ke[e.id],censorNSFW:tt},e.id)}))]})]}),B&&Object(R.jsx)(N.a,{assetsUrl:s,image:B,onClose:function(){return ot.push("/")},onDelete:function(e){jt(e),he(de.filter((function(t){return t.id!==e.id}))),ot.push("/")},onFork:function(e){vt(e),ot.push("/")},onEdit:function(e){xt(e)},onSave:function(e){Ot(e)},onNSFW:ft,censorNSFW:tt}),Object(R.jsx)(y.a,{}),Object(R.jsxs)(T.a,{show:x,title:"Creating images",children:[Object(R.jsx)("p",{children:"Please wait while we create your image."}),Object(R.jsx)(P.a,{progress:ae})]}),Object(R.jsx)(T.a,{show:Ge,title:"Deleting images",children:Object(R.jsx)("p",{children:"Please wait while we delete your images."})}),Object(R.jsx)(T.a,{show:J,title:"Loading parent image",children:Object(R.jsx)("p",{children:"Please wait while we load the parent image."})}),Object(R.jsx)(T.a,{show:Q,title:"Saving image",children:Object(R.jsx)(P.a,{progress:ae})}),Object(R.jsx)(L.a,{images:Ct,onCancel:function(){return oe(!1)},show:ce,onDeleteImage:function(e){jt(e),he(de.filter((function(t){return t.id!==e.id})))}}),Object(R.jsx)(E.a,{show:st,onHide:function(){return it(!1)}}),Object(R.jsx)(_.a,{paymentStatus:p})]})}}).call(this,n(67).Buffer)}},[[379,1,2]]]);
//# sourceMappingURL=main.63be6fba.chunk.js.map