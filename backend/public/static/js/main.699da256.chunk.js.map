{"version":3,"sources":["lib/aspecRatios.ts","client/api.ts","client/base.ts","client/common.ts","pages/image-editor/ImageEditor.tsx","pages/image-editor/renderer.ts","lib/sleep.ts","lib/imageutil.ts","pages/image-editor/import-export.tsx","pages/image-editor/tool.ts","pages/Login.tsx","components/TokenRefresher.tsx","components/Healthchecker.tsx","pages/WorkerConfig.tsx","pages/admin/WorkerList.tsx","pages/admin/Admin.tsx","components/ImageThumbnail.tsx","pages/DeletedImages.tsx","components/ImagePopup.tsx","components/BusyModal.tsx","components/PendingImagesThumbnail.tsx","components/PendingImages.tsx","pages/Homepage.tsx","App.tsx","config.ts","reportWebVitals.ts","index.tsx","pages/image-editor/zoomHelper.tsx","lib/upscale.ts","components/ImagePrompt.tsx","components/AspectRatioSelector.tsx","pages/image-editor/selection-tool.tsx","pages/image-editor/enhance-tool.tsx","pages/image-editor/smudge-tool.tsx","pages/image-editor/PaletteButton.tsx","pages/image-editor/ColorPicker.tsx","pages/image-editor/pencil-tool.tsx"],"names":["DEFAULT_ASPECT_RATIO","aspectRatios","displayName","width","height","id","getClosestAspectRatio","aspectRatio","tests","sort","a","b","aRatio","bRatio","Math","abs","compareSize","upscale","AddMetricItemTypeEnum","CreateImageInputStatusEnum","CreateImageInputHeightEnum","CreateImageInputWidthEnum","CreateServiceAccountInputTypeEnum","HealthcheckStatusEnum","ImageStatusEnum","ImageWidthEnum","ImageHeightEnum","ImageUncropOffsetXEnum","ImageUncropOffsetYEnum","UpdateImageInputStatusEnum","WorkerStatusEnum","BASE_PATH","replace","BaseAPI","configuration","basePath","axios","globalAxios","this","RequiredError","field","msg","name","Error","DUMMY_BASE_URL","assertParamExists","functionName","paramName","paramValue","undefined","setSearchParams","url","searchParams","URLSearchParams","search","objects","object","key","Array","isArray","delete","item","append","set","toString","serializeDataIfNeeded","value","requestOptions","nonString","isJsonMime","headers","JSON","stringify","toPathString","pathname","hash","createRequestFunction","axiosArgs","axiosRequestArgs","options","request","AIBrushApiFp","localVarAxiosParamCreator","addMetrics","addMetricsInput","localVarUrlObj","URL","baseOptions","localVarRequestOptions","method","localVarQueryParameter","localVarHeaderParameter","query","headersFromBaseOptions","data","createImage","createImageInput","createInviteCode","createServiceAccount","createServiceAccountInput","createWorker","upsertWorkerInput","deleteImage","localVarPath","encodeURIComponent","String","deleteWorker","workerId","generateWorkerLoginCode","getAssetsUrl","getFeatures","getImage","getImageData","getMaskData","getNpyData","getThumbnailData","getVideoData","getWorker","getWorkerConfig","getWorkers","healthcheck","isAdmin","listImages","cursor","filter","limit","direction","login","loginInput","loginAsWorker","workerLoginCode","processImage","processImageInput","refresh","refreshLoginInput","updateImage","updateImageInput","updateVideoData","body","updateWorker","updateWorkerConfig","upsertWorkerConfigInput","verify","verifyLoginInput","AIBrushApiAxiosParamCreator","localVarAxiosArgs","AIBrushApi","then","ImageEditor","api","useState","showSelectionControls","setShowSelectionControls","tools","iconClass","constructor","r","SelectionTool","renderControls","t","renderer","tool","defaultArgs","selectionWidth","selectionHeight","EnhanceTool","variationStrength","onShowSelectionControls","image","PencilTool","SmudgeTool","BaseTool","setImage","setRenderer","setTool","canUndo","setCanUndo","canRedo","setCanRedo","useParams","history","useHistory","canvasRef","useRef","onSelectTool","toolconfig","destroy","newTool","onSaveImage","encodedImage","console","log","encoded_image","renderTool","buttonClass","isSelected","className","onClick","charAt","toUpperCase","slice","preventDefault","e","useEffect","responseType","resp","base64ImageData","Buffer","from","src","imageElement","Image","onload","current","createRenderer","setBaseImage","error","onSnapshot","listener","onWheel","addEventListener","removeEventListener","style","fontSize","textAlign","goBack","marginTop","map","verticalAlign","float","select","ref","onMouseDown","onMouseMove","onMouseUp","onMouseLeave","position","left","transform","disabled","undo","updateZoomAndOffset","right","redo","Renderer","canvas","undoStack","redoStack","currentSnapshot","baseImageLayer","editLayer","overlayLayer","selectionOverlay","selectionOverlayPreview","hasSelection","zoom","offsetX","offsetY","snapshotListener","document","createElement","length","imageData","pop","push","ctx","getContext","clearRect","putImageData","render","notifySnapshotListener","snapshot","shift","context","setTransform","drawImage","setSelectionOverlay","x","y","drawOverlay","lineWidth","max","strokeStyle","strokeRect","type","color","beginPath","arc","radius","PI","stroke","fillStyle","fill","moveTo","lineTo","selection","result","toDataURL","remove","split","setEditImage","brushSize","x1","y1","x2","y2","lineCap","brushOpacity","unitVector","sqrt","i","totalRed","totalGreen","totalBlue","count","index","averageRed","averageGreen","averageBlue","pixel","g","rgbToHex","sleep","ms","Promise","resolve","window","setTimeout","featherEdges","imageWidth","imageHeight","featherLeftEdge","featherRightEdge","featherTopEdge","featherBottomEdge","baseWidth","min","featherWidth","floor","pixelIndex","alpha","existingAlpha","ImportExportControls","backupImage","setBackupImage","img","saveListener","marginLeft","display","onChange","event","files","target","loadImage","getEncodedImage","byteString","atob","buffer","ArrayBuffer","intArray","Uint8Array","charCodeAt","blob","Blob","saveAs","onExport","parse","localStorage","getItem","args","setItem","Login","props","email","setEmail","emailSubmitted","setEmailSubmitted","code","setCode","err","setErr","location","inviteCode","qs","substring","onLogin","match","client","invite_code","onVerify","marginRight","fontWeight","href","htmlFor","placeholder","aria-describedby","TokenRefresher","onCredentialsRefreshed","credentials","interval","setInterval","refreshToken","loginResult","clearInterval","Healthchecker","healthCheck","setHealthCheck","catch","role","WorkerConfigPage","Private","setType","setIsAdmin","download","creds","is_admin","WorkerList","workers","setWorkers","onDeleteWorker","worker","w","onGenerateCode","login_code","onCreateWorker","display_name","status","Modal","show","onHide","Header","closeButton","Title","Body","Admin","links","setLinks","onGenerateLink","link","ImageThumbnail","assetsUrl","updated_at","retry","setRetry","hover","setHover","moment","diff","clearTimeout","label","phrases","onMouseEnter","backgroundImage","backgroundSize","margin","nsfw","background","lineHeight","Pending","Processing","DeletedImages","images","setImages","loadImages","add","valueOf","deleted_at","onDeleteImage","onRestoreImage","borderBottom","paddingTop","paddingBottom","ImagePopup","onClose","onDelete","onFork","onEdit","onUpscale","onNSFW","score","negative_phrases","join","trim","negative_score","showNSFW","setShowNSFW","onerror","title","upscaleLevel","getUpscaleLevel","size","maxWidth","maxHeight","alt","displayStatus","icon","Completed","top","statusBadge","Saved","marginBottom","toFixed","BusyModal","children","backdrop","keyboard","PendingImagesThumbnail","pendingCount","processingCount","PendingImages","onCancel","imageIcon","pendingDiv","Footer","Homepage","creating","setCreating","selectedImage","setSelectedImage","parentImage","setParentImage","showPendingImages","setShowPendingImages","hasMore","setHasMore","setSearch","searchDebounce","setSearchDebounce","handle","find","onSubmit","input","scrollTo","onEditNewImage","newImages","imageInput","parent","model","imagesToAdd","sortImages","pollImages","reduce","findIndex","updatedImages","deletedIds","updatedImage","timerHandle","ids","uniqueIds","Set","indexOf","isPendingOrProcessing","aScore","bScore","onLoadMore","minUpdatedAt","forEach","onThumbnailClicked","completedOrSavedImages","pendingOrProcessingImages","pendingImages","processingImages","ImagePrompt","backgroundColor","border","to","dataLength","next","loader","res","config","apiUrl","httpClient","updateHttpClient","accessToken","defaults","common","App","setCredentials","setAssetsUrl","features","setFeatures","init","assets_url","storedCredentials","removeItem","path","exact","padding","privacy_uri","terms_uri","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","StrictMode","getElementById","ZoomHelper","originalZoom","getZoom","getOffsetX","getOffsetY","canvasPoint","translateMouseToCanvasCoordinates","deltaY","xDiff","yDiff","movementX","movementY","rect","getBoundingClientRect","getWidth","getHeight","mouseX","mouseY","getCanvas","round","iterations","encoded_npy","encoded_mask","enable_video","enable_zoom","zoom_frequency","zoom_scale","zoom_shift_x","zoom_shift_y","glid_3_xl_clip_guidance","glid_3_xl_clip_guidance_scale","glid_3_xl_skip_iterations","stable_diffusion_strength","prompt","setPrompt","negativePrompt","setNegativePrompt","setCount","setVariationStrength","setAspectRatio","parentId","setParentId","advancedView","setAdvancedView","setEncodedImage","aspectRatioDetails","setAspectRatioDetails","resetState","handleSubmit","bestMatch","onImageSelected","file","HTMLCanvasElement","base64","textDecoration","aspectRatioId","parseInt","step","parseFloat","minHeight","AspectRatioSelector","alignItems","zoomHelper","panning","sync","setSelectionOverlayPreview","button","updateArgs","getArgs","onPan","nativeEvent","Controls","setSize","eraserWidthModifier","_state","stateHandler","selectionControlsListener","selectedImageDataIndex","selectedImageData","erasing","progressListener","errorListener","handler","state","ImageData","erasePoint","getSelectionOverlay","eraserRadius","relX","relY","startX","startY","endX","endY","j","distance","pow","alphaPct","setCursor","updateCursor","imageId","baseImage","baseImageData","reject","notifyError","closestAspectRatio","temporary","completed","completeCount","imageResp","loadImageData","commitSelection","EnhanceControls","setState","progress","setProgress","setError","onChangeState","onProgress","onError","aria-valuenow","aria-valuemin","aria-valuemax","cancel","confirm","erase","data-dismiss","aria-label","aria-hidden","submit","lastX","lastY","smudging","_dirty","dirtyListener","dirty","smudgeLine","copyEditImageFromBaseImage","SmudgeControls","setBrushSize","setBrushOpacity","setDirty","onDirty","PaletteButton","selectedColor","ColorPicker","onColorSelected","displayColorPicker","setDisplayColorPicker","tmpColor","setTmpColor","zIndex","bottom","hex","onChangeComplete","defaultColors","brushColor","palette","isDrawing","colorPicking","lastPickedColor","colorPickedListener","drawPoint","getPixel","drawLine","setBrushColor","setPalette","addToPalette","onColorPicked","flexDirection","flexWrap","beginColorpicker"],"mappings":"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","file":"static/js/main.699da256.chunk.js","sourcesContent":["export interface AspectRatio {\n    displayName: string;\n    width: number;\n    height: number;\n    id: number;\n}\n\nexport const DEFAULT_ASPECT_RATIO = 5;\n\nexport const aspectRatios: AspectRatio[] = [\n    {\n        displayName: \"4:1\",\n        width: 1024,\n        height: 256,\n        id: 0,\n    },\n    {\n        displayName: \"3:1\",\n        width: 768,\n        height: 256,\n        id: 1,\n    },\n    {\n        displayName: \"2:1\",\n        width: 640,\n        height: 320,\n        id: 2,\n    },\n    {\n        displayName: \"3:2\",\n        width: 576,\n        height: 384,\n        id: 3,\n    },\n    {\n        displayName: \"5:4\",\n        width: 640,\n        height: 512,\n        id: 4,\n    },\n    {\n        displayName: \"1:1\",\n        width: 512,\n        height: 512,\n        id: 5,\n    },\n    {\n        displayName: \"4:5\",\n        width: 512,\n        height: 640,\n        id: 6,\n    },\n    {\n        displayName: \"2:3\",\n        width: 384,\n        height: 576,\n        id: 7,\n    },\n    {\n        displayName: \"1:2\",\n        width: 320,\n        height: 640,\n        id: 8,\n    },\n    {\n        displayName: \"1:3\",\n        width: 256,\n        height: 768,\n        id: 9,\n    },\n    {\n        displayName: \"1:4\",\n        width: 256,\n        height: 1024,\n        id: 10,\n    }\n];\n\nexport function getClosestAspectRatio(width: number, height: number): AspectRatio {\n    const aspectRatio = width / height;\n\n    const tests = [...aspectRatios];\n    tests.sort((a, b) => {\n        const aRatio = a.width / a.height;\n        const bRatio = b.width / b.height;\n        return (\n            Math.abs(aRatio - aspectRatio) -\n            Math.abs(bRatio - aspectRatio)\n        );\n    });\n    const bestMatch = tests[0];\n    return bestMatch;\n}\n\nexport function compareSize(a: AspectRatio, width: number, height: number): number {\n    const area1 = a.width * a.height;\n    const area2 = width * height;\n    return area1 - area2;\n}\n\nexport function upscale(aspectRatio: AspectRatio): AspectRatio {\n    return {\n        displayName: aspectRatio.displayName,\n        width: aspectRatio.width * 2,\n        height: aspectRatio.height * 2,\n        id: aspectRatio.id,\n    }\n}\n\nexport function downscale(aspectRatio: AspectRatio): AspectRatio {\n    return {\n        displayName: aspectRatio.displayName,\n        width: aspectRatio.width / 2,\n        height: aspectRatio.height / 2,\n        id: aspectRatio.id,\n    }\n}\n","/* tslint:disable */\n/* eslint-disable */\n/**\n * AIBrush API\n * Orchestration backend for AI Brush\n *\n * The version of the OpenAPI document: 1.0.0\n * Contact: wolfgangmeyers@gmail.com\n *\n * NOTE: This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).\n * https://openapi-generator.tech\n * Do not edit the class manually.\n */\n\n\nimport { Configuration } from './configuration';\nimport globalAxios, { AxiosPromise, AxiosInstance } from 'axios';\n// Some imports not used depending on template conditions\n// @ts-ignore\nimport { DUMMY_BASE_URL, assertParamExists, setApiKeyToObject, setBasicAuthToObject, setBearerAuthToObject, setOAuthToObject, setSearchParams, serializeDataIfNeeded, toPathString, createRequestFunction } from './common';\n// @ts-ignore\nimport { BASE_PATH, COLLECTION_FORMATS, RequestArgs, BaseAPI, RequiredError } from './base';\n\n/**\n * \n * @export\n * @interface AddMetricItem\n */\nexport interface AddMetricItem {\n    /**\n     * \n     * @type {string}\n     * @memberof AddMetricItem\n     */\n    name: string;\n    /**\n     * \n     * @type {number}\n     * @memberof AddMetricItem\n     */\n    value: number;\n    /**\n     * \n     * @type {string}\n     * @memberof AddMetricItem\n     */\n    type: AddMetricItemTypeEnum;\n    /**\n     * \n     * @type {Array<MetricAttribute>}\n     * @memberof AddMetricItem\n     */\n    attributes: Array<MetricAttribute>;\n}\n\n/**\n    * @export\n    * @enum {string}\n    */\nexport enum AddMetricItemTypeEnum {\n    Gauge = 'gauge',\n    Count = 'count'\n}\n\n/**\n * \n * @export\n * @interface AddMetricsInput\n */\nexport interface AddMetricsInput {\n    /**\n     * \n     * @type {Array<AddMetricItem>}\n     * @memberof AddMetricsInput\n     */\n    metrics: Array<AddMetricItem>;\n}\n/**\n * \n * @export\n * @interface AssetsUrl\n */\nexport interface AssetsUrl {\n    /**\n     * \n     * @type {string}\n     * @memberof AssetsUrl\n     */\n    assets_url: string;\n}\n/**\n * \n * @export\n * @interface CreateImageInput\n */\nexport interface CreateImageInput {\n    /**\n     * \n     * @type {string}\n     * @memberof CreateImageInput\n     */\n    status?: CreateImageInputStatusEnum;\n    /**\n     * \n     * @type {Array<string>}\n     * @memberof CreateImageInput\n     */\n    phrases?: Array<string>;\n    /**\n     * \n     * @type {Array<string>}\n     * @memberof CreateImageInput\n     */\n    negative_phrases?: Array<string>;\n    /**\n     * \n     * @type {string}\n     * @memberof CreateImageInput\n     */\n    label?: string;\n    /**\n     * \n     * @type {number}\n     * @memberof CreateImageInput\n     */\n    iterations?: number;\n    /**\n     * \n     * @type {string}\n     * @memberof CreateImageInput\n     */\n    parent?: string;\n    /**\n     * \n     * @type {string}\n     * @memberof CreateImageInput\n     */\n    encoded_image?: string;\n    /**\n     * \n     * @type {string}\n     * @memberof CreateImageInput\n     */\n    encoded_mask?: string;\n    /**\n     * \n     * @type {string}\n     * @memberof CreateImageInput\n     */\n    encoded_npy?: string;\n    /**\n     * \n     * @type {boolean}\n     * @memberof CreateImageInput\n     */\n    enable_video?: boolean;\n    /**\n     * \n     * @type {boolean}\n     * @memberof CreateImageInput\n     */\n    enable_zoom?: boolean;\n    /**\n     * \n     * @type {number}\n     * @memberof CreateImageInput\n     */\n    zoom_frequency?: number;\n    /**\n     * \n     * @type {number}\n     * @memberof CreateImageInput\n     */\n    zoom_scale?: number;\n    /**\n     * \n     * @type {number}\n     * @memberof CreateImageInput\n     */\n    zoom_shift_x?: number;\n    /**\n     * \n     * @type {number}\n     * @memberof CreateImageInput\n     */\n    zoom_shift_y?: number;\n    /**\n     * \n     * @type {string}\n     * @memberof CreateImageInput\n     */\n    model?: string;\n    /**\n     * \n     * @type {number}\n     * @memberof CreateImageInput\n     */\n    glid_3_xl_skip_iterations?: number;\n    /**\n     * \n     * @type {boolean}\n     * @memberof CreateImageInput\n     */\n    glid_3_xl_clip_guidance?: boolean;\n    /**\n     * \n     * @type {number}\n     * @memberof CreateImageInput\n     */\n    glid_3_xl_clip_guidance_scale?: number;\n    /**\n     * \n     * @type {number}\n     * @memberof CreateImageInput\n     */\n    height?: CreateImageInputHeightEnum;\n    /**\n     * \n     * @type {number}\n     * @memberof CreateImageInput\n     */\n    width?: CreateImageInputWidthEnum;\n    /**\n     * \n     * @type {number}\n     * @memberof CreateImageInput\n     */\n    uncrop_offset_x?: number;\n    /**\n     * \n     * @type {number}\n     * @memberof CreateImageInput\n     */\n    uncrop_offset_y?: number;\n    /**\n     * \n     * @type {number}\n     * @memberof CreateImageInput\n     */\n    stable_diffusion_strength?: number;\n    /**\n     * \n     * @type {number}\n     * @memberof CreateImageInput\n     */\n    count?: number;\n    /**\n     * \n     * @type {boolean}\n     * @memberof CreateImageInput\n     */\n    nsfw?: boolean;\n    /**\n     * \n     * @type {boolean}\n     * @memberof CreateImageInput\n     */\n    temporary?: boolean;\n}\n\n/**\n    * @export\n    * @enum {string}\n    */\nexport enum CreateImageInputStatusEnum {\n    Pending = 'pending',\n    Processing = 'processing',\n    Completed = 'completed',\n    Saved = 'saved',\n    Error = 'error'\n}\n/**\n    * @export\n    * @enum {string}\n    */\nexport enum CreateImageInputHeightEnum {\n    NUMBER_128 = 128,\n    NUMBER_256 = 256,\n    NUMBER_384 = 384,\n    NUMBER_512 = 512,\n    NUMBER_640 = 640,\n    NUMBER_768 = 768,\n    NUMBER_896 = 896,\n    NUMBER_1024 = 1024\n}\n/**\n    * @export\n    * @enum {string}\n    */\nexport enum CreateImageInputWidthEnum {\n    NUMBER_128 = 128,\n    NUMBER_256 = 256,\n    NUMBER_384 = 384,\n    NUMBER_512 = 512,\n    NUMBER_640 = 640,\n    NUMBER_768 = 768,\n    NUMBER_896 = 896,\n    NUMBER_1024 = 1024\n}\n\n/**\n * \n * @export\n * @interface CreateServiceAccountInput\n */\nexport interface CreateServiceAccountInput {\n    /**\n     * \n     * @type {string}\n     * @memberof CreateServiceAccountInput\n     */\n    type?: CreateServiceAccountInputTypeEnum;\n}\n\n/**\n    * @export\n    * @enum {string}\n    */\nexport enum CreateServiceAccountInputTypeEnum {\n    Public = 'public',\n    Private = 'private'\n}\n\n/**\n * \n * @export\n * @interface FeatureList\n */\nexport interface FeatureList {\n    /**\n     * \n     * @type {string}\n     * @memberof FeatureList\n     */\n    terms_uri?: string;\n    /**\n     * \n     * @type {string}\n     * @memberof FeatureList\n     */\n    privacy_uri?: string;\n}\n/**\n * \n * @export\n * @interface Healthcheck\n */\nexport interface Healthcheck {\n    /**\n     * \n     * @type {string}\n     * @memberof Healthcheck\n     */\n    status?: HealthcheckStatusEnum;\n}\n\n/**\n    * @export\n    * @enum {string}\n    */\nexport enum HealthcheckStatusEnum {\n    Ok = 'ok'\n}\n\n/**\n * \n * @export\n * @interface Image\n */\nexport interface Image {\n    /**\n     * \n     * @type {string}\n     * @memberof Image\n     */\n    id: string;\n    /**\n     * \n     * @type {number}\n     * @memberof Image\n     */\n    created_at: number;\n    /**\n     * \n     * @type {string}\n     * @memberof Image\n     */\n    created_by: string;\n    /**\n     * \n     * @type {number}\n     * @memberof Image\n     */\n    updated_at: number;\n    /**\n     * \n     * @type {Array<string>}\n     * @memberof Image\n     */\n    phrases: Array<string>;\n    /**\n     * \n     * @type {Array<string>}\n     * @memberof Image\n     */\n    negative_phrases: Array<string>;\n    /**\n     * \n     * @type {string}\n     * @memberof Image\n     */\n    label: string;\n    /**\n     * \n     * @type {string}\n     * @memberof Image\n     */\n    parent: string;\n    /**\n     * \n     * @type {number}\n     * @memberof Image\n     */\n    iterations: number;\n    /**\n     * \n     * @type {number}\n     * @memberof Image\n     */\n    current_iterations: number;\n    /**\n     * \n     * @type {number}\n     * @memberof Image\n     */\n    score: number;\n    /**\n     * \n     * @type {number}\n     * @memberof Image\n     */\n    negative_score: number;\n    /**\n     * \n     * @type {string}\n     * @memberof Image\n     */\n    status: ImageStatusEnum;\n    /**\n     * \n     * @type {boolean}\n     * @memberof Image\n     */\n    enable_video: boolean;\n    /**\n     * \n     * @type {boolean}\n     * @memberof Image\n     */\n    enable_zoom?: boolean;\n    /**\n     * \n     * @type {number}\n     * @memberof Image\n     */\n    zoom_frequency?: number;\n    /**\n     * \n     * @type {number}\n     * @memberof Image\n     */\n    zoom_scale?: number;\n    /**\n     * \n     * @type {number}\n     * @memberof Image\n     */\n    zoom_shift_x?: number;\n    /**\n     * \n     * @type {number}\n     * @memberof Image\n     */\n    zoom_shift_y?: number;\n    /**\n     * \n     * @type {string}\n     * @memberof Image\n     */\n    model: string;\n    /**\n     * \n     * @type {number}\n     * @memberof Image\n     */\n    glid_3_xl_skip_iterations?: number;\n    /**\n     * \n     * @type {boolean}\n     * @memberof Image\n     */\n    glid_3_xl_clip_guidance?: boolean;\n    /**\n     * \n     * @type {number}\n     * @memberof Image\n     */\n    glid_3_xl_clip_guidance_scale?: number;\n    /**\n     * \n     * @type {number}\n     * @memberof Image\n     */\n    width: ImageWidthEnum;\n    /**\n     * \n     * @type {number}\n     * @memberof Image\n     */\n    height: ImageHeightEnum;\n    /**\n     * \n     * @type {number}\n     * @memberof Image\n     */\n    uncrop_offset_x?: ImageUncropOffsetXEnum;\n    /**\n     * \n     * @type {number}\n     * @memberof Image\n     */\n    uncrop_offset_y?: ImageUncropOffsetYEnum;\n    /**\n     * \n     * @type {number}\n     * @memberof Image\n     */\n    stable_diffusion_strength: number;\n    /**\n     * \n     * @type {boolean}\n     * @memberof Image\n     */\n    nsfw: boolean;\n    /**\n     * \n     * @type {boolean}\n     * @memberof Image\n     */\n    temporary: boolean;\n    /**\n     * \n     * @type {number}\n     * @memberof Image\n     */\n    deleted_at?: number;\n}\n\n/**\n    * @export\n    * @enum {string}\n    */\nexport enum ImageStatusEnum {\n    Pending = 'pending',\n    Processing = 'processing',\n    Completed = 'completed',\n    Saved = 'saved',\n    Error = 'error'\n}\n/**\n    * @export\n    * @enum {string}\n    */\nexport enum ImageWidthEnum {\n    NUMBER_128 = 128,\n    NUMBER_256 = 256,\n    NUMBER_384 = 384,\n    NUMBER_512 = 512,\n    NUMBER_640 = 640,\n    NUMBER_768 = 768,\n    NUMBER_896 = 896,\n    NUMBER_1024 = 1024\n}\n/**\n    * @export\n    * @enum {string}\n    */\nexport enum ImageHeightEnum {\n    NUMBER_128 = 128,\n    NUMBER_256 = 256,\n    NUMBER_384 = 384,\n    NUMBER_512 = 512,\n    NUMBER_640 = 640,\n    NUMBER_768 = 768,\n    NUMBER_896 = 896,\n    NUMBER_1024 = 1024\n}\n/**\n    * @export\n    * @enum {string}\n    */\nexport enum ImageUncropOffsetXEnum {\n    NUMBER_MINUS_896 = -896,\n    NUMBER_MINUS_768 = -768,\n    NUMBER_MINUS_640 = -640,\n    NUMBER_MINUS_512 = -512,\n    NUMBER_MINUS_384 = -384,\n    NUMBER_MINUS_256 = -256,\n    NUMBER_MINUS_128 = -128,\n    NUMBER_0 = 0,\n    NUMBER_128 = 128,\n    NUMBER_256 = 256,\n    NUMBER_384 = 384,\n    NUMBER_512 = 512,\n    NUMBER_640 = 640,\n    NUMBER_768 = 768,\n    NUMBER_896 = 896\n}\n/**\n    * @export\n    * @enum {string}\n    */\nexport enum ImageUncropOffsetYEnum {\n    NUMBER_MINUS_896 = -896,\n    NUMBER_MINUS_768 = -768,\n    NUMBER_MINUS_640 = -640,\n    NUMBER_MINUS_512 = -512,\n    NUMBER_MINUS_384 = -384,\n    NUMBER_MINUS_256 = -256,\n    NUMBER_MINUS_128 = -128,\n    NUMBER_0 = 0,\n    NUMBER_128 = 128,\n    NUMBER_256 = 256,\n    NUMBER_384 = 384,\n    NUMBER_512 = 512,\n    NUMBER_640 = 640,\n    NUMBER_768 = 768,\n    NUMBER_896 = 896\n}\n\n/**\n * \n * @export\n * @interface ImageList\n */\nexport interface ImageList {\n    /**\n     * \n     * @type {Array<Image>}\n     * @memberof ImageList\n     */\n    images?: Array<Image>;\n}\n/**\n * \n * @export\n * @interface InviteCode\n */\nexport interface InviteCode {\n    /**\n     * \n     * @type {string}\n     * @memberof InviteCode\n     */\n    id?: string;\n    /**\n     * \n     * @type {number}\n     * @memberof InviteCode\n     */\n    created_at?: number;\n    /**\n     * \n     * @type {string}\n     * @memberof InviteCode\n     */\n    created_by?: string;\n}\n/**\n * \n * @export\n * @interface IsAdminResponse\n */\nexport interface IsAdminResponse {\n    /**\n     * \n     * @type {boolean}\n     * @memberof IsAdminResponse\n     */\n    is_admin?: boolean;\n}\n/**\n * \n * @export\n * @interface LoginInput\n */\nexport interface LoginInput {\n    /**\n     * \n     * @type {string}\n     * @memberof LoginInput\n     */\n    email?: string;\n    /**\n     * \n     * @type {string}\n     * @memberof LoginInput\n     */\n    invite_code?: string;\n}\n/**\n * \n * @export\n * @interface LoginResult\n */\nexport interface LoginResult {\n    /**\n     * \n     * @type {string}\n     * @memberof LoginResult\n     */\n    accessToken?: string;\n    /**\n     * \n     * @type {string}\n     * @memberof LoginResult\n     */\n    refreshToken?: string;\n}\n/**\n * \n * @export\n * @interface MetricAttribute\n */\nexport interface MetricAttribute {\n    /**\n     * \n     * @type {string}\n     * @memberof MetricAttribute\n     */\n    name?: string;\n    /**\n     * \n     * @type {string}\n     * @memberof MetricAttribute\n     */\n    value?: string;\n}\n/**\n * \n * @export\n * @interface ProcessImageInput\n */\nexport interface ProcessImageInput {\n    /**\n     * \n     * @type {boolean}\n     * @memberof ProcessImageInput\n     */\n    zoom_supported: boolean;\n}\n/**\n * \n * @export\n * @interface RefreshLoginInput\n */\nexport interface RefreshLoginInput {\n    /**\n     * \n     * @type {string}\n     * @memberof RefreshLoginInput\n     */\n    refreshToken?: string;\n}\n/**\n * \n * @export\n * @interface UpdateImageInput\n */\nexport interface UpdateImageInput {\n    /**\n     * \n     * @type {string}\n     * @memberof UpdateImageInput\n     */\n    label?: string;\n    /**\n     * \n     * @type {number}\n     * @memberof UpdateImageInput\n     */\n    current_iterations?: number;\n    /**\n     * \n     * @type {string}\n     * @memberof UpdateImageInput\n     */\n    status?: UpdateImageInputStatusEnum;\n    /**\n     * \n     * @type {string}\n     * @memberof UpdateImageInput\n     */\n    encoded_image?: string;\n    /**\n     * \n     * @type {string}\n     * @memberof UpdateImageInput\n     */\n    encoded_npy?: string;\n    /**\n     * \n     * @type {number}\n     * @memberof UpdateImageInput\n     */\n    score?: number;\n    /**\n     * \n     * @type {number}\n     * @memberof UpdateImageInput\n     */\n    negative_score?: number;\n    /**\n     * \n     * @type {boolean}\n     * @memberof UpdateImageInput\n     */\n    nsfw?: boolean;\n    /**\n     * \n     * @type {number}\n     * @memberof UpdateImageInput\n     */\n    deleted_at?: number | null;\n}\n\n/**\n    * @export\n    * @enum {string}\n    */\nexport enum UpdateImageInputStatusEnum {\n    Pending = 'pending',\n    Processing = 'processing',\n    Completed = 'completed',\n    Saved = 'saved',\n    Error = 'error'\n}\n\n/**\n * \n * @export\n * @interface UpsertWorkerConfigInput\n */\nexport interface UpsertWorkerConfigInput {\n    /**\n     * \n     * @type {string}\n     * @memberof UpsertWorkerConfigInput\n     */\n    model: string;\n    /**\n     * \n     * @type {string}\n     * @memberof UpsertWorkerConfigInput\n     */\n    pool_assignment: string;\n}\n/**\n * \n * @export\n * @interface UpsertWorkerInput\n */\nexport interface UpsertWorkerInput {\n    /**\n     * \n     * @type {string}\n     * @memberof UpsertWorkerInput\n     */\n    display_name: string;\n}\n/**\n * \n * @export\n * @interface User\n */\nexport interface User {\n    /**\n     * \n     * @type {string}\n     * @memberof User\n     */\n    id?: string;\n    /**\n     * \n     * @type {boolean}\n     * @memberof User\n     */\n    active?: boolean;\n}\n/**\n * \n * @export\n * @interface VerifyLoginInput\n */\nexport interface VerifyLoginInput {\n    /**\n     * \n     * @type {string}\n     * @memberof VerifyLoginInput\n     */\n    email?: string;\n    /**\n     * \n     * @type {string}\n     * @memberof VerifyLoginInput\n     */\n    code?: string;\n}\n/**\n * \n * @export\n * @interface Worker\n */\nexport interface Worker {\n    /**\n     * \n     * @type {string}\n     * @memberof Worker\n     */\n    id: string;\n    /**\n     * \n     * @type {number}\n     * @memberof Worker\n     */\n    created_at: number;\n    /**\n     * \n     * @type {string}\n     * @memberof Worker\n     */\n    display_name: string;\n    /**\n     * \n     * @type {number}\n     * @memberof Worker\n     */\n    last_ping?: number;\n    /**\n     * \n     * @type {string}\n     * @memberof Worker\n     */\n    status?: WorkerStatusEnum;\n    /**\n     * \n     * @type {string}\n     * @memberof Worker\n     */\n    login_code?: string;\n}\n\n/**\n    * @export\n    * @enum {string}\n    */\nexport enum WorkerStatusEnum {\n    Inactive = 'inactive',\n    Initializing = 'initializing',\n    Warming = 'warming',\n    Active = 'active',\n    Error = 'error'\n}\n\n/**\n * \n * @export\n * @interface WorkerConfig\n */\nexport interface WorkerConfig {\n    /**\n     * \n     * @type {string}\n     * @memberof WorkerConfig\n     */\n    worker_id: string;\n    /**\n     * \n     * @type {string}\n     * @memberof WorkerConfig\n     */\n    model: string;\n    /**\n     * \n     * @type {string}\n     * @memberof WorkerConfig\n     */\n    pool_assignment: string;\n}\n/**\n * \n * @export\n * @interface WorkerList\n */\nexport interface WorkerList {\n    /**\n     * \n     * @type {Array<Worker>}\n     * @memberof WorkerList\n     */\n    workers?: Array<Worker>;\n}\n/**\n * \n * @export\n * @interface WorkerLoginCode\n */\nexport interface WorkerLoginCode {\n    /**\n     * \n     * @type {string}\n     * @memberof WorkerLoginCode\n     */\n    login_code: string;\n}\n\n/**\n * AIBrushApi - axios parameter creator\n * @export\n */\nexport const AIBrushApiAxiosParamCreator = function (configuration?: Configuration) {\n    return {\n        /**\n         * Add Metrics\n         * @param {AddMetricsInput} [addMetricsInput] \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        addMetrics: async (addMetricsInput?: AddMetricsInput, options: any = {}): Promise<RequestArgs> => {\n            const localVarPath = `/api/metrics`;\n            // use dummy base URL string because the URL constructor only accepts absolute URLs.\n            const localVarUrlObj = new URL(localVarPath, DUMMY_BASE_URL);\n            let baseOptions;\n            if (configuration) {\n                baseOptions = configuration.baseOptions;\n            }\n\n            const localVarRequestOptions = { method: 'POST', ...baseOptions, ...options};\n            const localVarHeaderParameter = {} as any;\n            const localVarQueryParameter = {} as any;\n\n\n    \n            localVarHeaderParameter['Content-Type'] = 'application/json';\n\n            setSearchParams(localVarUrlObj, localVarQueryParameter, options.query);\n            let headersFromBaseOptions = baseOptions && baseOptions.headers ? baseOptions.headers : {};\n            localVarRequestOptions.headers = {...localVarHeaderParameter, ...headersFromBaseOptions, ...options.headers};\n            localVarRequestOptions.data = serializeDataIfNeeded(addMetricsInput, localVarRequestOptions, configuration)\n\n            return {\n                url: toPathString(localVarUrlObj),\n                options: localVarRequestOptions,\n            };\n        },\n        /**\n         * Create a new image\n         * @param {CreateImageInput} [createImageInput] \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        createImage: async (createImageInput?: CreateImageInput, options: any = {}): Promise<RequestArgs> => {\n            const localVarPath = `/api/images`;\n            // use dummy base URL string because the URL constructor only accepts absolute URLs.\n            const localVarUrlObj = new URL(localVarPath, DUMMY_BASE_URL);\n            let baseOptions;\n            if (configuration) {\n                baseOptions = configuration.baseOptions;\n            }\n\n            const localVarRequestOptions = { method: 'POST', ...baseOptions, ...options};\n            const localVarHeaderParameter = {} as any;\n            const localVarQueryParameter = {} as any;\n\n\n    \n            localVarHeaderParameter['Content-Type'] = 'application/json';\n\n            setSearchParams(localVarUrlObj, localVarQueryParameter, options.query);\n            let headersFromBaseOptions = baseOptions && baseOptions.headers ? baseOptions.headers : {};\n            localVarRequestOptions.headers = {...localVarHeaderParameter, ...headersFromBaseOptions, ...options.headers};\n            localVarRequestOptions.data = serializeDataIfNeeded(createImageInput, localVarRequestOptions, configuration)\n\n            return {\n                url: toPathString(localVarUrlObj),\n                options: localVarRequestOptions,\n            };\n        },\n        /**\n         * Create a new invite code\n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        createInviteCode: async (options: any = {}): Promise<RequestArgs> => {\n            const localVarPath = `/api/invite-codes`;\n            // use dummy base URL string because the URL constructor only accepts absolute URLs.\n            const localVarUrlObj = new URL(localVarPath, DUMMY_BASE_URL);\n            let baseOptions;\n            if (configuration) {\n                baseOptions = configuration.baseOptions;\n            }\n\n            const localVarRequestOptions = { method: 'POST', ...baseOptions, ...options};\n            const localVarHeaderParameter = {} as any;\n            const localVarQueryParameter = {} as any;\n\n\n    \n            setSearchParams(localVarUrlObj, localVarQueryParameter, options.query);\n            let headersFromBaseOptions = baseOptions && baseOptions.headers ? baseOptions.headers : {};\n            localVarRequestOptions.headers = {...localVarHeaderParameter, ...headersFromBaseOptions, ...options.headers};\n\n            return {\n                url: toPathString(localVarUrlObj),\n                options: localVarRequestOptions,\n            };\n        },\n        /**\n         * Create a service account\n         * @param {CreateServiceAccountInput} [createServiceAccountInput] \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        createServiceAccount: async (createServiceAccountInput?: CreateServiceAccountInput, options: any = {}): Promise<RequestArgs> => {\n            const localVarPath = `/api/auth/service-accounts`;\n            // use dummy base URL string because the URL constructor only accepts absolute URLs.\n            const localVarUrlObj = new URL(localVarPath, DUMMY_BASE_URL);\n            let baseOptions;\n            if (configuration) {\n                baseOptions = configuration.baseOptions;\n            }\n\n            const localVarRequestOptions = { method: 'POST', ...baseOptions, ...options};\n            const localVarHeaderParameter = {} as any;\n            const localVarQueryParameter = {} as any;\n\n\n    \n            localVarHeaderParameter['Content-Type'] = 'application/json';\n\n            setSearchParams(localVarUrlObj, localVarQueryParameter, options.query);\n            let headersFromBaseOptions = baseOptions && baseOptions.headers ? baseOptions.headers : {};\n            localVarRequestOptions.headers = {...localVarHeaderParameter, ...headersFromBaseOptions, ...options.headers};\n            localVarRequestOptions.data = serializeDataIfNeeded(createServiceAccountInput, localVarRequestOptions, configuration)\n\n            return {\n                url: toPathString(localVarUrlObj),\n                options: localVarRequestOptions,\n            };\n        },\n        /**\n         * Create a new worker\n         * @param {UpsertWorkerInput} [upsertWorkerInput] \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        createWorker: async (upsertWorkerInput?: UpsertWorkerInput, options: any = {}): Promise<RequestArgs> => {\n            const localVarPath = `/api/workers`;\n            // use dummy base URL string because the URL constructor only accepts absolute URLs.\n            const localVarUrlObj = new URL(localVarPath, DUMMY_BASE_URL);\n            let baseOptions;\n            if (configuration) {\n                baseOptions = configuration.baseOptions;\n            }\n\n            const localVarRequestOptions = { method: 'POST', ...baseOptions, ...options};\n            const localVarHeaderParameter = {} as any;\n            const localVarQueryParameter = {} as any;\n\n\n    \n            localVarHeaderParameter['Content-Type'] = 'application/json';\n\n            setSearchParams(localVarUrlObj, localVarQueryParameter, options.query);\n            let headersFromBaseOptions = baseOptions && baseOptions.headers ? baseOptions.headers : {};\n            localVarRequestOptions.headers = {...localVarHeaderParameter, ...headersFromBaseOptions, ...options.headers};\n            localVarRequestOptions.data = serializeDataIfNeeded(upsertWorkerInput, localVarRequestOptions, configuration)\n\n            return {\n                url: toPathString(localVarUrlObj),\n                options: localVarRequestOptions,\n            };\n        },\n        /**\n         * Delete a saved image\n         * @param {string} id \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        deleteImage: async (id: string, options: any = {}): Promise<RequestArgs> => {\n            // verify required parameter 'id' is not null or undefined\n            assertParamExists('deleteImage', 'id', id)\n            const localVarPath = `/api/images/{id}`\n                .replace(`{${\"id\"}}`, encodeURIComponent(String(id)));\n            // use dummy base URL string because the URL constructor only accepts absolute URLs.\n            const localVarUrlObj = new URL(localVarPath, DUMMY_BASE_URL);\n            let baseOptions;\n            if (configuration) {\n                baseOptions = configuration.baseOptions;\n            }\n\n            const localVarRequestOptions = { method: 'DELETE', ...baseOptions, ...options};\n            const localVarHeaderParameter = {} as any;\n            const localVarQueryParameter = {} as any;\n\n\n    \n            setSearchParams(localVarUrlObj, localVarQueryParameter, options.query);\n            let headersFromBaseOptions = baseOptions && baseOptions.headers ? baseOptions.headers : {};\n            localVarRequestOptions.headers = {...localVarHeaderParameter, ...headersFromBaseOptions, ...options.headers};\n\n            return {\n                url: toPathString(localVarUrlObj),\n                options: localVarRequestOptions,\n            };\n        },\n        /**\n         * Delete a worker\n         * @param {string} workerId \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        deleteWorker: async (workerId: string, options: any = {}): Promise<RequestArgs> => {\n            // verify required parameter 'workerId' is not null or undefined\n            assertParamExists('deleteWorker', 'workerId', workerId)\n            const localVarPath = `/api/workers/{worker_id}`\n                .replace(`{${\"worker_id\"}}`, encodeURIComponent(String(workerId)));\n            // use dummy base URL string because the URL constructor only accepts absolute URLs.\n            const localVarUrlObj = new URL(localVarPath, DUMMY_BASE_URL);\n            let baseOptions;\n            if (configuration) {\n                baseOptions = configuration.baseOptions;\n            }\n\n            const localVarRequestOptions = { method: 'DELETE', ...baseOptions, ...options};\n            const localVarHeaderParameter = {} as any;\n            const localVarQueryParameter = {} as any;\n\n\n    \n            setSearchParams(localVarUrlObj, localVarQueryParameter, options.query);\n            let headersFromBaseOptions = baseOptions && baseOptions.headers ? baseOptions.headers : {};\n            localVarRequestOptions.headers = {...localVarHeaderParameter, ...headersFromBaseOptions, ...options.headers};\n\n            return {\n                url: toPathString(localVarUrlObj),\n                options: localVarRequestOptions,\n            };\n        },\n        /**\n         * Generate a login code for a worker\n         * @param {string} workerId \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        generateWorkerLoginCode: async (workerId: string, options: any = {}): Promise<RequestArgs> => {\n            // verify required parameter 'workerId' is not null or undefined\n            assertParamExists('generateWorkerLoginCode', 'workerId', workerId)\n            const localVarPath = `/api/workers/{worker_id}/login-code`\n                .replace(`{${\"worker_id\"}}`, encodeURIComponent(String(workerId)));\n            // use dummy base URL string because the URL constructor only accepts absolute URLs.\n            const localVarUrlObj = new URL(localVarPath, DUMMY_BASE_URL);\n            let baseOptions;\n            if (configuration) {\n                baseOptions = configuration.baseOptions;\n            }\n\n            const localVarRequestOptions = { method: 'POST', ...baseOptions, ...options};\n            const localVarHeaderParameter = {} as any;\n            const localVarQueryParameter = {} as any;\n\n\n    \n            setSearchParams(localVarUrlObj, localVarQueryParameter, options.query);\n            let headersFromBaseOptions = baseOptions && baseOptions.headers ? baseOptions.headers : {};\n            localVarRequestOptions.headers = {...localVarHeaderParameter, ...headersFromBaseOptions, ...options.headers};\n\n            return {\n                url: toPathString(localVarUrlObj),\n                options: localVarRequestOptions,\n            };\n        },\n        /**\n         * Get the assets url\n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        getAssetsUrl: async (options: any = {}): Promise<RequestArgs> => {\n            const localVarPath = `/api/assets-url`;\n            // use dummy base URL string because the URL constructor only accepts absolute URLs.\n            const localVarUrlObj = new URL(localVarPath, DUMMY_BASE_URL);\n            let baseOptions;\n            if (configuration) {\n                baseOptions = configuration.baseOptions;\n            }\n\n            const localVarRequestOptions = { method: 'GET', ...baseOptions, ...options};\n            const localVarHeaderParameter = {} as any;\n            const localVarQueryParameter = {} as any;\n\n\n    \n            setSearchParams(localVarUrlObj, localVarQueryParameter, options.query);\n            let headersFromBaseOptions = baseOptions && baseOptions.headers ? baseOptions.headers : {};\n            localVarRequestOptions.headers = {...localVarHeaderParameter, ...headersFromBaseOptions, ...options.headers};\n\n            return {\n                url: toPathString(localVarUrlObj),\n                options: localVarRequestOptions,\n            };\n        },\n        /**\n         * Get the features\n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        getFeatures: async (options: any = {}): Promise<RequestArgs> => {\n            const localVarPath = `/api/features`;\n            // use dummy base URL string because the URL constructor only accepts absolute URLs.\n            const localVarUrlObj = new URL(localVarPath, DUMMY_BASE_URL);\n            let baseOptions;\n            if (configuration) {\n                baseOptions = configuration.baseOptions;\n            }\n\n            const localVarRequestOptions = { method: 'GET', ...baseOptions, ...options};\n            const localVarHeaderParameter = {} as any;\n            const localVarQueryParameter = {} as any;\n\n\n    \n            setSearchParams(localVarUrlObj, localVarQueryParameter, options.query);\n            let headersFromBaseOptions = baseOptions && baseOptions.headers ? baseOptions.headers : {};\n            localVarRequestOptions.headers = {...localVarHeaderParameter, ...headersFromBaseOptions, ...options.headers};\n\n            return {\n                url: toPathString(localVarUrlObj),\n                options: localVarRequestOptions,\n            };\n        },\n        /**\n         * Get a saved image by id\n         * @param {string} id \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        getImage: async (id: string, options: any = {}): Promise<RequestArgs> => {\n            // verify required parameter 'id' is not null or undefined\n            assertParamExists('getImage', 'id', id)\n            const localVarPath = `/api/images/{id}`\n                .replace(`{${\"id\"}}`, encodeURIComponent(String(id)));\n            // use dummy base URL string because the URL constructor only accepts absolute URLs.\n            const localVarUrlObj = new URL(localVarPath, DUMMY_BASE_URL);\n            let baseOptions;\n            if (configuration) {\n                baseOptions = configuration.baseOptions;\n            }\n\n            const localVarRequestOptions = { method: 'GET', ...baseOptions, ...options};\n            const localVarHeaderParameter = {} as any;\n            const localVarQueryParameter = {} as any;\n\n\n    \n            setSearchParams(localVarUrlObj, localVarQueryParameter, options.query);\n            let headersFromBaseOptions = baseOptions && baseOptions.headers ? baseOptions.headers : {};\n            localVarRequestOptions.headers = {...localVarHeaderParameter, ...headersFromBaseOptions, ...options.headers};\n\n            return {\n                url: toPathString(localVarUrlObj),\n                options: localVarRequestOptions,\n            };\n        },\n        /**\n         * Get the binary image data\n         * @param {string} id \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        getImageData: async (id: string, options: any = {}): Promise<RequestArgs> => {\n            // verify required parameter 'id' is not null or undefined\n            assertParamExists('getImageData', 'id', id)\n            const localVarPath = `/api/images/{id}.image.jpg`\n                .replace(`{${\"id\"}}`, encodeURIComponent(String(id)));\n            // use dummy base URL string because the URL constructor only accepts absolute URLs.\n            const localVarUrlObj = new URL(localVarPath, DUMMY_BASE_URL);\n            let baseOptions;\n            if (configuration) {\n                baseOptions = configuration.baseOptions;\n            }\n\n            const localVarRequestOptions = { method: 'GET', ...baseOptions, ...options};\n            const localVarHeaderParameter = {} as any;\n            const localVarQueryParameter = {} as any;\n\n\n    \n            setSearchParams(localVarUrlObj, localVarQueryParameter, options.query);\n            let headersFromBaseOptions = baseOptions && baseOptions.headers ? baseOptions.headers : {};\n            localVarRequestOptions.headers = {...localVarHeaderParameter, ...headersFromBaseOptions, ...options.headers};\n\n            return {\n                url: toPathString(localVarUrlObj),\n                options: localVarRequestOptions,\n            };\n        },\n        /**\n         * Get the binary mask data\n         * @param {string} id \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        getMaskData: async (id: string, options: any = {}): Promise<RequestArgs> => {\n            // verify required parameter 'id' is not null or undefined\n            assertParamExists('getMaskData', 'id', id)\n            const localVarPath = `/api/images/{id}.mask.jpg`\n                .replace(`{${\"id\"}}`, encodeURIComponent(String(id)));\n            // use dummy base URL string because the URL constructor only accepts absolute URLs.\n            const localVarUrlObj = new URL(localVarPath, DUMMY_BASE_URL);\n            let baseOptions;\n            if (configuration) {\n                baseOptions = configuration.baseOptions;\n            }\n\n            const localVarRequestOptions = { method: 'GET', ...baseOptions, ...options};\n            const localVarHeaderParameter = {} as any;\n            const localVarQueryParameter = {} as any;\n\n\n    \n            setSearchParams(localVarUrlObj, localVarQueryParameter, options.query);\n            let headersFromBaseOptions = baseOptions && baseOptions.headers ? baseOptions.headers : {};\n            localVarRequestOptions.headers = {...localVarHeaderParameter, ...headersFromBaseOptions, ...options.headers};\n\n            return {\n                url: toPathString(localVarUrlObj),\n                options: localVarRequestOptions,\n            };\n        },\n        /**\n         * Get the binary image data\n         * @param {string} id \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        getNpyData: async (id: string, options: any = {}): Promise<RequestArgs> => {\n            // verify required parameter 'id' is not null or undefined\n            assertParamExists('getNpyData', 'id', id)\n            const localVarPath = `/api/images/{id}.npy`\n                .replace(`{${\"id\"}}`, encodeURIComponent(String(id)));\n            // use dummy base URL string because the URL constructor only accepts absolute URLs.\n            const localVarUrlObj = new URL(localVarPath, DUMMY_BASE_URL);\n            let baseOptions;\n            if (configuration) {\n                baseOptions = configuration.baseOptions;\n            }\n\n            const localVarRequestOptions = { method: 'GET', ...baseOptions, ...options};\n            const localVarHeaderParameter = {} as any;\n            const localVarQueryParameter = {} as any;\n\n\n    \n            setSearchParams(localVarUrlObj, localVarQueryParameter, options.query);\n            let headersFromBaseOptions = baseOptions && baseOptions.headers ? baseOptions.headers : {};\n            localVarRequestOptions.headers = {...localVarHeaderParameter, ...headersFromBaseOptions, ...options.headers};\n\n            return {\n                url: toPathString(localVarUrlObj),\n                options: localVarRequestOptions,\n            };\n        },\n        /**\n         * Get the binary thumbnail data\n         * @param {string} id \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        getThumbnailData: async (id: string, options: any = {}): Promise<RequestArgs> => {\n            // verify required parameter 'id' is not null or undefined\n            assertParamExists('getThumbnailData', 'id', id)\n            const localVarPath = `/api/images/{id}.thumbnail.jpg`\n                .replace(`{${\"id\"}}`, encodeURIComponent(String(id)));\n            // use dummy base URL string because the URL constructor only accepts absolute URLs.\n            const localVarUrlObj = new URL(localVarPath, DUMMY_BASE_URL);\n            let baseOptions;\n            if (configuration) {\n                baseOptions = configuration.baseOptions;\n            }\n\n            const localVarRequestOptions = { method: 'GET', ...baseOptions, ...options};\n            const localVarHeaderParameter = {} as any;\n            const localVarQueryParameter = {} as any;\n\n\n    \n            setSearchParams(localVarUrlObj, localVarQueryParameter, options.query);\n            let headersFromBaseOptions = baseOptions && baseOptions.headers ? baseOptions.headers : {};\n            localVarRequestOptions.headers = {...localVarHeaderParameter, ...headersFromBaseOptions, ...options.headers};\n\n            return {\n                url: toPathString(localVarUrlObj),\n                options: localVarRequestOptions,\n            };\n        },\n        /**\n         * Get the binary video data\n         * @param {string} id \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        getVideoData: async (id: string, options: any = {}): Promise<RequestArgs> => {\n            // verify required parameter 'id' is not null or undefined\n            assertParamExists('getVideoData', 'id', id)\n            const localVarPath = `/api/images/{id}.mp4`\n                .replace(`{${\"id\"}}`, encodeURIComponent(String(id)));\n            // use dummy base URL string because the URL constructor only accepts absolute URLs.\n            const localVarUrlObj = new URL(localVarPath, DUMMY_BASE_URL);\n            let baseOptions;\n            if (configuration) {\n                baseOptions = configuration.baseOptions;\n            }\n\n            const localVarRequestOptions = { method: 'GET', ...baseOptions, ...options};\n            const localVarHeaderParameter = {} as any;\n            const localVarQueryParameter = {} as any;\n\n\n    \n            setSearchParams(localVarUrlObj, localVarQueryParameter, options.query);\n            let headersFromBaseOptions = baseOptions && baseOptions.headers ? baseOptions.headers : {};\n            localVarRequestOptions.headers = {...localVarHeaderParameter, ...headersFromBaseOptions, ...options.headers};\n\n            return {\n                url: toPathString(localVarUrlObj),\n                options: localVarRequestOptions,\n            };\n        },\n        /**\n         * Get a worker\n         * @param {string} workerId \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        getWorker: async (workerId: string, options: any = {}): Promise<RequestArgs> => {\n            // verify required parameter 'workerId' is not null or undefined\n            assertParamExists('getWorker', 'workerId', workerId)\n            const localVarPath = `/api/workers/{worker_id}`\n                .replace(`{${\"worker_id\"}}`, encodeURIComponent(String(workerId)));\n            // use dummy base URL string because the URL constructor only accepts absolute URLs.\n            const localVarUrlObj = new URL(localVarPath, DUMMY_BASE_URL);\n            let baseOptions;\n            if (configuration) {\n                baseOptions = configuration.baseOptions;\n            }\n\n            const localVarRequestOptions = { method: 'GET', ...baseOptions, ...options};\n            const localVarHeaderParameter = {} as any;\n            const localVarQueryParameter = {} as any;\n\n\n    \n            setSearchParams(localVarUrlObj, localVarQueryParameter, options.query);\n            let headersFromBaseOptions = baseOptions && baseOptions.headers ? baseOptions.headers : {};\n            localVarRequestOptions.headers = {...localVarHeaderParameter, ...headersFromBaseOptions, ...options.headers};\n\n            return {\n                url: toPathString(localVarUrlObj),\n                options: localVarRequestOptions,\n            };\n        },\n        /**\n         * Get a worker config\n         * @param {string} workerId \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        getWorkerConfig: async (workerId: string, options: any = {}): Promise<RequestArgs> => {\n            // verify required parameter 'workerId' is not null or undefined\n            assertParamExists('getWorkerConfig', 'workerId', workerId)\n            const localVarPath = `/api/workers/{worker_id}/config`\n                .replace(`{${\"worker_id\"}}`, encodeURIComponent(String(workerId)));\n            // use dummy base URL string because the URL constructor only accepts absolute URLs.\n            const localVarUrlObj = new URL(localVarPath, DUMMY_BASE_URL);\n            let baseOptions;\n            if (configuration) {\n                baseOptions = configuration.baseOptions;\n            }\n\n            const localVarRequestOptions = { method: 'GET', ...baseOptions, ...options};\n            const localVarHeaderParameter = {} as any;\n            const localVarQueryParameter = {} as any;\n\n\n    \n            setSearchParams(localVarUrlObj, localVarQueryParameter, options.query);\n            let headersFromBaseOptions = baseOptions && baseOptions.headers ? baseOptions.headers : {};\n            localVarRequestOptions.headers = {...localVarHeaderParameter, ...headersFromBaseOptions, ...options.headers};\n\n            return {\n                url: toPathString(localVarUrlObj),\n                options: localVarRequestOptions,\n            };\n        },\n        /**\n         * Get the list of workers\n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        getWorkers: async (options: any = {}): Promise<RequestArgs> => {\n            const localVarPath = `/api/workers`;\n            // use dummy base URL string because the URL constructor only accepts absolute URLs.\n            const localVarUrlObj = new URL(localVarPath, DUMMY_BASE_URL);\n            let baseOptions;\n            if (configuration) {\n                baseOptions = configuration.baseOptions;\n            }\n\n            const localVarRequestOptions = { method: 'GET', ...baseOptions, ...options};\n            const localVarHeaderParameter = {} as any;\n            const localVarQueryParameter = {} as any;\n\n\n    \n            setSearchParams(localVarUrlObj, localVarQueryParameter, options.query);\n            let headersFromBaseOptions = baseOptions && baseOptions.headers ? baseOptions.headers : {};\n            localVarRequestOptions.headers = {...localVarHeaderParameter, ...headersFromBaseOptions, ...options.headers};\n\n            return {\n                url: toPathString(localVarUrlObj),\n                options: localVarRequestOptions,\n            };\n        },\n        /**\n         * Healthcheck\n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        healthcheck: async (options: any = {}): Promise<RequestArgs> => {\n            const localVarPath = `/api/healthcheck`;\n            // use dummy base URL string because the URL constructor only accepts absolute URLs.\n            const localVarUrlObj = new URL(localVarPath, DUMMY_BASE_URL);\n            let baseOptions;\n            if (configuration) {\n                baseOptions = configuration.baseOptions;\n            }\n\n            const localVarRequestOptions = { method: 'GET', ...baseOptions, ...options};\n            const localVarHeaderParameter = {} as any;\n            const localVarQueryParameter = {} as any;\n\n\n    \n            setSearchParams(localVarUrlObj, localVarQueryParameter, options.query);\n            let headersFromBaseOptions = baseOptions && baseOptions.headers ? baseOptions.headers : {};\n            localVarRequestOptions.headers = {...localVarHeaderParameter, ...headersFromBaseOptions, ...options.headers};\n\n            return {\n                url: toPathString(localVarUrlObj),\n                options: localVarRequestOptions,\n            };\n        },\n        /**\n         * Check if the user is admin\n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        isAdmin: async (options: any = {}): Promise<RequestArgs> => {\n            const localVarPath = `/api/is-admin`;\n            // use dummy base URL string because the URL constructor only accepts absolute URLs.\n            const localVarUrlObj = new URL(localVarPath, DUMMY_BASE_URL);\n            let baseOptions;\n            if (configuration) {\n                baseOptions = configuration.baseOptions;\n            }\n\n            const localVarRequestOptions = { method: 'GET', ...baseOptions, ...options};\n            const localVarHeaderParameter = {} as any;\n            const localVarQueryParameter = {} as any;\n\n\n    \n            setSearchParams(localVarUrlObj, localVarQueryParameter, options.query);\n            let headersFromBaseOptions = baseOptions && baseOptions.headers ? baseOptions.headers : {};\n            localVarRequestOptions.headers = {...localVarHeaderParameter, ...headersFromBaseOptions, ...options.headers};\n\n            return {\n                url: toPathString(localVarUrlObj),\n                options: localVarRequestOptions,\n            };\n        },\n        /**\n         * Get a list of saved images\n         * @param {number} [cursor] \n         * @param {string} [filter] \n         * @param {number} [limit] \n         * @param {'asc' | 'desc'} [direction] \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        listImages: async (cursor?: number, filter?: string, limit?: number, direction?: 'asc' | 'desc', options: any = {}): Promise<RequestArgs> => {\n            const localVarPath = `/api/images`;\n            // use dummy base URL string because the URL constructor only accepts absolute URLs.\n            const localVarUrlObj = new URL(localVarPath, DUMMY_BASE_URL);\n            let baseOptions;\n            if (configuration) {\n                baseOptions = configuration.baseOptions;\n            }\n\n            const localVarRequestOptions = { method: 'GET', ...baseOptions, ...options};\n            const localVarHeaderParameter = {} as any;\n            const localVarQueryParameter = {} as any;\n\n            if (cursor !== undefined) {\n                localVarQueryParameter['cursor'] = cursor;\n            }\n\n            if (filter !== undefined) {\n                localVarQueryParameter['filter'] = filter;\n            }\n\n            if (limit !== undefined) {\n                localVarQueryParameter['limit'] = limit;\n            }\n\n            if (direction !== undefined) {\n                localVarQueryParameter['direction'] = direction;\n            }\n\n\n    \n            setSearchParams(localVarUrlObj, localVarQueryParameter, options.query);\n            let headersFromBaseOptions = baseOptions && baseOptions.headers ? baseOptions.headers : {};\n            localVarRequestOptions.headers = {...localVarHeaderParameter, ...headersFromBaseOptions, ...options.headers};\n\n            return {\n                url: toPathString(localVarUrlObj),\n                options: localVarRequestOptions,\n            };\n        },\n        /**\n         * Login by email\n         * @param {LoginInput} [loginInput] \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        login: async (loginInput?: LoginInput, options: any = {}): Promise<RequestArgs> => {\n            const localVarPath = `/api/auth/login`;\n            // use dummy base URL string because the URL constructor only accepts absolute URLs.\n            const localVarUrlObj = new URL(localVarPath, DUMMY_BASE_URL);\n            let baseOptions;\n            if (configuration) {\n                baseOptions = configuration.baseOptions;\n            }\n\n            const localVarRequestOptions = { method: 'POST', ...baseOptions, ...options};\n            const localVarHeaderParameter = {} as any;\n            const localVarQueryParameter = {} as any;\n\n\n    \n            localVarHeaderParameter['Content-Type'] = 'application/json';\n\n            setSearchParams(localVarUrlObj, localVarQueryParameter, options.query);\n            let headersFromBaseOptions = baseOptions && baseOptions.headers ? baseOptions.headers : {};\n            localVarRequestOptions.headers = {...localVarHeaderParameter, ...headersFromBaseOptions, ...options.headers};\n            localVarRequestOptions.data = serializeDataIfNeeded(loginInput, localVarRequestOptions, configuration)\n\n            return {\n                url: toPathString(localVarUrlObj),\n                options: localVarRequestOptions,\n            };\n        },\n        /**\n         * Log in as a worker\n         * @param {WorkerLoginCode} [workerLoginCode] \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        loginAsWorker: async (workerLoginCode?: WorkerLoginCode, options: any = {}): Promise<RequestArgs> => {\n            const localVarPath = `/api/worker-login`;\n            // use dummy base URL string because the URL constructor only accepts absolute URLs.\n            const localVarUrlObj = new URL(localVarPath, DUMMY_BASE_URL);\n            let baseOptions;\n            if (configuration) {\n                baseOptions = configuration.baseOptions;\n            }\n\n            const localVarRequestOptions = { method: 'POST', ...baseOptions, ...options};\n            const localVarHeaderParameter = {} as any;\n            const localVarQueryParameter = {} as any;\n\n\n    \n            localVarHeaderParameter['Content-Type'] = 'application/json';\n\n            setSearchParams(localVarUrlObj, localVarQueryParameter, options.query);\n            let headersFromBaseOptions = baseOptions && baseOptions.headers ? baseOptions.headers : {};\n            localVarRequestOptions.headers = {...localVarHeaderParameter, ...headersFromBaseOptions, ...options.headers};\n            localVarRequestOptions.data = serializeDataIfNeeded(workerLoginCode, localVarRequestOptions, configuration)\n\n            return {\n                url: toPathString(localVarUrlObj),\n                options: localVarRequestOptions,\n            };\n        },\n        /**\n         * Get the next pending image and set its status to processing.\n         * @param {ProcessImageInput} [processImageInput] \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        processImage: async (processImageInput?: ProcessImageInput, options: any = {}): Promise<RequestArgs> => {\n            const localVarPath = `/api/process-image`;\n            // use dummy base URL string because the URL constructor only accepts absolute URLs.\n            const localVarUrlObj = new URL(localVarPath, DUMMY_BASE_URL);\n            let baseOptions;\n            if (configuration) {\n                baseOptions = configuration.baseOptions;\n            }\n\n            const localVarRequestOptions = { method: 'PUT', ...baseOptions, ...options};\n            const localVarHeaderParameter = {} as any;\n            const localVarQueryParameter = {} as any;\n\n\n    \n            localVarHeaderParameter['Content-Type'] = 'application/json';\n\n            setSearchParams(localVarUrlObj, localVarQueryParameter, options.query);\n            let headersFromBaseOptions = baseOptions && baseOptions.headers ? baseOptions.headers : {};\n            localVarRequestOptions.headers = {...localVarHeaderParameter, ...headersFromBaseOptions, ...options.headers};\n            localVarRequestOptions.data = serializeDataIfNeeded(processImageInput, localVarRequestOptions, configuration)\n\n            return {\n                url: toPathString(localVarUrlObj),\n                options: localVarRequestOptions,\n            };\n        },\n        /**\n         * Refresh Login code\n         * @param {RefreshLoginInput} [refreshLoginInput] \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        refresh: async (refreshLoginInput?: RefreshLoginInput, options: any = {}): Promise<RequestArgs> => {\n            const localVarPath = `/api/auth/refresh`;\n            // use dummy base URL string because the URL constructor only accepts absolute URLs.\n            const localVarUrlObj = new URL(localVarPath, DUMMY_BASE_URL);\n            let baseOptions;\n            if (configuration) {\n                baseOptions = configuration.baseOptions;\n            }\n\n            const localVarRequestOptions = { method: 'POST', ...baseOptions, ...options};\n            const localVarHeaderParameter = {} as any;\n            const localVarQueryParameter = {} as any;\n\n\n    \n            localVarHeaderParameter['Content-Type'] = 'application/json';\n\n            setSearchParams(localVarUrlObj, localVarQueryParameter, options.query);\n            let headersFromBaseOptions = baseOptions && baseOptions.headers ? baseOptions.headers : {};\n            localVarRequestOptions.headers = {...localVarHeaderParameter, ...headersFromBaseOptions, ...options.headers};\n            localVarRequestOptions.data = serializeDataIfNeeded(refreshLoginInput, localVarRequestOptions, configuration)\n\n            return {\n                url: toPathString(localVarUrlObj),\n                options: localVarRequestOptions,\n            };\n        },\n        /**\n         * Update a saved image\n         * @param {string} id \n         * @param {UpdateImageInput} [updateImageInput] \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        updateImage: async (id: string, updateImageInput?: UpdateImageInput, options: any = {}): Promise<RequestArgs> => {\n            // verify required parameter 'id' is not null or undefined\n            assertParamExists('updateImage', 'id', id)\n            const localVarPath = `/api/images/{id}`\n                .replace(`{${\"id\"}}`, encodeURIComponent(String(id)));\n            // use dummy base URL string because the URL constructor only accepts absolute URLs.\n            const localVarUrlObj = new URL(localVarPath, DUMMY_BASE_URL);\n            let baseOptions;\n            if (configuration) {\n                baseOptions = configuration.baseOptions;\n            }\n\n            const localVarRequestOptions = { method: 'PATCH', ...baseOptions, ...options};\n            const localVarHeaderParameter = {} as any;\n            const localVarQueryParameter = {} as any;\n\n\n    \n            localVarHeaderParameter['Content-Type'] = 'application/json';\n\n            setSearchParams(localVarUrlObj, localVarQueryParameter, options.query);\n            let headersFromBaseOptions = baseOptions && baseOptions.headers ? baseOptions.headers : {};\n            localVarRequestOptions.headers = {...localVarHeaderParameter, ...headersFromBaseOptions, ...options.headers};\n            localVarRequestOptions.data = serializeDataIfNeeded(updateImageInput, localVarRequestOptions, configuration)\n\n            return {\n                url: toPathString(localVarUrlObj),\n                options: localVarRequestOptions,\n            };\n        },\n        /**\n         * Update the video data\n         * @param {string} id \n         * @param {any} [body] \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        updateVideoData: async (id: string, body?: any, options: any = {}): Promise<RequestArgs> => {\n            // verify required parameter 'id' is not null or undefined\n            assertParamExists('updateVideoData', 'id', id)\n            const localVarPath = `/api/images/{id}.mp4`\n                .replace(`{${\"id\"}}`, encodeURIComponent(String(id)));\n            // use dummy base URL string because the URL constructor only accepts absolute URLs.\n            const localVarUrlObj = new URL(localVarPath, DUMMY_BASE_URL);\n            let baseOptions;\n            if (configuration) {\n                baseOptions = configuration.baseOptions;\n            }\n\n            const localVarRequestOptions = { method: 'PUT', ...baseOptions, ...options};\n            const localVarHeaderParameter = {} as any;\n            const localVarQueryParameter = {} as any;\n\n\n    \n            localVarHeaderParameter['Content-Type'] = 'video/mp4';\n\n            setSearchParams(localVarUrlObj, localVarQueryParameter, options.query);\n            let headersFromBaseOptions = baseOptions && baseOptions.headers ? baseOptions.headers : {};\n            localVarRequestOptions.headers = {...localVarHeaderParameter, ...headersFromBaseOptions, ...options.headers};\n            localVarRequestOptions.data = serializeDataIfNeeded(body, localVarRequestOptions, configuration)\n\n            return {\n                url: toPathString(localVarUrlObj),\n                options: localVarRequestOptions,\n            };\n        },\n        /**\n         * Update a worker\n         * @param {string} workerId \n         * @param {UpsertWorkerInput} [upsertWorkerInput] \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        updateWorker: async (workerId: string, upsertWorkerInput?: UpsertWorkerInput, options: any = {}): Promise<RequestArgs> => {\n            // verify required parameter 'workerId' is not null or undefined\n            assertParamExists('updateWorker', 'workerId', workerId)\n            const localVarPath = `/api/workers/{worker_id}`\n                .replace(`{${\"worker_id\"}}`, encodeURIComponent(String(workerId)));\n            // use dummy base URL string because the URL constructor only accepts absolute URLs.\n            const localVarUrlObj = new URL(localVarPath, DUMMY_BASE_URL);\n            let baseOptions;\n            if (configuration) {\n                baseOptions = configuration.baseOptions;\n            }\n\n            const localVarRequestOptions = { method: 'PUT', ...baseOptions, ...options};\n            const localVarHeaderParameter = {} as any;\n            const localVarQueryParameter = {} as any;\n\n\n    \n            localVarHeaderParameter['Content-Type'] = 'application/json';\n\n            setSearchParams(localVarUrlObj, localVarQueryParameter, options.query);\n            let headersFromBaseOptions = baseOptions && baseOptions.headers ? baseOptions.headers : {};\n            localVarRequestOptions.headers = {...localVarHeaderParameter, ...headersFromBaseOptions, ...options.headers};\n            localVarRequestOptions.data = serializeDataIfNeeded(upsertWorkerInput, localVarRequestOptions, configuration)\n\n            return {\n                url: toPathString(localVarUrlObj),\n                options: localVarRequestOptions,\n            };\n        },\n        /**\n         * Update a worker config\n         * @param {string} workerId \n         * @param {UpsertWorkerConfigInput} [upsertWorkerConfigInput] \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        updateWorkerConfig: async (workerId: string, upsertWorkerConfigInput?: UpsertWorkerConfigInput, options: any = {}): Promise<RequestArgs> => {\n            // verify required parameter 'workerId' is not null or undefined\n            assertParamExists('updateWorkerConfig', 'workerId', workerId)\n            const localVarPath = `/api/workers/{worker_id}/config`\n                .replace(`{${\"worker_id\"}}`, encodeURIComponent(String(workerId)));\n            // use dummy base URL string because the URL constructor only accepts absolute URLs.\n            const localVarUrlObj = new URL(localVarPath, DUMMY_BASE_URL);\n            let baseOptions;\n            if (configuration) {\n                baseOptions = configuration.baseOptions;\n            }\n\n            const localVarRequestOptions = { method: 'PUT', ...baseOptions, ...options};\n            const localVarHeaderParameter = {} as any;\n            const localVarQueryParameter = {} as any;\n\n\n    \n            localVarHeaderParameter['Content-Type'] = 'application/json';\n\n            setSearchParams(localVarUrlObj, localVarQueryParameter, options.query);\n            let headersFromBaseOptions = baseOptions && baseOptions.headers ? baseOptions.headers : {};\n            localVarRequestOptions.headers = {...localVarHeaderParameter, ...headersFromBaseOptions, ...options.headers};\n            localVarRequestOptions.data = serializeDataIfNeeded(upsertWorkerConfigInput, localVarRequestOptions, configuration)\n\n            return {\n                url: toPathString(localVarUrlObj),\n                options: localVarRequestOptions,\n            };\n        },\n        /**\n         * Verify Login code\n         * @param {VerifyLoginInput} [verifyLoginInput] \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        verify: async (verifyLoginInput?: VerifyLoginInput, options: any = {}): Promise<RequestArgs> => {\n            const localVarPath = `/api/auth/verify`;\n            // use dummy base URL string because the URL constructor only accepts absolute URLs.\n            const localVarUrlObj = new URL(localVarPath, DUMMY_BASE_URL);\n            let baseOptions;\n            if (configuration) {\n                baseOptions = configuration.baseOptions;\n            }\n\n            const localVarRequestOptions = { method: 'POST', ...baseOptions, ...options};\n            const localVarHeaderParameter = {} as any;\n            const localVarQueryParameter = {} as any;\n\n\n    \n            localVarHeaderParameter['Content-Type'] = 'application/json';\n\n            setSearchParams(localVarUrlObj, localVarQueryParameter, options.query);\n            let headersFromBaseOptions = baseOptions && baseOptions.headers ? baseOptions.headers : {};\n            localVarRequestOptions.headers = {...localVarHeaderParameter, ...headersFromBaseOptions, ...options.headers};\n            localVarRequestOptions.data = serializeDataIfNeeded(verifyLoginInput, localVarRequestOptions, configuration)\n\n            return {\n                url: toPathString(localVarUrlObj),\n                options: localVarRequestOptions,\n            };\n        },\n    }\n};\n\n/**\n * AIBrushApi - functional programming interface\n * @export\n */\nexport const AIBrushApiFp = function(configuration?: Configuration) {\n    const localVarAxiosParamCreator = AIBrushApiAxiosParamCreator(configuration)\n    return {\n        /**\n         * Add Metrics\n         * @param {AddMetricsInput} [addMetricsInput] \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        async addMetrics(addMetricsInput?: AddMetricsInput, options?: any): Promise<(axios?: AxiosInstance, basePath?: string) => AxiosPromise<void>> {\n            const localVarAxiosArgs = await localVarAxiosParamCreator.addMetrics(addMetricsInput, options);\n            return createRequestFunction(localVarAxiosArgs, globalAxios, BASE_PATH, configuration);\n        },\n        /**\n         * Create a new image\n         * @param {CreateImageInput} [createImageInput] \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        async createImage(createImageInput?: CreateImageInput, options?: any): Promise<(axios?: AxiosInstance, basePath?: string) => AxiosPromise<ImageList>> {\n            const localVarAxiosArgs = await localVarAxiosParamCreator.createImage(createImageInput, options);\n            return createRequestFunction(localVarAxiosArgs, globalAxios, BASE_PATH, configuration);\n        },\n        /**\n         * Create a new invite code\n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        async createInviteCode(options?: any): Promise<(axios?: AxiosInstance, basePath?: string) => AxiosPromise<InviteCode>> {\n            const localVarAxiosArgs = await localVarAxiosParamCreator.createInviteCode(options);\n            return createRequestFunction(localVarAxiosArgs, globalAxios, BASE_PATH, configuration);\n        },\n        /**\n         * Create a service account\n         * @param {CreateServiceAccountInput} [createServiceAccountInput] \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        async createServiceAccount(createServiceAccountInput?: CreateServiceAccountInput, options?: any): Promise<(axios?: AxiosInstance, basePath?: string) => AxiosPromise<LoginResult>> {\n            const localVarAxiosArgs = await localVarAxiosParamCreator.createServiceAccount(createServiceAccountInput, options);\n            return createRequestFunction(localVarAxiosArgs, globalAxios, BASE_PATH, configuration);\n        },\n        /**\n         * Create a new worker\n         * @param {UpsertWorkerInput} [upsertWorkerInput] \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        async createWorker(upsertWorkerInput?: UpsertWorkerInput, options?: any): Promise<(axios?: AxiosInstance, basePath?: string) => AxiosPromise<Worker>> {\n            const localVarAxiosArgs = await localVarAxiosParamCreator.createWorker(upsertWorkerInput, options);\n            return createRequestFunction(localVarAxiosArgs, globalAxios, BASE_PATH, configuration);\n        },\n        /**\n         * Delete a saved image\n         * @param {string} id \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        async deleteImage(id: string, options?: any): Promise<(axios?: AxiosInstance, basePath?: string) => AxiosPromise<void>> {\n            const localVarAxiosArgs = await localVarAxiosParamCreator.deleteImage(id, options);\n            return createRequestFunction(localVarAxiosArgs, globalAxios, BASE_PATH, configuration);\n        },\n        /**\n         * Delete a worker\n         * @param {string} workerId \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        async deleteWorker(workerId: string, options?: any): Promise<(axios?: AxiosInstance, basePath?: string) => AxiosPromise<void>> {\n            const localVarAxiosArgs = await localVarAxiosParamCreator.deleteWorker(workerId, options);\n            return createRequestFunction(localVarAxiosArgs, globalAxios, BASE_PATH, configuration);\n        },\n        /**\n         * Generate a login code for a worker\n         * @param {string} workerId \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        async generateWorkerLoginCode(workerId: string, options?: any): Promise<(axios?: AxiosInstance, basePath?: string) => AxiosPromise<WorkerLoginCode>> {\n            const localVarAxiosArgs = await localVarAxiosParamCreator.generateWorkerLoginCode(workerId, options);\n            return createRequestFunction(localVarAxiosArgs, globalAxios, BASE_PATH, configuration);\n        },\n        /**\n         * Get the assets url\n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        async getAssetsUrl(options?: any): Promise<(axios?: AxiosInstance, basePath?: string) => AxiosPromise<AssetsUrl>> {\n            const localVarAxiosArgs = await localVarAxiosParamCreator.getAssetsUrl(options);\n            return createRequestFunction(localVarAxiosArgs, globalAxios, BASE_PATH, configuration);\n        },\n        /**\n         * Get the features\n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        async getFeatures(options?: any): Promise<(axios?: AxiosInstance, basePath?: string) => AxiosPromise<FeatureList>> {\n            const localVarAxiosArgs = await localVarAxiosParamCreator.getFeatures(options);\n            return createRequestFunction(localVarAxiosArgs, globalAxios, BASE_PATH, configuration);\n        },\n        /**\n         * Get a saved image by id\n         * @param {string} id \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        async getImage(id: string, options?: any): Promise<(axios?: AxiosInstance, basePath?: string) => AxiosPromise<Image>> {\n            const localVarAxiosArgs = await localVarAxiosParamCreator.getImage(id, options);\n            return createRequestFunction(localVarAxiosArgs, globalAxios, BASE_PATH, configuration);\n        },\n        /**\n         * Get the binary image data\n         * @param {string} id \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        async getImageData(id: string, options?: any): Promise<(axios?: AxiosInstance, basePath?: string) => AxiosPromise<any>> {\n            const localVarAxiosArgs = await localVarAxiosParamCreator.getImageData(id, options);\n            return createRequestFunction(localVarAxiosArgs, globalAxios, BASE_PATH, configuration);\n        },\n        /**\n         * Get the binary mask data\n         * @param {string} id \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        async getMaskData(id: string, options?: any): Promise<(axios?: AxiosInstance, basePath?: string) => AxiosPromise<any>> {\n            const localVarAxiosArgs = await localVarAxiosParamCreator.getMaskData(id, options);\n            return createRequestFunction(localVarAxiosArgs, globalAxios, BASE_PATH, configuration);\n        },\n        /**\n         * Get the binary image data\n         * @param {string} id \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        async getNpyData(id: string, options?: any): Promise<(axios?: AxiosInstance, basePath?: string) => AxiosPromise<any>> {\n            const localVarAxiosArgs = await localVarAxiosParamCreator.getNpyData(id, options);\n            return createRequestFunction(localVarAxiosArgs, globalAxios, BASE_PATH, configuration);\n        },\n        /**\n         * Get the binary thumbnail data\n         * @param {string} id \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        async getThumbnailData(id: string, options?: any): Promise<(axios?: AxiosInstance, basePath?: string) => AxiosPromise<any>> {\n            const localVarAxiosArgs = await localVarAxiosParamCreator.getThumbnailData(id, options);\n            return createRequestFunction(localVarAxiosArgs, globalAxios, BASE_PATH, configuration);\n        },\n        /**\n         * Get the binary video data\n         * @param {string} id \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        async getVideoData(id: string, options?: any): Promise<(axios?: AxiosInstance, basePath?: string) => AxiosPromise<any>> {\n            const localVarAxiosArgs = await localVarAxiosParamCreator.getVideoData(id, options);\n            return createRequestFunction(localVarAxiosArgs, globalAxios, BASE_PATH, configuration);\n        },\n        /**\n         * Get a worker\n         * @param {string} workerId \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        async getWorker(workerId: string, options?: any): Promise<(axios?: AxiosInstance, basePath?: string) => AxiosPromise<Worker>> {\n            const localVarAxiosArgs = await localVarAxiosParamCreator.getWorker(workerId, options);\n            return createRequestFunction(localVarAxiosArgs, globalAxios, BASE_PATH, configuration);\n        },\n        /**\n         * Get a worker config\n         * @param {string} workerId \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        async getWorkerConfig(workerId: string, options?: any): Promise<(axios?: AxiosInstance, basePath?: string) => AxiosPromise<WorkerConfig>> {\n            const localVarAxiosArgs = await localVarAxiosParamCreator.getWorkerConfig(workerId, options);\n            return createRequestFunction(localVarAxiosArgs, globalAxios, BASE_PATH, configuration);\n        },\n        /**\n         * Get the list of workers\n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        async getWorkers(options?: any): Promise<(axios?: AxiosInstance, basePath?: string) => AxiosPromise<WorkerList>> {\n            const localVarAxiosArgs = await localVarAxiosParamCreator.getWorkers(options);\n            return createRequestFunction(localVarAxiosArgs, globalAxios, BASE_PATH, configuration);\n        },\n        /**\n         * Healthcheck\n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        async healthcheck(options?: any): Promise<(axios?: AxiosInstance, basePath?: string) => AxiosPromise<Healthcheck>> {\n            const localVarAxiosArgs = await localVarAxiosParamCreator.healthcheck(options);\n            return createRequestFunction(localVarAxiosArgs, globalAxios, BASE_PATH, configuration);\n        },\n        /**\n         * Check if the user is admin\n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        async isAdmin(options?: any): Promise<(axios?: AxiosInstance, basePath?: string) => AxiosPromise<IsAdminResponse>> {\n            const localVarAxiosArgs = await localVarAxiosParamCreator.isAdmin(options);\n            return createRequestFunction(localVarAxiosArgs, globalAxios, BASE_PATH, configuration);\n        },\n        /**\n         * Get a list of saved images\n         * @param {number} [cursor] \n         * @param {string} [filter] \n         * @param {number} [limit] \n         * @param {'asc' | 'desc'} [direction] \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        async listImages(cursor?: number, filter?: string, limit?: number, direction?: 'asc' | 'desc', options?: any): Promise<(axios?: AxiosInstance, basePath?: string) => AxiosPromise<ImageList>> {\n            const localVarAxiosArgs = await localVarAxiosParamCreator.listImages(cursor, filter, limit, direction, options);\n            return createRequestFunction(localVarAxiosArgs, globalAxios, BASE_PATH, configuration);\n        },\n        /**\n         * Login by email\n         * @param {LoginInput} [loginInput] \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        async login(loginInput?: LoginInput, options?: any): Promise<(axios?: AxiosInstance, basePath?: string) => AxiosPromise<void>> {\n            const localVarAxiosArgs = await localVarAxiosParamCreator.login(loginInput, options);\n            return createRequestFunction(localVarAxiosArgs, globalAxios, BASE_PATH, configuration);\n        },\n        /**\n         * Log in as a worker\n         * @param {WorkerLoginCode} [workerLoginCode] \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        async loginAsWorker(workerLoginCode?: WorkerLoginCode, options?: any): Promise<(axios?: AxiosInstance, basePath?: string) => AxiosPromise<LoginResult>> {\n            const localVarAxiosArgs = await localVarAxiosParamCreator.loginAsWorker(workerLoginCode, options);\n            return createRequestFunction(localVarAxiosArgs, globalAxios, BASE_PATH, configuration);\n        },\n        /**\n         * Get the next pending image and set its status to processing.\n         * @param {ProcessImageInput} [processImageInput] \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        async processImage(processImageInput?: ProcessImageInput, options?: any): Promise<(axios?: AxiosInstance, basePath?: string) => AxiosPromise<Image>> {\n            const localVarAxiosArgs = await localVarAxiosParamCreator.processImage(processImageInput, options);\n            return createRequestFunction(localVarAxiosArgs, globalAxios, BASE_PATH, configuration);\n        },\n        /**\n         * Refresh Login code\n         * @param {RefreshLoginInput} [refreshLoginInput] \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        async refresh(refreshLoginInput?: RefreshLoginInput, options?: any): Promise<(axios?: AxiosInstance, basePath?: string) => AxiosPromise<LoginResult>> {\n            const localVarAxiosArgs = await localVarAxiosParamCreator.refresh(refreshLoginInput, options);\n            return createRequestFunction(localVarAxiosArgs, globalAxios, BASE_PATH, configuration);\n        },\n        /**\n         * Update a saved image\n         * @param {string} id \n         * @param {UpdateImageInput} [updateImageInput] \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        async updateImage(id: string, updateImageInput?: UpdateImageInput, options?: any): Promise<(axios?: AxiosInstance, basePath?: string) => AxiosPromise<Image>> {\n            const localVarAxiosArgs = await localVarAxiosParamCreator.updateImage(id, updateImageInput, options);\n            return createRequestFunction(localVarAxiosArgs, globalAxios, BASE_PATH, configuration);\n        },\n        /**\n         * Update the video data\n         * @param {string} id \n         * @param {any} [body] \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        async updateVideoData(id: string, body?: any, options?: any): Promise<(axios?: AxiosInstance, basePath?: string) => AxiosPromise<void>> {\n            const localVarAxiosArgs = await localVarAxiosParamCreator.updateVideoData(id, body, options);\n            return createRequestFunction(localVarAxiosArgs, globalAxios, BASE_PATH, configuration);\n        },\n        /**\n         * Update a worker\n         * @param {string} workerId \n         * @param {UpsertWorkerInput} [upsertWorkerInput] \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        async updateWorker(workerId: string, upsertWorkerInput?: UpsertWorkerInput, options?: any): Promise<(axios?: AxiosInstance, basePath?: string) => AxiosPromise<Worker>> {\n            const localVarAxiosArgs = await localVarAxiosParamCreator.updateWorker(workerId, upsertWorkerInput, options);\n            return createRequestFunction(localVarAxiosArgs, globalAxios, BASE_PATH, configuration);\n        },\n        /**\n         * Update a worker config\n         * @param {string} workerId \n         * @param {UpsertWorkerConfigInput} [upsertWorkerConfigInput] \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        async updateWorkerConfig(workerId: string, upsertWorkerConfigInput?: UpsertWorkerConfigInput, options?: any): Promise<(axios?: AxiosInstance, basePath?: string) => AxiosPromise<WorkerConfig>> {\n            const localVarAxiosArgs = await localVarAxiosParamCreator.updateWorkerConfig(workerId, upsertWorkerConfigInput, options);\n            return createRequestFunction(localVarAxiosArgs, globalAxios, BASE_PATH, configuration);\n        },\n        /**\n         * Verify Login code\n         * @param {VerifyLoginInput} [verifyLoginInput] \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        async verify(verifyLoginInput?: VerifyLoginInput, options?: any): Promise<(axios?: AxiosInstance, basePath?: string) => AxiosPromise<LoginResult>> {\n            const localVarAxiosArgs = await localVarAxiosParamCreator.verify(verifyLoginInput, options);\n            return createRequestFunction(localVarAxiosArgs, globalAxios, BASE_PATH, configuration);\n        },\n    }\n};\n\n/**\n * AIBrushApi - factory interface\n * @export\n */\nexport const AIBrushApiFactory = function (configuration?: Configuration, basePath?: string, axios?: AxiosInstance) {\n    const localVarFp = AIBrushApiFp(configuration)\n    return {\n        /**\n         * Add Metrics\n         * @param {AddMetricsInput} [addMetricsInput] \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        addMetrics(addMetricsInput?: AddMetricsInput, options?: any): AxiosPromise<void> {\n            return localVarFp.addMetrics(addMetricsInput, options).then((request) => request(axios, basePath));\n        },\n        /**\n         * Create a new image\n         * @param {CreateImageInput} [createImageInput] \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        createImage(createImageInput?: CreateImageInput, options?: any): AxiosPromise<ImageList> {\n            return localVarFp.createImage(createImageInput, options).then((request) => request(axios, basePath));\n        },\n        /**\n         * Create a new invite code\n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        createInviteCode(options?: any): AxiosPromise<InviteCode> {\n            return localVarFp.createInviteCode(options).then((request) => request(axios, basePath));\n        },\n        /**\n         * Create a service account\n         * @param {CreateServiceAccountInput} [createServiceAccountInput] \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        createServiceAccount(createServiceAccountInput?: CreateServiceAccountInput, options?: any): AxiosPromise<LoginResult> {\n            return localVarFp.createServiceAccount(createServiceAccountInput, options).then((request) => request(axios, basePath));\n        },\n        /**\n         * Create a new worker\n         * @param {UpsertWorkerInput} [upsertWorkerInput] \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        createWorker(upsertWorkerInput?: UpsertWorkerInput, options?: any): AxiosPromise<Worker> {\n            return localVarFp.createWorker(upsertWorkerInput, options).then((request) => request(axios, basePath));\n        },\n        /**\n         * Delete a saved image\n         * @param {string} id \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        deleteImage(id: string, options?: any): AxiosPromise<void> {\n            return localVarFp.deleteImage(id, options).then((request) => request(axios, basePath));\n        },\n        /**\n         * Delete a worker\n         * @param {string} workerId \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        deleteWorker(workerId: string, options?: any): AxiosPromise<void> {\n            return localVarFp.deleteWorker(workerId, options).then((request) => request(axios, basePath));\n        },\n        /**\n         * Generate a login code for a worker\n         * @param {string} workerId \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        generateWorkerLoginCode(workerId: string, options?: any): AxiosPromise<WorkerLoginCode> {\n            return localVarFp.generateWorkerLoginCode(workerId, options).then((request) => request(axios, basePath));\n        },\n        /**\n         * Get the assets url\n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        getAssetsUrl(options?: any): AxiosPromise<AssetsUrl> {\n            return localVarFp.getAssetsUrl(options).then((request) => request(axios, basePath));\n        },\n        /**\n         * Get the features\n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        getFeatures(options?: any): AxiosPromise<FeatureList> {\n            return localVarFp.getFeatures(options).then((request) => request(axios, basePath));\n        },\n        /**\n         * Get a saved image by id\n         * @param {string} id \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        getImage(id: string, options?: any): AxiosPromise<Image> {\n            return localVarFp.getImage(id, options).then((request) => request(axios, basePath));\n        },\n        /**\n         * Get the binary image data\n         * @param {string} id \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        getImageData(id: string, options?: any): AxiosPromise<any> {\n            return localVarFp.getImageData(id, options).then((request) => request(axios, basePath));\n        },\n        /**\n         * Get the binary mask data\n         * @param {string} id \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        getMaskData(id: string, options?: any): AxiosPromise<any> {\n            return localVarFp.getMaskData(id, options).then((request) => request(axios, basePath));\n        },\n        /**\n         * Get the binary image data\n         * @param {string} id \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        getNpyData(id: string, options?: any): AxiosPromise<any> {\n            return localVarFp.getNpyData(id, options).then((request) => request(axios, basePath));\n        },\n        /**\n         * Get the binary thumbnail data\n         * @param {string} id \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        getThumbnailData(id: string, options?: any): AxiosPromise<any> {\n            return localVarFp.getThumbnailData(id, options).then((request) => request(axios, basePath));\n        },\n        /**\n         * Get the binary video data\n         * @param {string} id \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        getVideoData(id: string, options?: any): AxiosPromise<any> {\n            return localVarFp.getVideoData(id, options).then((request) => request(axios, basePath));\n        },\n        /**\n         * Get a worker\n         * @param {string} workerId \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        getWorker(workerId: string, options?: any): AxiosPromise<Worker> {\n            return localVarFp.getWorker(workerId, options).then((request) => request(axios, basePath));\n        },\n        /**\n         * Get a worker config\n         * @param {string} workerId \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        getWorkerConfig(workerId: string, options?: any): AxiosPromise<WorkerConfig> {\n            return localVarFp.getWorkerConfig(workerId, options).then((request) => request(axios, basePath));\n        },\n        /**\n         * Get the list of workers\n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        getWorkers(options?: any): AxiosPromise<WorkerList> {\n            return localVarFp.getWorkers(options).then((request) => request(axios, basePath));\n        },\n        /**\n         * Healthcheck\n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        healthcheck(options?: any): AxiosPromise<Healthcheck> {\n            return localVarFp.healthcheck(options).then((request) => request(axios, basePath));\n        },\n        /**\n         * Check if the user is admin\n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        isAdmin(options?: any): AxiosPromise<IsAdminResponse> {\n            return localVarFp.isAdmin(options).then((request) => request(axios, basePath));\n        },\n        /**\n         * Get a list of saved images\n         * @param {number} [cursor] \n         * @param {string} [filter] \n         * @param {number} [limit] \n         * @param {'asc' | 'desc'} [direction] \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        listImages(cursor?: number, filter?: string, limit?: number, direction?: 'asc' | 'desc', options?: any): AxiosPromise<ImageList> {\n            return localVarFp.listImages(cursor, filter, limit, direction, options).then((request) => request(axios, basePath));\n        },\n        /**\n         * Login by email\n         * @param {LoginInput} [loginInput] \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        login(loginInput?: LoginInput, options?: any): AxiosPromise<void> {\n            return localVarFp.login(loginInput, options).then((request) => request(axios, basePath));\n        },\n        /**\n         * Log in as a worker\n         * @param {WorkerLoginCode} [workerLoginCode] \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        loginAsWorker(workerLoginCode?: WorkerLoginCode, options?: any): AxiosPromise<LoginResult> {\n            return localVarFp.loginAsWorker(workerLoginCode, options).then((request) => request(axios, basePath));\n        },\n        /**\n         * Get the next pending image and set its status to processing.\n         * @param {ProcessImageInput} [processImageInput] \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        processImage(processImageInput?: ProcessImageInput, options?: any): AxiosPromise<Image> {\n            return localVarFp.processImage(processImageInput, options).then((request) => request(axios, basePath));\n        },\n        /**\n         * Refresh Login code\n         * @param {RefreshLoginInput} [refreshLoginInput] \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        refresh(refreshLoginInput?: RefreshLoginInput, options?: any): AxiosPromise<LoginResult> {\n            return localVarFp.refresh(refreshLoginInput, options).then((request) => request(axios, basePath));\n        },\n        /**\n         * Update a saved image\n         * @param {string} id \n         * @param {UpdateImageInput} [updateImageInput] \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        updateImage(id: string, updateImageInput?: UpdateImageInput, options?: any): AxiosPromise<Image> {\n            return localVarFp.updateImage(id, updateImageInput, options).then((request) => request(axios, basePath));\n        },\n        /**\n         * Update the video data\n         * @param {string} id \n         * @param {any} [body] \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        updateVideoData(id: string, body?: any, options?: any): AxiosPromise<void> {\n            return localVarFp.updateVideoData(id, body, options).then((request) => request(axios, basePath));\n        },\n        /**\n         * Update a worker\n         * @param {string} workerId \n         * @param {UpsertWorkerInput} [upsertWorkerInput] \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        updateWorker(workerId: string, upsertWorkerInput?: UpsertWorkerInput, options?: any): AxiosPromise<Worker> {\n            return localVarFp.updateWorker(workerId, upsertWorkerInput, options).then((request) => request(axios, basePath));\n        },\n        /**\n         * Update a worker config\n         * @param {string} workerId \n         * @param {UpsertWorkerConfigInput} [upsertWorkerConfigInput] \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        updateWorkerConfig(workerId: string, upsertWorkerConfigInput?: UpsertWorkerConfigInput, options?: any): AxiosPromise<WorkerConfig> {\n            return localVarFp.updateWorkerConfig(workerId, upsertWorkerConfigInput, options).then((request) => request(axios, basePath));\n        },\n        /**\n         * Verify Login code\n         * @param {VerifyLoginInput} [verifyLoginInput] \n         * @param {*} [options] Override http request option.\n         * @throws {RequiredError}\n         */\n        verify(verifyLoginInput?: VerifyLoginInput, options?: any): AxiosPromise<LoginResult> {\n            return localVarFp.verify(verifyLoginInput, options).then((request) => request(axios, basePath));\n        },\n    };\n};\n\n/**\n * AIBrushApi - object-oriented interface\n * @export\n * @class AIBrushApi\n * @extends {BaseAPI}\n */\nexport class AIBrushApi extends BaseAPI {\n    /**\n     * Add Metrics\n     * @param {AddMetricsInput} [addMetricsInput] \n     * @param {*} [options] Override http request option.\n     * @throws {RequiredError}\n     * @memberof AIBrushApi\n     */\n    public addMetrics(addMetricsInput?: AddMetricsInput, options?: any) {\n        return AIBrushApiFp(this.configuration).addMetrics(addMetricsInput, options).then((request) => request(this.axios, this.basePath));\n    }\n\n    /**\n     * Create a new image\n     * @param {CreateImageInput} [createImageInput] \n     * @param {*} [options] Override http request option.\n     * @throws {RequiredError}\n     * @memberof AIBrushApi\n     */\n    public createImage(createImageInput?: CreateImageInput, options?: any) {\n        return AIBrushApiFp(this.configuration).createImage(createImageInput, options).then((request) => request(this.axios, this.basePath));\n    }\n\n    /**\n     * Create a new invite code\n     * @param {*} [options] Override http request option.\n     * @throws {RequiredError}\n     * @memberof AIBrushApi\n     */\n    public createInviteCode(options?: any) {\n        return AIBrushApiFp(this.configuration).createInviteCode(options).then((request) => request(this.axios, this.basePath));\n    }\n\n    /**\n     * Create a service account\n     * @param {CreateServiceAccountInput} [createServiceAccountInput] \n     * @param {*} [options] Override http request option.\n     * @throws {RequiredError}\n     * @memberof AIBrushApi\n     */\n    public createServiceAccount(createServiceAccountInput?: CreateServiceAccountInput, options?: any) {\n        return AIBrushApiFp(this.configuration).createServiceAccount(createServiceAccountInput, options).then((request) => request(this.axios, this.basePath));\n    }\n\n    /**\n     * Create a new worker\n     * @param {UpsertWorkerInput} [upsertWorkerInput] \n     * @param {*} [options] Override http request option.\n     * @throws {RequiredError}\n     * @memberof AIBrushApi\n     */\n    public createWorker(upsertWorkerInput?: UpsertWorkerInput, options?: any) {\n        return AIBrushApiFp(this.configuration).createWorker(upsertWorkerInput, options).then((request) => request(this.axios, this.basePath));\n    }\n\n    /**\n     * Delete a saved image\n     * @param {string} id \n     * @param {*} [options] Override http request option.\n     * @throws {RequiredError}\n     * @memberof AIBrushApi\n     */\n    public deleteImage(id: string, options?: any) {\n        return AIBrushApiFp(this.configuration).deleteImage(id, options).then((request) => request(this.axios, this.basePath));\n    }\n\n    /**\n     * Delete a worker\n     * @param {string} workerId \n     * @param {*} [options] Override http request option.\n     * @throws {RequiredError}\n     * @memberof AIBrushApi\n     */\n    public deleteWorker(workerId: string, options?: any) {\n        return AIBrushApiFp(this.configuration).deleteWorker(workerId, options).then((request) => request(this.axios, this.basePath));\n    }\n\n    /**\n     * Generate a login code for a worker\n     * @param {string} workerId \n     * @param {*} [options] Override http request option.\n     * @throws {RequiredError}\n     * @memberof AIBrushApi\n     */\n    public generateWorkerLoginCode(workerId: string, options?: any) {\n        return AIBrushApiFp(this.configuration).generateWorkerLoginCode(workerId, options).then((request) => request(this.axios, this.basePath));\n    }\n\n    /**\n     * Get the assets url\n     * @param {*} [options] Override http request option.\n     * @throws {RequiredError}\n     * @memberof AIBrushApi\n     */\n    public getAssetsUrl(options?: any) {\n        return AIBrushApiFp(this.configuration).getAssetsUrl(options).then((request) => request(this.axios, this.basePath));\n    }\n\n    /**\n     * Get the features\n     * @param {*} [options] Override http request option.\n     * @throws {RequiredError}\n     * @memberof AIBrushApi\n     */\n    public getFeatures(options?: any) {\n        return AIBrushApiFp(this.configuration).getFeatures(options).then((request) => request(this.axios, this.basePath));\n    }\n\n    /**\n     * Get a saved image by id\n     * @param {string} id \n     * @param {*} [options] Override http request option.\n     * @throws {RequiredError}\n     * @memberof AIBrushApi\n     */\n    public getImage(id: string, options?: any) {\n        return AIBrushApiFp(this.configuration).getImage(id, options).then((request) => request(this.axios, this.basePath));\n    }\n\n    /**\n     * Get the binary image data\n     * @param {string} id \n     * @param {*} [options] Override http request option.\n     * @throws {RequiredError}\n     * @memberof AIBrushApi\n     */\n    public getImageData(id: string, options?: any) {\n        return AIBrushApiFp(this.configuration).getImageData(id, options).then((request) => request(this.axios, this.basePath));\n    }\n\n    /**\n     * Get the binary mask data\n     * @param {string} id \n     * @param {*} [options] Override http request option.\n     * @throws {RequiredError}\n     * @memberof AIBrushApi\n     */\n    public getMaskData(id: string, options?: any) {\n        return AIBrushApiFp(this.configuration).getMaskData(id, options).then((request) => request(this.axios, this.basePath));\n    }\n\n    /**\n     * Get the binary image data\n     * @param {string} id \n     * @param {*} [options] Override http request option.\n     * @throws {RequiredError}\n     * @memberof AIBrushApi\n     */\n    public getNpyData(id: string, options?: any) {\n        return AIBrushApiFp(this.configuration).getNpyData(id, options).then((request) => request(this.axios, this.basePath));\n    }\n\n    /**\n     * Get the binary thumbnail data\n     * @param {string} id \n     * @param {*} [options] Override http request option.\n     * @throws {RequiredError}\n     * @memberof AIBrushApi\n     */\n    public getThumbnailData(id: string, options?: any) {\n        return AIBrushApiFp(this.configuration).getThumbnailData(id, options).then((request) => request(this.axios, this.basePath));\n    }\n\n    /**\n     * Get the binary video data\n     * @param {string} id \n     * @param {*} [options] Override http request option.\n     * @throws {RequiredError}\n     * @memberof AIBrushApi\n     */\n    public getVideoData(id: string, options?: any) {\n        return AIBrushApiFp(this.configuration).getVideoData(id, options).then((request) => request(this.axios, this.basePath));\n    }\n\n    /**\n     * Get a worker\n     * @param {string} workerId \n     * @param {*} [options] Override http request option.\n     * @throws {RequiredError}\n     * @memberof AIBrushApi\n     */\n    public getWorker(workerId: string, options?: any) {\n        return AIBrushApiFp(this.configuration).getWorker(workerId, options).then((request) => request(this.axios, this.basePath));\n    }\n\n    /**\n     * Get a worker config\n     * @param {string} workerId \n     * @param {*} [options] Override http request option.\n     * @throws {RequiredError}\n     * @memberof AIBrushApi\n     */\n    public getWorkerConfig(workerId: string, options?: any) {\n        return AIBrushApiFp(this.configuration).getWorkerConfig(workerId, options).then((request) => request(this.axios, this.basePath));\n    }\n\n    /**\n     * Get the list of workers\n     * @param {*} [options] Override http request option.\n     * @throws {RequiredError}\n     * @memberof AIBrushApi\n     */\n    public getWorkers(options?: any) {\n        return AIBrushApiFp(this.configuration).getWorkers(options).then((request) => request(this.axios, this.basePath));\n    }\n\n    /**\n     * Healthcheck\n     * @param {*} [options] Override http request option.\n     * @throws {RequiredError}\n     * @memberof AIBrushApi\n     */\n    public healthcheck(options?: any) {\n        return AIBrushApiFp(this.configuration).healthcheck(options).then((request) => request(this.axios, this.basePath));\n    }\n\n    /**\n     * Check if the user is admin\n     * @param {*} [options] Override http request option.\n     * @throws {RequiredError}\n     * @memberof AIBrushApi\n     */\n    public isAdmin(options?: any) {\n        return AIBrushApiFp(this.configuration).isAdmin(options).then((request) => request(this.axios, this.basePath));\n    }\n\n    /**\n     * Get a list of saved images\n     * @param {number} [cursor] \n     * @param {string} [filter] \n     * @param {number} [limit] \n     * @param {'asc' | 'desc'} [direction] \n     * @param {*} [options] Override http request option.\n     * @throws {RequiredError}\n     * @memberof AIBrushApi\n     */\n    public listImages(cursor?: number, filter?: string, limit?: number, direction?: 'asc' | 'desc', options?: any) {\n        return AIBrushApiFp(this.configuration).listImages(cursor, filter, limit, direction, options).then((request) => request(this.axios, this.basePath));\n    }\n\n    /**\n     * Login by email\n     * @param {LoginInput} [loginInput] \n     * @param {*} [options] Override http request option.\n     * @throws {RequiredError}\n     * @memberof AIBrushApi\n     */\n    public login(loginInput?: LoginInput, options?: any) {\n        return AIBrushApiFp(this.configuration).login(loginInput, options).then((request) => request(this.axios, this.basePath));\n    }\n\n    /**\n     * Log in as a worker\n     * @param {WorkerLoginCode} [workerLoginCode] \n     * @param {*} [options] Override http request option.\n     * @throws {RequiredError}\n     * @memberof AIBrushApi\n     */\n    public loginAsWorker(workerLoginCode?: WorkerLoginCode, options?: any) {\n        return AIBrushApiFp(this.configuration).loginAsWorker(workerLoginCode, options).then((request) => request(this.axios, this.basePath));\n    }\n\n    /**\n     * Get the next pending image and set its status to processing.\n     * @param {ProcessImageInput} [processImageInput] \n     * @param {*} [options] Override http request option.\n     * @throws {RequiredError}\n     * @memberof AIBrushApi\n     */\n    public processImage(processImageInput?: ProcessImageInput, options?: any) {\n        return AIBrushApiFp(this.configuration).processImage(processImageInput, options).then((request) => request(this.axios, this.basePath));\n    }\n\n    /**\n     * Refresh Login code\n     * @param {RefreshLoginInput} [refreshLoginInput] \n     * @param {*} [options] Override http request option.\n     * @throws {RequiredError}\n     * @memberof AIBrushApi\n     */\n    public refresh(refreshLoginInput?: RefreshLoginInput, options?: any) {\n        return AIBrushApiFp(this.configuration).refresh(refreshLoginInput, options).then((request) => request(this.axios, this.basePath));\n    }\n\n    /**\n     * Update a saved image\n     * @param {string} id \n     * @param {UpdateImageInput} [updateImageInput] \n     * @param {*} [options] Override http request option.\n     * @throws {RequiredError}\n     * @memberof AIBrushApi\n     */\n    public updateImage(id: string, updateImageInput?: UpdateImageInput, options?: any) {\n        return AIBrushApiFp(this.configuration).updateImage(id, updateImageInput, options).then((request) => request(this.axios, this.basePath));\n    }\n\n    /**\n     * Update the video data\n     * @param {string} id \n     * @param {any} [body] \n     * @param {*} [options] Override http request option.\n     * @throws {RequiredError}\n     * @memberof AIBrushApi\n     */\n    public updateVideoData(id: string, body?: any, options?: any) {\n        return AIBrushApiFp(this.configuration).updateVideoData(id, body, options).then((request) => request(this.axios, this.basePath));\n    }\n\n    /**\n     * Update a worker\n     * @param {string} workerId \n     * @param {UpsertWorkerInput} [upsertWorkerInput] \n     * @param {*} [options] Override http request option.\n     * @throws {RequiredError}\n     * @memberof AIBrushApi\n     */\n    public updateWorker(workerId: string, upsertWorkerInput?: UpsertWorkerInput, options?: any) {\n        return AIBrushApiFp(this.configuration).updateWorker(workerId, upsertWorkerInput, options).then((request) => request(this.axios, this.basePath));\n    }\n\n    /**\n     * Update a worker config\n     * @param {string} workerId \n     * @param {UpsertWorkerConfigInput} [upsertWorkerConfigInput] \n     * @param {*} [options] Override http request option.\n     * @throws {RequiredError}\n     * @memberof AIBrushApi\n     */\n    public updateWorkerConfig(workerId: string, upsertWorkerConfigInput?: UpsertWorkerConfigInput, options?: any) {\n        return AIBrushApiFp(this.configuration).updateWorkerConfig(workerId, upsertWorkerConfigInput, options).then((request) => request(this.axios, this.basePath));\n    }\n\n    /**\n     * Verify Login code\n     * @param {VerifyLoginInput} [verifyLoginInput] \n     * @param {*} [options] Override http request option.\n     * @throws {RequiredError}\n     * @memberof AIBrushApi\n     */\n    public verify(verifyLoginInput?: VerifyLoginInput, options?: any) {\n        return AIBrushApiFp(this.configuration).verify(verifyLoginInput, options).then((request) => request(this.axios, this.basePath));\n    }\n}\n\n\n","/* tslint:disable */\n/* eslint-disable */\n/**\n * AIBrush API\n * Orchestration backend for AI Brush\n *\n * The version of the OpenAPI document: 1.0.0\n * Contact: wolfgangmeyers@gmail.com\n *\n * NOTE: This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).\n * https://openapi-generator.tech\n * Do not edit the class manually.\n */\n\n\nimport { Configuration } from \"./configuration\";\n// Some imports not used depending on template conditions\n// @ts-ignore\nimport globalAxios, { AxiosPromise, AxiosInstance } from 'axios';\n\nexport const BASE_PATH = \"https://aibrush.ngrok.io\".replace(/\\/+$/, \"\");\n\n/**\n *\n * @export\n */\nexport const COLLECTION_FORMATS = {\n    csv: \",\",\n    ssv: \" \",\n    tsv: \"\\t\",\n    pipes: \"|\",\n};\n\n/**\n *\n * @export\n * @interface RequestArgs\n */\nexport interface RequestArgs {\n    url: string;\n    options: any;\n}\n\n/**\n *\n * @export\n * @class BaseAPI\n */\nexport class BaseAPI {\n    protected configuration: Configuration | undefined;\n\n    constructor(configuration?: Configuration, protected basePath: string = BASE_PATH, protected axios: AxiosInstance = globalAxios) {\n        if (configuration) {\n            this.configuration = configuration;\n            this.basePath = configuration.basePath || this.basePath;\n        }\n    }\n};\n\n/**\n *\n * @export\n * @class RequiredError\n * @extends {Error}\n */\nexport class RequiredError extends Error {\n    name: \"RequiredError\" = \"RequiredError\";\n    constructor(public field: string, msg?: string) {\n        super(msg);\n    }\n}\n","/* tslint:disable */\n/* eslint-disable */\n/**\n * AIBrush API\n * Orchestration backend for AI Brush\n *\n * The version of the OpenAPI document: 1.0.0\n * Contact: wolfgangmeyers@gmail.com\n *\n * NOTE: This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).\n * https://openapi-generator.tech\n * Do not edit the class manually.\n */\n\n\nimport { Configuration } from \"./configuration\";\nimport { RequiredError,RequestArgs } from \"./base\";\nimport { AxiosInstance } from 'axios';\n\n/**\n *\n * @export\n */\nexport const DUMMY_BASE_URL = 'https://example.com'\n\n/**\n *\n * @throws {RequiredError}\n * @export\n */\nexport const assertParamExists = function (functionName: string, paramName: string, paramValue: unknown) {\n    if (paramValue === null || paramValue === undefined) {\n        throw new RequiredError(paramName, `Required parameter ${paramName} was null or undefined when calling ${functionName}.`);\n    }\n}\n\n/**\n *\n * @export\n */\nexport const setApiKeyToObject = async function (object: any, keyParamName: string, configuration?: Configuration) {\n    if (configuration && configuration.apiKey) {\n        const localVarApiKeyValue = typeof configuration.apiKey === 'function'\n            ? await configuration.apiKey(keyParamName)\n            : await configuration.apiKey;\n        object[keyParamName] = localVarApiKeyValue;\n    }\n}\n\n/**\n *\n * @export\n */\nexport const setBasicAuthToObject = function (object: any, configuration?: Configuration) {\n    if (configuration && (configuration.username || configuration.password)) {\n        object[\"auth\"] = { username: configuration.username, password: configuration.password };\n    }\n}\n\n/**\n *\n * @export\n */\nexport const setBearerAuthToObject = async function (object: any, configuration?: Configuration) {\n    if (configuration && configuration.accessToken) {\n        const accessToken = typeof configuration.accessToken === 'function'\n            ? await configuration.accessToken()\n            : await configuration.accessToken;\n        object[\"Authorization\"] = \"Bearer \" + accessToken;\n    }\n}\n\n/**\n *\n * @export\n */\nexport const setOAuthToObject = async function (object: any, name: string, scopes: string[], configuration?: Configuration) {\n    if (configuration && configuration.accessToken) {\n        const localVarAccessTokenValue = typeof configuration.accessToken === 'function'\n            ? await configuration.accessToken(name, scopes)\n            : await configuration.accessToken;\n        object[\"Authorization\"] = \"Bearer \" + localVarAccessTokenValue;\n    }\n}\n\n/**\n *\n * @export\n */\nexport const setSearchParams = function (url: URL, ...objects: any[]) {\n    const searchParams = new URLSearchParams(url.search);\n    for (const object of objects) {\n        for (const key in object) {\n            if (Array.isArray(object[key])) {\n                searchParams.delete(key);\n                for (const item of object[key]) {\n                    searchParams.append(key, item);\n                }\n            } else {\n                searchParams.set(key, object[key]);\n            }\n        }\n    }\n    url.search = searchParams.toString();\n}\n\n/**\n *\n * @export\n */\nexport const serializeDataIfNeeded = function (value: any, requestOptions: any, configuration?: Configuration) {\n    const nonString = typeof value !== 'string';\n    const needsSerialization = nonString && configuration && configuration.isJsonMime\n        ? configuration.isJsonMime(requestOptions.headers['Content-Type'])\n        : nonString;\n    return needsSerialization\n        ? JSON.stringify(value !== undefined ? value : {})\n        : (value || \"\");\n}\n\n/**\n *\n * @export\n */\nexport const toPathString = function (url: URL) {\n    return url.pathname + url.search + url.hash\n}\n\n/**\n *\n * @export\n */\nexport const createRequestFunction = function (axiosArgs: RequestArgs, globalAxios: AxiosInstance, BASE_PATH: string, configuration?: Configuration) {\n    return (axios: AxiosInstance = globalAxios, basePath: string = BASE_PATH) => {\n        const axiosRequestArgs = {...axiosArgs.options, url: (configuration?.basePath || basePath) + axiosArgs.url};\n        return axios.request(axiosRequestArgs);\n    };\n}\n","import React, { useState, useEffect, useRef } from \"react\";\nimport { useParams, useHistory } from \"react-router-dom\";\nimport loadImage from \"blueimp-load-image\";\n\nimport { AIBrushApi, Image as APIImage } from \"../../client\";\nimport { getUpscaleLevel } from \"../../lib/upscale\";\nimport \"./ImageEditor.css\";\nimport { createRenderer, Renderer } from \"./renderer\";\nimport { Tool, BaseTool } from \"./tool\";\nimport { SelectionTool, Controls as SelectionControls } from \"./selection-tool\";\nimport { EnhanceTool, EnhanceControls } from \"./enhance-tool\";\nimport { PencilTool, Controls as PencilControls } from \"./pencil-tool\";\nimport { SmudgeTool, SmudgeControls } from \"./smudge-tool\";\nimport { ImportExportControls } from \"./import-export\";\n\ninterface CanPreventDefault {\n    preventDefault: () => void;\n}\n\ninterface Props {\n    api: AIBrushApi;\n    assetsUrl: string;\n}\n\ninterface ToolConfig {\n    name: string;\n    iconClass: string;\n    constructor: (r: Renderer) => Tool;\n    renderControls: (t: Tool, renderer: Renderer) => JSX.Element;\n    defaultArgs: any;\n}\n\nexport const ImageEditor: React.FC<Props> = ({ api }) => {\n    const [showSelectionControls, setShowSelectionControls] = useState(false);\n    const tools: Array<ToolConfig> = [\n        {\n            name: \"select\",\n            iconClass: \"far fa-square\",\n            constructor: (r: Renderer) => new SelectionTool(r),\n            renderControls: (t: Tool, renderer: Renderer) => {\n                return <SelectionControls tool={t} renderer={renderer} />;\n            },\n            defaultArgs: {\n                selectionWidth: 512,\n                selectionHeight: 512,\n            },\n        },\n        {\n            name: \"enhance\",\n            iconClass: \"fas fa-magic\",\n            constructor: (r: Renderer) => new EnhanceTool(r),\n            defaultArgs: {\n                variationStrength: 0.75,\n            },\n            renderControls: (t: Tool, renderer: Renderer) => {\n                t.onShowSelectionControls(setShowSelectionControls);\n                return (\n                    <EnhanceControls\n                        tool={t as EnhanceTool}\n                        renderer={renderer}\n                        api={api}\n                        image={image!}\n                    />\n                );\n            },\n        },\n        {\n            name: \"pencil\",\n            iconClass: \"fas fa-pencil-alt\",\n            constructor: (r: Renderer) => new PencilTool(r),\n            defaultArgs: {},\n            renderControls: (t: Tool, renderer: Renderer) => {\n                return <PencilControls tool={t as PencilTool} renderer={renderer} />;\n            }\n        },\n        {\n            name: \"smudge\",\n            // finger icon\n            iconClass: \"fas fa-hand-pointer\",\n            constructor: (r: Renderer) => new SmudgeTool(r),\n            defaultArgs: {},\n            renderControls: (t: Tool, renderer: Renderer) => {\n                return <SmudgeControls tool={t as SmudgeTool} renderer={renderer} />;\n            },\n        },\n        {\n            name: \"import-export\",\n            iconClass: \"fas fa-file-import\",\n            constructor: (r: Renderer) => new BaseTool(\"import-export\"),\n            defaultArgs: {},\n            renderControls: (t: Tool, renderer: Renderer) => {\n                return <ImportExportControls renderer={renderer} tool={t as BaseTool} api={api} />;\n            }\n        }\n    ];\n\n    const [image, setImage] = useState<APIImage | null>(null);\n    const [renderer, setRenderer] = useState<Renderer | null>(null);\n    const [tool, setTool] = useState<Tool | null>(null);\n    const [canUndo, setCanUndo] = useState(false);\n    const [canRedo, setCanRedo] = useState(false);\n\n    const { id } = useParams<{ id: string }>();\n    const history = useHistory();\n\n    const canvasRef = useRef<HTMLCanvasElement>(null);\n\n    const onSelectTool = (toolconfig: ToolConfig) => {\n        if (renderer) {\n            if (tool) {\n                if (!tool.destroy()) {\n                    return;\n                }\n            }\n            const newTool = toolconfig.constructor(renderer);\n            setTool(newTool);\n            newTool.onSaveImage((encodedImage) => {\n                console.log(\"Saving image...\")\n                api.updateImage(id, {\n                    encoded_image: encodedImage,\n                });\n            });\n        }\n    };\n\n    useEffect(() => {\n        api.getImage(id).then((image) => {\n            setImage(image.data);\n            api.getImageData(id, {\n                responseType: \"arraybuffer\"\n            }).then((resp) => {\n                const binaryImageData = Buffer.from(resp.data, \"binary\");\n                const base64ImageData = binaryImageData.toString(\"base64\");\n                const src = `data:image/jpeg;base64,${base64ImageData}`;\n                const imageElement = new Image();\n                imageElement.src = src;\n                imageElement.onload = () => {\n                    if (!canvasRef.current) {\n                        console.error(\"Failed to get canvas\");\n                        return;\n                    }\n                    const renderer = createRenderer(canvasRef.current);\n                    renderer.setBaseImage(imageElement);\n                    setRenderer(renderer);\n                }\n            });\n        });\n    }, [id]);\n\n    useEffect(() => {\n        if (renderer) {\n            onSelectTool(tools[0]);\n            renderer.onSnapshot(() => {\n                setCanUndo(renderer.canUndo());\n                setCanRedo(renderer.canRedo());\n            });\n        }\n    }, [renderer]);\n\n    useEffect(() => {\n        if (canvasRef.current) {\n            const listener = (e: WheelEvent) => {\n                if (tool) {\n                    e.preventDefault();\n                    tool.onWheel(e);\n                }\n            };\n            canvasRef.current.addEventListener(\"wheel\", listener);\n            return () => {\n                canvasRef.current?.removeEventListener(\"wheel\", listener);\n            };\n        }\n    }, [tool, canvasRef.current]);\n\n    function renderTool(t: ToolConfig) {\n        let buttonClass = `btn btn-secondary light-button image-editor-tool-button`;\n        const isSelected = tool && tool.name == t.name;\n        if (isSelected) {\n            buttonClass = `btn btn-primary image-editor-tool-button`;\n        }\n        return (\n            <div className=\"form-group\" key={t.name}>\n                <button className={buttonClass} onClick={() => onSelectTool(t)}>\n                    <i className={t.iconClass}></i>\n                </button>\n                {/* capitalize tool name */}\n                <label>\n                    {t.name.charAt(0).toUpperCase() + t.name.slice(1)}\n                </label>\n                {isSelected && t.renderControls(tool!, renderer!)}\n            </div>\n        );\n    }\n\n    function preventDefault(e: CanPreventDefault): boolean {\n        e.preventDefault();\n        return true;\n    }\n\n    return (\n        <>\n            <div className=\"row\">\n                <div className=\"col-12\">\n                    <h1 style={{ fontSize: \"40px\", textAlign: \"left\" }}>\n                        <i\n                            style={{ cursor: \"pointer\" }}\n                            onClick={() => history.goBack()}\n                            className=\"fas fa-chevron-left\"\n                        ></i>\n                        &nbsp; AI Edit\n                    </h1>\n                </div>\n            </div>\n            <div className=\"row\" style={{marginTop: \"32px\"}}>\n                <div className=\"col-lg-3\">\n                    {renderer && <>{tools.map((tool) => renderTool(tool))}</>}\n                </div>\n                <div className=\"col-lg-9\">\n                    <div style={{ verticalAlign: \"middle\" }}>\n                        {showSelectionControls && (\n                            <>\n                                <div\n                                    style={{ float: \"left\", marginTop: \"45%\" }}\n                                >\n                                    <button\n                                        // center vertically\n\n                                        className=\"btn btn-secondary\"\n                                        onClick={() => tool!.select(\"left\")}\n                                    >\n                                        <i className=\"fas fa-chevron-left\"></i>\n                                    </button>\n                                </div>\n                                <div\n                                    style={{ float: \"right\", marginTop: \"45%\" }}\n                                >\n                                    <button\n                                        // center vertically\n\n                                        className=\"btn btn-secondary\"\n                                        onClick={() => tool!.select(\"right\")}\n                                    >\n                                        <i className=\"fas fa-chevron-right\"></i>\n                                    </button>\n                                </div>\n                            </>\n                        )}\n\n                        <canvas\n                            style={{cursor: \"none\"}}\n                            ref={canvasRef}\n                            className=\"image-editor-canvas\"\n                            onMouseDown={(e) => preventDefault(e) && tool && tool.onMouseDown(e)}\n                            onMouseMove={(e) => preventDefault(e) && tool && tool.onMouseMove(e)}\n                            onMouseUp={(e) => preventDefault(e) && tool && tool.onMouseUp(e)}\n                            onMouseLeave={(e) => preventDefault(e) && tool && tool.onMouseLeave(e)}\n                            // onWheel={e => tool && tool.onWheel(e)}\n                        />\n                    </div>\n                    <div className=\"row\">\n                        <button\n                            className=\"btn btn-primary\"\n                            style={{\n                                position: \"absolute\",\n                                left: \"10%\",\n                                transform: \"translate(10%, 0)\"\n                            }}\n                            disabled={!renderer || !canUndo}\n                            onClick={() => renderer && renderer.undo()}\n                        >\n                            {/* undo */}\n                            <i className=\"fas fa-undo\"></i>&nbsp;\n                            Undo\n                        </button>\n                        <button\n                            className=\"btn btn-primary\"\n                            // center horizontally\n                            style={{\n                                position: \"absolute\",\n                                left: \"50%\",\n                                transform: \"translate(-50%, 0)\",\n                            }}\n                            onClick={() => {\n                                if (renderer) {\n                                    renderer.updateZoomAndOffset(1, 0, 0);\n                                }\n                            }}\n                        >\n                            {/* reset zoom */}\n                            <i className=\"fas fa-search-plus\"></i>&nbsp;\n                            Reset View\n                        </button>\n                        {/* redo */}\n                        <button\n                            className=\"btn btn-primary\"\n                            style={{\n                                position: \"absolute\",\n                                right: \"10%\",\n                                transform: \"translate(-10%, 0)\"\n                            }}\n                            disabled={!renderer || !canRedo}\n                            onClick={() => renderer && renderer.redo()}\n                        >\n                            <i className=\"fas fa-redo\"></i>&nbsp;\n                            Redo\n                        </button>\n                    </div>\n                    {/* vertically center button within the div */}\n                </div>\n            </div>\n        </>\n    );\n};\n","import { Cursor, Rect } from \"./models\";\n\nconst maxSnapshots = 10;\n\n\n\nexport class Renderer {\n    // private backgroundLayer: HTMLCanvasElement;\n    private undoStack: ImageData[] = [];\n    private redoStack: ImageData[] = [];\n    private currentSnapshot: ImageData | undefined;\n\n    private baseImageLayer: HTMLCanvasElement;\n    private editLayer: HTMLCanvasElement;\n    private overlayLayer: HTMLCanvasElement;\n\n    private selectionOverlay: Rect | undefined;\n    private selectionOverlayPreview: Rect | undefined;\n    private hasSelection: boolean = false;\n    private cursor: Cursor | undefined;\n\n    private zoom: number;\n    private offsetX: number;\n    private offsetY: number;\n\n    private snapshotListener: (() => void) | null = null;\n\n    constructor(private readonly canvas: HTMLCanvasElement) {\n        // invisible canvas elements\n        // this.backgroundLayer = document.createElement('canvas');\n        this.baseImageLayer = document.createElement(\"canvas\");\n        this.editLayer = document.createElement(\"canvas\");\n        this.overlayLayer = document.createElement(\"canvas\");\n\n        this.zoom = 1;\n        this.offsetX = 0;\n        this.offsetY = 0;\n    }\n\n    undo() {\n        if (this.undoStack.length > 0 && this.currentSnapshot) {\n            const imageData = this.undoStack.pop()!;\n            this.redoStack.push(this.currentSnapshot);\n            this.currentSnapshot = imageData;\n            // set as base image\n            const ctx = this.baseImageLayer.getContext(\"2d\");\n            if (ctx) {\n                ctx.clearRect(\n                    0,\n                    0,\n                    this.baseImageLayer.width,\n                    this.baseImageLayer.height\n                );\n                ctx.putImageData(imageData, 0, 0);\n                this.render();\n            }\n            this.notifySnapshotListener();\n        }\n    }\n\n    redo() {\n        if (this.redoStack.length > 0 && this.currentSnapshot) {\n            this.undoStack.push(this.currentSnapshot);\n            const imageData = this.redoStack.pop()!;\n            this.currentSnapshot = imageData;\n\n            // set as base image\n            const ctx = this.baseImageLayer.getContext(\"2d\");\n            if (ctx) {\n                ctx.putImageData(imageData, 0, 0);\n                this.render();\n            }\n            this.notifySnapshotListener();\n        }\n    }\n\n    canUndo(): boolean {\n        return !this.hasSelection && this.undoStack.length > 0;\n    }\n\n    canRedo(): boolean {\n        return !this.hasSelection && this.redoStack.length > 0;\n    }\n\n    onSnapshot(listener: () => void) {\n        this.snapshotListener = listener;\n    }\n\n    snapshot() {\n        const ctx = this.baseImageLayer.getContext(\"2d\");\n        if (ctx) {\n            const snapshot = ctx.getImageData(\n                0,\n                0,\n                this.baseImageLayer.width,\n                this.baseImageLayer.height\n            );\n            if (this.currentSnapshot) {\n                this.undoStack.push(this.currentSnapshot);\n                this.currentSnapshot = snapshot;\n                if (this.redoStack.length > 0) {\n                    this.redoStack = [];\n                }\n                if (this.undoStack.length > maxSnapshots) {\n                    this.undoStack.shift();\n                }\n            } else {\n                this.currentSnapshot = snapshot;\n            }\n\n            this.notifySnapshotListener();\n        }\n    }\n\n    private notifySnapshotListener() {\n        if (this.snapshotListener) {\n            this.snapshotListener();\n        }\n    }\n\n    render() {\n        const context = this.canvas.getContext(\"2d\");\n        if (context) {\n            context.clearRect(0, 0, this.canvas.width, this.canvas.height);\n            // apply zoom and offset\n            context.setTransform(\n                this.zoom,\n                0,\n                0,\n                this.zoom,\n                this.offsetX * this.zoom,\n                this.offsetY * this.zoom\n            );\n            // context.drawImage(this.backgroundLayer, 0, 0);\n            context.drawImage(this.baseImageLayer, 0, 0);\n            context.drawImage(this.editLayer, 0, 0);\n            context.drawImage(this.overlayLayer, 0, 0);\n        }\n    }\n\n    getCanvas(): HTMLCanvasElement {\n        return this.canvas;\n    }\n\n    setBaseImage(image: HTMLImageElement) {\n        const context = this.baseImageLayer.getContext(\"2d\");\n        if (context) {\n            // set size of all layers\n            // this.backgroundLayer.width = image.width;\n            // this.backgroundLayer.height = image.height;\n            this.baseImageLayer.width = image.width;\n            this.baseImageLayer.height = image.height;\n            this.editLayer.width = image.width;\n            this.editLayer.height = image.height;\n            this.overlayLayer.width = image.width;\n            this.overlayLayer.height = image.height;\n            // set canvas size\n            this.canvas.width = image.width;\n            this.canvas.height = image.height;\n            context.drawImage(image, 0, 0);\n\n            // set 512x512 selection overlay at the center of the image\n            this.setSelectionOverlay({\n                x: (image.width - 512) / 2,\n                y: (image.height - 512) / 2,\n                width: 512,\n                height: 512,\n            });\n\n            this.render();\n            this.snapshot();\n        }\n    }\n\n    setEditImage(imageData: ImageData | null) {\n        this.hasSelection = !!imageData;\n        const context = this.editLayer.getContext(\"2d\");\n        if (context && this.selectionOverlay) {\n            context.clearRect(\n                0,\n                0,\n                this.editLayer.width,\n                this.editLayer.height\n            );\n            if (imageData) {\n                context.putImageData(\n                    imageData,\n                    this.selectionOverlay.x,\n                    this.selectionOverlay.y\n                );\n            }\n            // edit image makes the selection rect and preview disappear\n            // so redraw the overlay\n            this.hasSelection = !!imageData;\n            this.drawOverlay();\n        }\n        this.notifySnapshotListener();\n    }\n\n    private drawOverlay() {\n        const lineWidth = Math.max(\n            this.canvas.width / 512,\n            this.canvas.height / 512\n        );\n        const context = this.overlayLayer.getContext(\"2d\");\n        if (context) {\n            context.clearRect(\n                0,\n                0,\n                this.overlayLayer.width,\n                this.overlayLayer.height\n            );\n            context.strokeStyle = \"gray\";\n            context.lineWidth = lineWidth;\n            context.strokeRect(\n                0,\n                0,\n                this.overlayLayer.width,\n                this.overlayLayer.height\n            );\n\n            if (!this.hasSelection && this.selectionOverlay) {\n                context.strokeStyle = \"white\";\n                context.lineWidth = lineWidth;\n                context.strokeRect(\n                    this.selectionOverlay.x,\n                    this.selectionOverlay.y,\n                    this.selectionOverlay.width,\n                    this.selectionOverlay.height\n                );\n            }\n            if (!this.hasSelection && this.selectionOverlayPreview) {\n                context.strokeStyle = \"cyan\";\n                context.lineWidth = lineWidth;\n                context.strokeRect(\n                    this.selectionOverlayPreview.x,\n                    this.selectionOverlayPreview.y,\n                    this.selectionOverlayPreview.width,\n                    this.selectionOverlayPreview.height\n                );\n            }\n            if (this.cursor) {\n                if (this.cursor.type === \"circle\") {\n                    context.lineWidth = lineWidth;\n                    context.strokeStyle = this.cursor.color;\n                    // context.globalAlpha = 0.5;\n                    context.beginPath();\n                    context.arc(\n                        this.cursor.x,\n                        this.cursor.y,\n                        this.cursor.radius,\n                        0,\n                        2 * Math.PI\n                    );\n                    context.stroke();\n                } else if (this.cursor.type === \"circle-fill\") {\n                    context.fillStyle = this.cursor.color;\n                    // context.lineWidth = lineWidth;\n                    // context.globalAlpha = 0.5;\n                    context.beginPath();\n                    context.arc(\n                        this.cursor.x,\n                        this.cursor.y,\n                        this.cursor.radius,\n                        0,\n                        2 * Math.PI\n                    );\n                    context.fill();\n                } else if (this.cursor.type == \"crosshairs\") {\n                    // draw crosshairs based on cursor radius\n                    context.strokeStyle = this.cursor.color;\n                    context.lineWidth = lineWidth;\n                    context.beginPath();\n                    context.moveTo(\n                        this.cursor.x - this.cursor.radius,\n                        this.cursor.y\n                    );\n                    context.lineTo(\n                        this.cursor.x + this.cursor.radius,\n                        this.cursor.y\n                    );\n                    context.moveTo(\n                        this.cursor.x,\n                        this.cursor.y - this.cursor.radius\n                    );\n                    context.lineTo(\n                        this.cursor.x,\n                        this.cursor.y + this.cursor.radius\n                    );\n                    context.stroke();\n                } else if (this.cursor.type === \"colorpicker\") {\n                    // TODO: add croshairs\n                    context.lineWidth = this.cursor.radius * 0.75;\n                    context.strokeStyle = this.cursor.color;\n                    // context.globalAlpha = 0.5;\n                    context.beginPath();\n                    context.arc(\n                        this.cursor.x,\n                        this.cursor.y,\n                        this.cursor.radius,\n                        0,\n                        2 * Math.PI\n                    );\n                    context.stroke();\n\n                    // draw crosshairs (black)\n                    context.lineWidth = lineWidth;\n                    context.strokeStyle = \"black\";\n                    context.beginPath();\n                    context.moveTo(\n                        this.cursor.x - this.cursor.radius,\n                        this.cursor.y\n                    );\n                    context.lineTo(\n                        this.cursor.x + this.cursor.radius,\n                        this.cursor.y\n                    );\n                    context.moveTo(\n                        this.cursor.x,\n                        this.cursor.y - this.cursor.radius\n                    );\n                    context.lineTo(\n                        this.cursor.x,\n                        this.cursor.y + this.cursor.radius\n                    );\n                    context.stroke();\n                }\n            }\n\n            this.render();\n        }\n    }\n\n    setSelectionOverlay(selectionOverlay: Rect | undefined) {\n        this.selectionOverlay = selectionOverlay;\n        this.drawOverlay();\n    }\n\n    setSelectionOverlayPreview(selectionOverlayPreview: Rect | undefined) {\n        this.selectionOverlayPreview = selectionOverlayPreview;\n        this.drawOverlay();\n    }\n\n    setCursor(cursor: Cursor | undefined) {\n        this.cursor = cursor;\n        this.drawOverlay();\n    }\n\n    getSelectionOverlay(): Rect | undefined {\n        return this.selectionOverlay;\n    }\n\n    getZoom(): number {\n        return this.zoom;\n    }\n\n    getOffsetX(): number {\n        return this.offsetX;\n    }\n\n    getOffsetY(): number {\n        return this.offsetY;\n    }\n\n    updateZoomAndOffset(zoom: number, offsetX: number, offsetY: number) {\n        this.zoom = zoom;\n        this.offsetX = offsetX;\n        this.offsetY = offsetY;\n        this.render();\n    }\n\n    getWidth(): number {\n        return this.canvas.width;\n    }\n\n    getHeight(): number {\n        return this.canvas.height;\n    }\n\n    getEncodedImage(selection: Rect | null): string | undefined {\n        const imageData = this.getImageData(selection);\n        if (imageData) {\n            // create a canvas and draw the image data on it\n            const canvas = document.createElement(\"canvas\");\n            canvas.width = imageData.width;\n            canvas.height = imageData.height;\n            const context = canvas.getContext(\"2d\");\n            if (context) {\n                context.putImageData(imageData, 0, 0);\n                // return the data url of the canvas\n                const result = canvas.toDataURL(\"image/jpeg\");\n                // cleanup the canvas\n                canvas.remove();\n                // extract base64 data from data url\n                return result.split(\",\")[1];\n            }\n        }\n    }\n\n    getImageData(selection: Rect | null): ImageData | undefined {\n        if (!selection) {\n            selection = {\n                x: 0,\n                y: 0,\n                width: this.canvas.width,\n                height: this.canvas.height,\n            };\n        }\n        // get image data of the selection\n        let context = this.baseImageLayer.getContext(\"2d\");\n        if (context) {\n            const imageData = context.getImageData(\n                selection.x,\n                selection.y,\n                selection.width,\n                selection.height\n            );\n            return imageData;\n        }\n    }\n\n    commitSelection() {\n        // draw the selection overlay on the base image layer\n        const context = this.baseImageLayer.getContext(\"2d\");\n        if (context) {\n            context.drawImage(this.editLayer, 0, 0);\n            this.setEditImage(null);\n            this.snapshot();\n        }\n    }\n\n    drawPoint(x: number, y: number, brushSize: number, color: string): void {\n        // draw on selection layer\n        const context = this.editLayer.getContext(\"2d\");\n        if (context) {\n            context.fillStyle = color;\n            context.beginPath();\n            context.arc(x, y, brushSize / 2, 0, 2 * Math.PI);\n            context.fill();\n        }\n        this.render();\n    }\n\n    drawLine(\n        x1: number,\n        y1: number,\n        x2: number,\n        y2: number,\n        brushSize: number,\n        color: string\n    ): void {\n        // draw on selection layer\n        const context = this.editLayer.getContext(\"2d\");\n        if (context) {\n            context.strokeStyle = color;\n            context.lineWidth = brushSize;\n            context.lineCap = \"round\";\n            context.beginPath();\n            context.moveTo(x1, y1);\n            context.lineTo(x2, y2);\n            context.stroke();\n        }\n        this.render();\n    }\n\n    smudgeLine(\n        x1: number,\n        y1: number,\n        x2: number,\n        y2: number,\n        brushSize: number,\n        brushOpacity: number\n    ): void {\n        const unitVector = {\n            x: x2 - x1,\n            y: y2 - y1,\n        };\n        const length = Math.sqrt(\n            unitVector.x * unitVector.x + unitVector.y * unitVector.y\n        );\n        unitVector.x /= length;\n        unitVector.y /= length;\n\n        // for each point on the line, get image data (brushSize x brushSize) from edit layer\n        // average pixel values that are within the brush circle.\n        // update the image data with the averaged pixel values in the\n        // brush circle, then put the image data back on the edit layer\n        // at the point on the line\n\n        const context = this.editLayer.getContext(\"2d\");\n        if (context) {\n            for (let i = 0; i < length; i++) {\n                const x = x1 + i * unitVector.x;\n                const y = y1 + i * unitVector.y;\n\n                const imageData = context.getImageData(\n                    x - brushSize / 2,\n                    y - brushSize / 2,\n                    brushSize,\n                    brushSize\n                );\n\n                let totalRed = 0;\n                let totalGreen = 0;\n                let totalBlue = 0;\n                let count = 0.0;\n\n                // average pixel values\n                for (let y = 0; y < imageData.height; y++) {\n                    for (let x = 0; x < imageData.width; x++) {\n                        const index = (y * imageData.width + x) * 4;\n                        const distance = Math.sqrt(\n                            (x - brushSize / 2) * (x - brushSize / 2) +\n                                (y - brushSize / 2) * (y - brushSize / 2)\n                        );\n                        if (distance <= brushSize / 2) {\n                            // get the pixel value from the image data\n                            const r = imageData.data[index];\n                            const g = imageData.data[index + 1];\n                            const b = imageData.data[index + 2];\n\n                            totalRed += r;\n                            totalGreen += g;\n                            totalBlue += b;\n                            count++;\n                        }\n                    }\n                }\n\n                // update the image data with the averaged pixel values\n                // these need to be weighted by the brush opacity\n                const averageRed = totalRed / count;\n                const averageGreen = totalGreen / count;\n                const averageBlue = totalBlue / count;\n                for (let y = 0; y < imageData.height; y++) {\n                    for (let x = 0; x < imageData.width; x++) {\n                        const index = (y * imageData.width + x) * 4;\n                        const distance = Math.sqrt(\n                            (x - brushSize / 2) * (x - brushSize / 2) +\n                                (y - brushSize / 2) * (y - brushSize / 2)\n                        );\n                        if (distance <= brushSize / 2) {\n                            imageData.data[index] =\n                                averageRed * brushOpacity +\n                                imageData.data[index] * (1 - brushOpacity);\n                            imageData.data[index + 1] =\n                                averageGreen * brushOpacity +\n                                imageData.data[index + 1] * (1 - brushOpacity);\n                            imageData.data[index + 2] =\n                                averageBlue * brushOpacity +\n                                imageData.data[index + 2] * (1 - brushOpacity);\n                        }\n                    }\n                }\n\n                // put the image data back on the edit layer\n                context.putImageData(\n                    imageData,\n                    x - brushSize / 2,\n                    y - brushSize / 2\n                );\n            }\n        }\n        this.render();\n    }\n\n    getPixel(x: number, y: number): string {\n        const context = this.baseImageLayer.getContext(\"2d\");\n        // get pixel as hex string\n        if (context) {\n            const pixel = context.getImageData(x, y, 1, 1).data;\n            return (\n                \"#\" +\n                (\"000000\" + rgbToHex(pixel[0], pixel[1], pixel[2])).slice(-6)\n            );\n        }\n        return \"#000000\";\n    }\n\n    copyEditImageFromBaseImage(): void {\n        // copy the base image to the edit layer\n        const context = this.editLayer.getContext(\"2d\");\n        if (context) {\n            context.drawImage(this.baseImageLayer, 0, 0);\n        }\n        this.render();\n        this.hasSelection = true;\n        this.notifySnapshotListener();\n    }\n}\n\nfunction rgbToHex(r: number, g: number, b: number) {\n    if (r > 255 || g > 255 || b > 255) throw \"Invalid color component\";\n    return ((r << 16) | (g << 8) | b).toString(16);\n}\n\nexport function createRenderer(canvas: HTMLCanvasElement): Renderer {\n    return new Renderer(canvas);\n}\n","export function sleep(ms: number): Promise<void> {\n    return new Promise(resolve => window.setTimeout(resolve, ms));\n}\n","import { Rect } from \"../pages/image-editor/models\";\n\nexport function featherEdges(\n    selectionOverlay: Rect,\n    imageWidth: number,\n    imageHeight: number,\n    imageData: ImageData\n) {\n    const featherLeftEdge = selectionOverlay.x != 0;\n    const featherRightEdge =\n        selectionOverlay.x + selectionOverlay.width != imageWidth;\n    const featherTopEdge = selectionOverlay.y != 0;\n    const featherBottomEdge =\n        selectionOverlay.y + selectionOverlay.height != imageHeight;\n\n    const baseWidth = Math.min(\n        selectionOverlay.width,\n        selectionOverlay.height\n    );\n    const featherWidth = Math.floor(baseWidth / 8);\n\n    if (featherTopEdge) {\n        for (let y = 0; y < featherWidth; y++) {\n            for (let x = 0; x < selectionOverlay.width; x++) {\n                const pixelIndex = (y * selectionOverlay.width + x) * 4;\n                const alpha = (y / featherWidth) * 255;\n                const existingAlpha = imageData.data[pixelIndex + 3];\n                imageData.data[pixelIndex + 3] = Math.min(\n                    alpha,\n                    existingAlpha\n                );\n            }\n        }\n    }\n    if (featherBottomEdge) {\n        for (\n            let y = selectionOverlay.height - featherWidth;\n            y < selectionOverlay.height;\n            y++\n        ) {\n            for (let x = 0; x < selectionOverlay.width; x++) {\n                const pixelIndex = (y * selectionOverlay.width + x) * 4;\n                const alpha =\n                    ((selectionOverlay.height - y) / featherWidth) * 255;\n                const existingAlpha = imageData.data[pixelIndex + 3];\n                imageData.data[pixelIndex + 3] = Math.min(\n                    alpha,\n                    existingAlpha\n                );\n            }\n        }\n    }\n    if (featherLeftEdge) {\n        for (let x = 0; x < featherWidth; x++) {\n            for (let y = 0; y < selectionOverlay.height; y++) {\n                const pixelIndex = (y * selectionOverlay.width + x) * 4;\n                const alpha = (x / featherWidth) * 255;\n                const existingAlpha = imageData.data[pixelIndex + 3];\n                imageData.data[pixelIndex + 3] = Math.min(\n                    alpha,\n                    existingAlpha\n                );\n            }\n        }\n    }\n    if (featherRightEdge) {\n        for (\n            let x = selectionOverlay.width - featherWidth;\n            x < selectionOverlay.width;\n            x++\n        ) {\n            for (let y = 0; y < selectionOverlay.height; y++) {\n                const pixelIndex = (y * selectionOverlay.width + x) * 4;\n                const alpha =\n                    ((selectionOverlay.width - x) / featherWidth) * 255;\n                const existingAlpha = imageData.data[pixelIndex + 3];\n                imageData.data[pixelIndex + 3] = Math.min(\n                    alpha,\n                    existingAlpha\n                );\n            }\n        }\n    }\n}\n\n\n\nfunction getAverageColor(imageData: ImageData) {\n    let red = 0;\n    let green = 0;\n    let blue = 0;\n    let count = 0;\n    for (let i = 0; i < imageData.data.length; i += 4) {\n        if (imageData.data[i + 3] > 0) {\n            red += imageData.data[i];\n            green += imageData.data[i + 1];\n            blue += imageData.data[i + 2];\n            count++;\n        }\n    }\n    return {\n        red: red / count,\n        green: green / count,\n        blue: blue / count,\n    };\n}\n\nexport function fixRedShift(\n    baseImageData: ImageData,\n    imageData: ImageData,\n) {\n    // get the average red, green and blue values for the base image\n    const baseAverageColor = getAverageColor(baseImageData);\n    const averageColor = getAverageColor(imageData);\n\n    // we need to multiply pixels in imageData by an amount so that the average equals the base average\n    // do this for red, green and blue separately\n    const redMultiplier = baseAverageColor.red / averageColor.red;\n    const greenMultiplier = baseAverageColor.green / averageColor.green;\n    const blueMultiplier = baseAverageColor.blue / averageColor.blue;\n\n    for (let i = 0; i < imageData.data.length; i += 4) {\n        imageData.data[i] *= Math.floor(redMultiplier);\n        imageData.data[i + 1] *= Math.floor(greenMultiplier);\n        imageData.data[i + 2] *= Math.floor(blueMultiplier);\n    }\n}","import React, { FC, useState, useEffect } from \"react\";\nimport loadImage from \"blueimp-load-image\";\nimport saveAs from \"file-saver\";\n\nimport { AIBrushApi } from \"../../client\";\nimport { Renderer } from \"./renderer\";\nimport { BaseTool, Tool } from \"./tool\";\n\ninterface Props {\n    renderer: Renderer;\n    tool: BaseTool;\n    api: AIBrushApi;\n}\n\nexport const ImportExportControls: FC<Props> = ({ renderer, tool }) => {\n\n    const [backupImage, setBackupImage] = useState<string | undefined>();\n\n    const onImageSelected = (event: React.ChangeEvent<HTMLInputElement>) => {\n        const files = event.target.files;\n        if (files && files.length > 0) {\n            loadImage(\n                files[0],\n                (img) => {\n                    const backupImage = renderer.getEncodedImage(null);\n                    setBackupImage(backupImage);\n                    renderer.setBaseImage(img as HTMLImageElement);\n                },\n                { canvas: false }\n            );\n        }\n    };\n\n    const onExport = () => {\n        const encodedImage = renderer.getEncodedImage(null);\n        if (encodedImage) {\n            // base64 decode\n            const byteString = atob(encodedImage);\n            // save as file\n            const buffer = new ArrayBuffer(byteString.length);\n            const intArray = new Uint8Array(buffer);\n            for (let i = 0; i < byteString.length; i++) {\n                intArray[i] = byteString.charCodeAt(i);\n            }\n            const blob = new Blob([intArray], { type: \"image/jpeg\" });\n            saveAs(blob, \"image.jpg\");\n        }\n    };\n\n    if (backupImage) {\n        return (\n            <div className=\"form-group\" style={{marginTop: \"16px\"}}>\n                <button\n                    className=\"btn btn-primary\"\n                    onClick={() => {\n                        setBackupImage(undefined);\n                        const img = new Image();\n                        // set src as data uri\n                        const src = \"data:image/png;base64,\" + backupImage;\n                        img.src = src;\n                        img.onload = () => {\n                            renderer.setBaseImage(img);\n                        };\n                    }}\n                >\n                    {/* cancel icon */}\n                    <i className=\"fas fa-times\"></i>&nbsp;\n                    Revert\n                </button>\n                <button\n                    className=\"btn btn-primary\"\n                    onClick={() => {\n                        setBackupImage(undefined);\n                        if (tool.saveListener) {\n                            tool.saveListener(backupImage);\n                        }\n                    }}\n                    style={{marginLeft: \"8px\"}}\n                >\n                    {/* save icon */}\n                    <i className=\"fas fa-save\"></i>&nbsp;\n                    Save\n                </button>\n            </div>\n        );\n    }\n\n    // Show buttons for import and export and \"save a copy\"\n    return (\n        <>\n            <div className=\"form-group\" style={{marginTop: \"16px\"}}>\n                <label\n                    id=\"loadimage-wrapper\"\n                    className={`btn btn-primary `}\n                    style={{ display: \"inline\" }}\n                >\n                    {/* upload image */}\n                    <i className=\"fas fa-upload\"></i>&nbsp; Import Image\n                    <input\n                        id=\"loadimage\"\n                        type=\"file\"\n                        style={{ display: \"none\" }}\n                        onChange={onImageSelected}\n                    />\n                </label>\n            </div>\n            <div className=\"form-group\">\n                <button\n                    className=\"btn btn-primary\"\n                    onClick={() => {\n                        onExport();\n                    }}\n                    style={{ marginLeft: \"8px\"}}\n                >\n                    <i className=\"fas fa-download\"></i>&nbsp; Export Image\n                </button>\n            </div>\n        </>\n    );\n};\n","import React from \"react\";\n\nexport interface Tool {\n    name: string;\n    getArgs(): any;\n    updateArgs(args: any): void;\n    onMouseDown(event: React.MouseEvent<HTMLCanvasElement, MouseEvent>): void;\n    onMouseMove(event: React.MouseEvent<HTMLCanvasElement, MouseEvent>): void;\n    onMouseUp(event: React.MouseEvent<HTMLCanvasElement, MouseEvent>): void;\n    onMouseLeave(event: React.MouseEvent<HTMLCanvasElement, MouseEvent>): void;\n    onKeyDown(event: KeyboardEvent): void;\n    onKeyUp(event: KeyboardEvent): void;\n    onWheel(event: WheelEvent): void;\n    destroy(): boolean;\n    onShowSelectionControls(listener: (show: boolean) => void): void;\n    select(direction: \"left\" | \"right\"): void;\n    onSaveImage(listener: (encodedImage: string) => void): void;\n}\n\nexport class BaseTool implements Tool {\n\n    saveListener?: (encodedImage: string) => void = () => {};\n\n    constructor(readonly name: string) {}\n\n    getArgs(): any {\n        return JSON.parse(\n            localStorage.getItem(`tool_args_${this.name}`) || \"{}\"\n        );\n    }\n    updateArgs(args: any) {\n        localStorage.setItem(`tool_args_${this.name}`, JSON.stringify(args));\n    }\n    onMouseDown(event: React.MouseEvent<HTMLCanvasElement, MouseEvent>) {}\n    onMouseMove(event: React.MouseEvent<HTMLCanvasElement, MouseEvent>) {}\n    onMouseUp(event: React.MouseEvent<HTMLCanvasElement, MouseEvent>) {}\n    onMouseLeave(event: React.MouseEvent<HTMLCanvasElement, MouseEvent>) {}\n    onKeyDown(event: KeyboardEvent) {}\n    onKeyUp(event: KeyboardEvent) {}\n    onWheel(event: WheelEvent) {}\n    destroy(): boolean {\n        return true;\n    }\n    onShowSelectionControls(listener: (show: boolean) => void) {}\n    select(direction: \"left\" | \"right\") {}\n    onSaveImage(listener: (encodedImage: string) => void) {\n        this.saveListener = listener;\n    }\n}\n","// Login react component with hooks\nimport React, { useState, FC } from \"react\";\nimport * as axios from \"axios\";\nimport qs from \"qs\";\nimport { AIBrushApi, LoginResult } from \"../client/api\";\n\ninterface LoginProps {\n  httpClient: axios.AxiosInstance;\n  client: AIBrushApi;\n  onLogin: (loginResult: LoginResult) => void;\n}\n\nexport const Login: FC<LoginProps> = (props) => {\n  // login form accepts email only\n  const [email, setEmail] = useState(\"\");\n  const [emailSubmitted, setEmailSubmitted] = useState(false);\n  const [code, setCode] = useState(\"\");\n  const [err, setErr] = useState(\"\");\n\n  // check query string for invite_code\n  const query = window.location.search;\n  const queryParams = qs.parse(query.substring(1));\n  const inviteCode = queryParams[\"invite_code\"];\n\n  const onLogin = async () => {\n    // clear error\n    setErr(\"\");\n    // validate valid email\n    if (!email.match(/^[^@]+@[^@]+\\.[^@]+$/)) {\n      setErr(\"Invalid email address\");\n      return;\n    }\n\n    try {\n      await props.client.login({\n        email: email,\n        invite_code: inviteCode as string,\n      });\n      setEmailSubmitted(true);\n    } catch (err) {\n      console.error(err);\n      setErr(\"Could not login\");\n    }\n  };\n\n  const onVerify = async () => {\n    // clear error\n    setErr(\"\");\n    // attempt to verify code\n    try {\n      const result = await props.client.verify({\n        email,\n        code,\n      });\n      props.onLogin(result.data);\n    } catch (err) {\n      console.error(err);\n      setErr(\"Failed to verify code\");\n    }\n  };\n\n  // bootstrap login form\n  return (\n    <>\n      <div className=\"row\" style={{height: \"100vh\", marginLeft: \"0px\", marginRight: \"0px\"}}>\n        <div className=\"col-md-6 login-splash\">\n          {/* <div className=\"center-cropped\" style={{backgroundImage: \"url(/images/scifi-dreamland.jpg)\"}}></div> */}\n          <img\n            className=\"center-cropped\"\n            src=\"/images/scifi-dreamland.jpg\"\n          />\n        </div>\n        <div className=\"col-md-6\">\n          <div\n            style={{ fontWeight: 500, fontSize: \"48px\", marginTop: \"241px\" }}\n          >\n            AiBrush\n          </div>\n          {/* Display error if one is set */}\n          {/* Use <p class=\"text-danger\" */}\n          {err && <p className=\"text-danger\">{err}</p>}\n          {err && (\n            <p className=\"text-info\">\n              If you don't have an account yet, request one by sending an email\n              to <a href=\"mailto:admin@aibrush.art\">admin@aibrush.art</a>\n            </p>\n          )}\n          <div style={{marginLeft: \"10%\", marginRight: \"10%\", marginTop: \"88px\", textAlign: \"left\"}}>\n            {/* If email submitted, show verify code form*/}\n            {emailSubmitted && (\n              <>\n                <div className=\"form-group\">\n                  <label htmlFor=\"verifyCode\">Verify Code</label>\n                  <input\n                    type=\"text\"\n                    className=\"form-control\"\n                    id=\"verifyCode\"\n                    placeholder=\"Verification Code\"\n                    value={code}\n                    onChange={(e) => setCode(e.target.value)}\n                  />\n                </div>\n                {/* Cancel verification and go back to email */}\n                <button\n                  className=\"btn btn-secondary\"\n                  onClick={() => setEmailSubmitted(false)}\n                >\n                  Cancel\n                </button>\n                &nbsp;\n                {/* Verify code */}\n                <button\n                  type=\"button\"\n                  className=\"btn btn-primary\"\n                  onClick={(e) => {\n                    e.preventDefault();\n                    onVerify();\n                  }}\n                >\n                  Verify\n                </button>\n              </>\n            )}\n            {/* Else, show login form */}\n            {!emailSubmitted && (\n              <>\n                <div className=\"form-group\">\n                  <label htmlFor=\"email\">Email address</label>\n                  <input\n                    type=\"email\"\n                    className=\"form-control\"\n                    id=\"email\"\n                    aria-describedby=\"emailHelp\"\n                    placeholder=\"Enter email\"\n                    value={email}\n                    onChange={(e) => setEmail(e.target.value)}\n                  />\n                </div>\n                <button\n                  type=\"button\"\n                  className=\"btn btn-primary\"\n                  style={{float: \"right\"}}\n                  onClick={(e) => {\n                    e.preventDefault();\n                    onLogin();\n                  }}\n                >\n                  Login\n                </button>\n              </>\n            )}\n          </div>\n        </div>\n      </div>\n    </>\n  );\n};\n","// Given a set of credentials, this component will refresh them\n// every 5 minutes and invoke the onCredentialsRefreshed callback\n\nimport React, { useEffect, FC } from \"react\"\nimport { LoginResult, AIBrushApi } from \"../client/api\";\n\ninterface TokenRefresherProps {\n    onCredentialsRefreshed: (loginResult: LoginResult) => void;\n    api: AIBrushApi;\n    credentials: LoginResult;\n}\n\nexport const TokenRefresher : FC<TokenRefresherProps> = ({ onCredentialsRefreshed, api, credentials }) => {\n    useEffect(() => {\n        const interval = setInterval(() => {\n            if (credentials && credentials.refreshToken) {\n                api.refresh({refreshToken: credentials.refreshToken}).then(loginResult => {\n                    onCredentialsRefreshed(loginResult.data);\n                });\n            }\n\n        }, 5 * 60 * 1000);\n        return () => {\n            clearInterval(interval);\n        };\n    }, [credentials, api, onCredentialsRefreshed]);\n    return <div></div>;\n}","import React, { FC, useEffect, useState } from 'react';\nimport { AIBrushApi } from \"../client/api\";\n\ninterface HealthcheckerProps {\n    api: AIBrushApi;\n}\n\nexport const Healthchecker: FC<HealthcheckerProps> = ({ api }) => {\n    // automatically check health every 5 seconds\n    const [healthCheck, setHealthCheck] = useState(true);\n    \n    useEffect(() => {\n        const interval = setInterval(() => {\n            api.healthcheck().then(() => setHealthCheck(true)).catch(() => setHealthCheck(false));\n        }, 5000);\n\n        return () => clearInterval(interval);\n    }, [api]);\n\n    // only display bootstrap danger alert if healthcheck failed\n    // \"service is unavailable\"\n    return (\n        <div className=\"alert alert-danger\" role=\"alert\" style={{ display: healthCheck ? 'none' : 'block' }}>\n            <strong>Service is unavailable</strong>\n        </div>\n    );\n}\n\n","import React, { FC, useEffect, useState } from \"react\";\nimport { saveAs } from \"file-saver\";\n\nimport { AIBrushApi, CreateServiceAccountInputTypeEnum } from \"../client/api\";\n\ninterface Props {\n    api: AIBrushApi;\n}\n\nexport const WorkerConfigPage: FC<Props> = ({ api }) => {\n\n    const [type, setType] = useState<CreateServiceAccountInputTypeEnum>(CreateServiceAccountInputTypeEnum.Private);\n    const [isAdmin, setIsAdmin] = useState<boolean>(false);\n\n    // show some information about what a worker is and does\n    // * a worker processes requests to create images with AIBrush\n    const info = (): JSX.Element => {\n        return (\n            <>\n                <div className=\"row\">\n                    <div className=\"col-12\">\n                        <h2>Worker Config</h2>\n                    </div>\n                </div>\n                <div className=\"row\">\n                    <div className=\"col-12\">\n                        <p>\n                            This page allows you to download a worker config file needed to access the AIBrush api.\n                            This file can be used to run a worker on a local or cloud machine, or a Colab notebook.\n                            Images worker requires an NVidia GPU with at least 12GB of VRAM, but at least 16GB is recommended.\n                            Suggestions worker requires an NVidia GPU with at least 16GB of VRAM.\n\n                            See the <a href=\"https://github.com/wolfgangmeyers/aibrush-2/tree/main/worker#readme\" target=\"_blank\">worker readme</a> for details on how to set up a worker process.\n                        </p>\n                    </div>\n                </div>\n                <div className=\"row\">\n                    <div className=\"col-lg-6 offset-lg-3\">\n                        <hr/>\n                        <p>\n                            Here is a link to a Google Colab notebook that can be used as a worker node:\n                        </p>\n                        {/* Link to google colab notebook at https://colab.research.google.com/drive/1cW3vVjdeI19o7a9miMu47J5EDyHfZT20#scrollTo=Ed1iT6_JK0Mo */}\n                        <a className=\"btn btn-primary top-button\" href=\"https://colab.research.google.com/drive/1cW3vVjdeI19o7a9miMu47J5EDyHfZT20#scrollTo=Ed1iT6_JK0Mo\" target=\"_blank\">\n                            {/* font awesome google colab icon */}\n                            <i className=\"fab fa-google\"></i>&nbsp;\n                            Google Colab Notebook\n                        </a>\n                    </div>\n                </div>\n            </>\n        )\n    }\n\n    const download = async () => {\n        const creds = await api.createServiceAccount({\n            type: type\n        })\n        const blob = new Blob([JSON.stringify(creds.data)], { type: \"application/json\" });\n        saveAs(blob, \"credentials.json\");\n    }\n\n    // public / private dropdown\n    // download button\n    const form = (): JSX.Element => {\n        return (\n            <div className=\"row\">\n                {/* lg-6 with lg-3 offset */}\n                <div className=\"col-lg-6 offset-lg-3\">\n                    <form>\n                        {isAdmin && <div className=\"form-group\">\n                            <label htmlFor=\"type\">Type</label>\n                            <select className=\"form-control\" id=\"type\" value={type} onChange={(e) => setType(e.target.value as CreateServiceAccountInputTypeEnum)}>\n                                <option value=\"public\">Public</option>\n                                <option value=\"private\">Private</option>\n                            </select>\n                        </div>}\n                        <button type=\"submit\" className=\"btn btn-primary\" onClick={() => download()}>Download</button>\n                    </form>\n                </div>\n\n            </div>\n        )\n    }\n\n    useEffect(() => {\n        api.isAdmin().then(isAdmin => setIsAdmin(!!isAdmin.data.is_admin));\n    }, [])\n\n    return (\n        <>\n            {info()}\n            {form()}\n        </>\n    )\n}","import React, { FC, useEffect, useState } from \"react\";\nimport { Modal } from \"react-bootstrap\";\nimport { AIBrushApi, Worker } from \"../../client\";\n\ninterface Props {\n    api: AIBrushApi;\n}\n\nexport const WorkerList: FC<Props> = ({ api }) => {\n    const [workers, setWorkers] = useState<Worker[]>([]);\n    const [code, setCode] = useState<string>(\"\");\n\n    useEffect(() => {\n        api.getWorkers().then((resp) => {\n            setWorkers(resp.data.workers || []);\n        });\n    }, [api]);\n\n    const onDeleteWorker = async (worker: Worker) => {\n        await api.deleteWorker(worker.id);\n        setWorkers(workers.filter((w) => w.id !== worker.id));\n    };\n\n    const onGenerateCode = async (worker: Worker) => {\n        const resp = await api.generateWorkerLoginCode(worker.id);\n        setCode(resp.data.login_code);\n    };\n\n    const onCreateWorker = async () => {\n        const displayName = `Worker ${workers.length + 1}`;\n        const worker = await api.createWorker({\n            display_name: displayName,\n        });\n        setWorkers([...workers, worker.data]);\n    };\n\n    // for each worker, render a row\n    // show id, display name, and status. actions = delete, generate code\n\n    return (\n        <>\n            <h1>Workers</h1>\n            <div className=\"row\">\n                <div className=\"col-12\">\n                    <button\n                        className=\"btn btn-primary\"\n                        onClick={onCreateWorker}\n                    >\n                        Create Worker\n                    </button>\n                </div>\n            </div>\n            <div className=\"row\" style={{ marginTop: \"16px\" }}>\n                <div className=\"col-12\">\n                    {workers.length > 0 && (\n                        <table className=\"table\">\n                            <thead>\n                                <tr>\n                                    <th>ID</th>\n                                    <th>Display Name</th>\n                                    <th>Status</th>\n                                    <th>Actions</th>\n                                </tr>\n                            </thead>\n                            <tbody>\n                                {workers.map((worker) => (\n                                    <tr key={worker.id}>\n                                        <td>{worker.id}</td>\n                                        <td>{worker.display_name}</td>\n                                        <td>{worker.status}</td>\n                                        <td>\n                                            <button\n                                                className=\"btn btn-danger btn-sm\"\n                                                onClick={() =>\n                                                    onDeleteWorker(worker)\n                                                }\n                                            >\n                                                Delete\n                                            </button>\n                                            &nbsp;\n                                            <button\n                                                className=\"btn btn-primary btn-sm\"\n                                                onClick={() =>\n                                                    onGenerateCode(worker)\n                                                }\n                                            >\n                                                Generate Code\n                                            </button>\n                                        </td>\n                                    </tr>\n                                ))}\n                            </tbody>\n                        </table>\n                    )}\n                </div>\n            </div>\n            {code && (\n                <Modal show={!!code} onHide={() => setCode(\"\")}>\n                    <Modal.Header closeButton>\n                        <Modal.Title>Worker Login Code</Modal.Title>\n                    </Modal.Header>\n                    <Modal.Body>\n                        <p>\n                            Give this code to the worker to login to the\n                            application.\n                        </p>\n                        <p>\n                            <strong>{code}</strong>\n                        </p>\n                    </Modal.Body>\n                </Modal>\n            )}\n        </>\n    );\n};\n","import React, { FC, useState, useEffect, useRef } from 'react';\nimport { AIBrushApi,  } from \"../../client/api\"\nimport { WorkerList } from './WorkerList';\n\n\ninterface Props {\n    api: AIBrushApi\n}\n\nexport const Admin: FC<Props> = ({api}) => {\n\n    const [links, setLinks] = useState<string[]>([]);\n\n    const onGenerateLink = async () => {\n        const inviteCode = await api.createInviteCode();\n        setLinks([...links, `/?invite_code=${inviteCode.data.id}`]);\n    }\n\n    return (<>\n        {/* Header: Create new image */}\n        <div className=\"row\">\n            <div className=\"col-12\">\n                <h1>Admin features</h1>\n            </div>\n        </div>\n        {/* 50px vertical spacer */}\n        <div className=\"row\">\n            <div className=\"col-12\">\n                <div className=\"spacer\" />\n            </div>\n        </div>\n        {\n            links.length > 0 && <div className=\"row\">\n                <div className=\"col-12\">\n                    <p>\n                        Right click to copy invite links\n                    </p>\n                </div>\n            </div>\n        }\n        <div className=\"row\">\n            <div className=\"offset-lg-3 col-lg-6 col-sm-12\">\n                {/* show a list of hyperlinks */}\n                <div className=\"btn-group-vertical\">\n                    {links.map((link, i) => <a key={i} href={link} className=\"btn btn-primary\">\n                        <i className=\"fas fa-link\" />&nbsp;\n                        Invite Link\n                    </a>)}\n                </div>\n            </div>\n        </div>\n        <div className=\"row\">\n            <div className=\"col-12\">\n                <div className=\"spacer\" />\n            </div>\n        </div>\n        <div className=\"row\">\n            <div className=\"col-12\">\n                {/* button to generate links */}\n                <button className=\"btn btn-primary\" onClick={onGenerateLink}>Generate Link</button>\n            </div>\n        </div>\n        <hr/>\n        <WorkerList api={api} />\n    </>)\n}","import React, { FC, useEffect, useState } from \"react\";\nimport moment from \"moment\";\nimport { Image, ImageStatusEnum } from \"../client/api\";\n\ninterface Props {\n    assetsUrl: string;\n    image: Image;\n    onClick?: (image: Image) => void;\n}\n\nexport const ImageThumbnail: FC<Props> = ({ assetsUrl, image, onClick }) => {\n    const src = `${assetsUrl}/${image.id}.thumbnail.jpg?updated_at=${image.updated_at}`;\n    const [retry, setRetry] = useState(\"\");\n    const [hover, setHover] = useState(false);\n\n    // on mouse in/out, set hover state\n    const onMouseEnter = () => setHover(true);\n    const onMouseLeave = () => setHover(false);\n\n    useEffect(() => {\n\n        // This is to help deal with eventual consistency from S3.\n        // if image.updated_at (unix timestamp in milliseconds) is less than a minute ago, try to reload the image\n        if (moment().diff(moment(image.updated_at), \"minutes\") < 1) {\n            setRetry(\"\");\n            const t = setTimeout(() => {\n                setRetry(\"&retry\")\n            }, 3000);\n            return () => clearTimeout(t);\n        }\n    }, [image.id, image.updated_at])\n\n    let label = image.label;\n    if (image.label === \"\") {\n        label = image.phrases[0];\n    }\n    \n\n    return (\n        <div\n            onMouseEnter={onMouseEnter}\n            onMouseLeave={onMouseLeave}\n            style={{\n                backgroundImage: `url(${src}${retry}), url(/images/default.jpg)`,\n                backgroundSize: \"contain\",\n                width: \"128px\",\n                height: \"128px\",\n                margin: \"8px\",\n                float: \"left\",\n                cursor: \"pointer\",\n                filter: image.nsfw ? \"blur(8px)\" : undefined,\n            }}\n            onClick={() => onClick && onClick(image)}\n        >\n            {hover && <div style={{\n                background: \"rgba(255, 255, 255, 0.5)\",\n                color: \"black\",\n                width: \"100%\",\n                height: \"100%\",\n                lineHeight: \"1\"\n            }}>\n                {label}\n            </div>}\n            {!hover && image.status === ImageStatusEnum.Pending && <div style={{\n                background: \"rgba(255, 255, 255, 0.3)\",\n                color: \"#555\",\n                width: \"100%\",\n                height: \"100%\",\n                fontSize: \"80px\"\n            }}>\n                {/* pending / wait symbol */}\n                <i style={{marginTop: \"20px\"}} className=\"fa fa-hourglass-half\"></i>\n            </div>}\n            {\n                !hover && image.status === ImageStatusEnum.Processing && <div style={{\n                    background: \"rgba(255, 255, 255, 0.3)\",\n                    color: \"#555\",\n                    width: \"100%\",\n                    height: \"100%\",\n                    fontSize: \"80px\"\n                }}>\n                    <i style={{marginTop: \"20px\"}} className=\"fa fa-cog fa-spin\"></i>\n                </div>\n            }\n        </div>\n    );\n};\n","import React, { FC, useEffect, useState } from \"react\";\nimport { AIBrushApi, Image } from \"../client\";\nimport moment from \"moment\";\nimport { ImageThumbnail } from \"../components/ImageThumbnail\";\nimport { useHistory } from \"react-router-dom\";\n\ninterface Props {\n    api: AIBrushApi;\n    assetsUrl: string;\n}\n\nexport const DeletedImages: FC<Props> = ({ api, assetsUrl }) => {\n    const [images, setImages] = useState<Image[]>([]);\n\n    const history = useHistory();\n\n    const loadImages = async () => {\n        const cursor = moment().add(-24, \"hours\").valueOf();\n        // TODO: special api call for deleted images?\n        const resp = await api.listImages(cursor, \"\", 100, \"asc\");\n        setImages(\n            (resp.data.images?.filter((image) => !!image.deleted_at) || []).sort(\n                (a, b) => {\n                    if (a.deleted_at && b.deleted_at) {\n                        return b.deleted_at - a.deleted_at;\n                    }\n                    return 0;\n                }\n            )\n        );\n    };\n\n    const onDeleteImage = async (image: Image) => {\n        setImages(images.filter((i) => i.id !== image.id));\n        await api.deleteImage(image.id);\n    };\n\n    const onRestoreImage = async (image: Image) => {\n        setImages(images.filter((i) => i.id !== image.id));\n        await api.updateImage(image.id, { deleted_at: null });\n    };\n\n    useEffect(() => {\n        loadImages();\n    }, [api]);\n\n    return (\n        <div>\n            {/* table made of divs */}\n            {/* imagethumbnail, phrases, action */}\n            <div>\n                {/* <div style={{ marginBottom: \"8px\" }}>\n                    <div style={{ display: \"inline-block\", width: \"200px\" }}>\n                        Image\n                    </div>\n                    <div style={{ display: \"inline-block\", width: \"200px\" }}>\n                        Action\n                    </div>\n                </div> */}\n                <div className=\"row\">\n                    <div className=\"col-12\">\n                        <h1 style={{ fontSize: \"40px\", textAlign: \"left\" }}>\n                            <i\n                                style={{ cursor: \"pointer\" }}\n                                onClick={() => history.goBack()}\n                                className=\"fas fa-chevron-left\"\n                            ></i>\n                            &nbsp; Deleted Images\n                        </h1>\n                    </div>\n                </div>\n                <div className=\"row\" style={{marginTop: \"32px\"}}>\n                    <div className=\"col-sm-2 offset-sm-2\">Image</div>\n                    <div className=\"col-sm-8\">Action</div>\n                </div>\n                {images.map((image) => (\n                    <div\n                        className=\"row\"\n                        style={{\n                            marginTop: \"16px\",\n                            borderBottom: \"1px solid #303030\",\n                        }}\n                    >\n                        <div className=\"col-sm-2 offset-sm-2\">\n                            <ImageThumbnail\n                                assetsUrl={assetsUrl}\n                                image={image}\n                            />\n                        </div>\n                        <div\n                            className=\"col-sm-8\"\n                            style={{\n                                paddingTop: \"64px\",\n                                paddingBottom: \"64px\",\n                            }}\n                        >\n                            <button\n                                className=\"btn btn-danger btn-sm image-popup-delete-button\"\n                                onClick={() => onDeleteImage(image)}\n                                style={{\n                                    marginRight: \"8px\",\n                                }}\n                            >\n                                <i className=\"fa fa-trash\"></i>&nbsp;Delete\n                            </button>\n                            <button\n                                className=\"btn btn-primary btn-sm image-popup-restore-button\"\n                                onClick={() => onRestoreImage(image)}\n                            >\n                                <i className=\"fa fa-undo\"></i>&nbsp;Restore\n                            </button>\n                        </div>\n                    </div>\n                ))}\n            </div>\n        </div>\n    );\n};\n","import React, { FC, useEffect, useRef, useState } from \"react\";\nimport { Modal } from \"react-bootstrap\";\nimport { CreateImageInput, Image, ImageStatusEnum } from \"../client/api\";\nimport { getUpscaleLevel } from \"../lib/upscale\";\n\ninterface ImagePopupProps {\n    assetsUrl: string;\n    image: Image;\n    onClose: () => void;\n    onDelete?: (image: Image) => void;\n    onFork?: (image: Image) => void;\n    onEdit?: (image: Image) => void;\n    onUpscale?: (image: Image) => void;\n    onNSFW?: (image: Image, nsfw: boolean) => void;\n}\n\nexport const ImagePopup: FC<ImagePopupProps> = ({\n    assetsUrl,\n    image,\n    onClose,\n    onDelete,\n    onFork,\n    onEdit,\n    onUpscale,\n    onNSFW,\n}) => {\n    const img = useRef<HTMLImageElement>(null);\n    const src = `${assetsUrl}/${image.id}.image.jpg?updated_at=${image.updated_at}`;\n    let score = image.score;\n    if (\n        image.negative_phrases.join(\"\").trim() !== \"\" &&\n        image.negative_score != 0\n    ) {\n        score -= image.negative_score;\n    }\n    const [showNSFW, setShowNSFW] = useState(false);\n\n    const statusBadge = (status: string) => {\n        const displayStatus = status.charAt(0).toUpperCase() + status.slice(1);\n        let icon = \"fa fa-question-circle\";\n        switch (status) {\n            case ImageStatusEnum.Pending:\n                icon = \"fas fa-hourglass-half\";\n                break;\n            case ImageStatusEnum.Processing:\n                icon = \"fas fa-cog fa-spin\";\n                break;\n            case ImageStatusEnum.Completed:\n                icon = \"fas fa-check\";\n                break;\n            case ImageStatusEnum.Error:\n                icon = \"fas fa-exclamation-circle\";\n                break;\n        }\n        return (\n            <>\n                <span style={{ fontSize: \"24px\" }}>\n                    <i\n                        className={`${icon} status-badge status-badge-${status}`}\n                        style={{\n                            fontSize: \"10px\",\n                            position: \"relative\",\n                            top: \"-1px\",\n                        }}\n                    ></i>\n                    &nbsp;{displayStatus}\n                </span>\n            </>\n        );\n    };\n\n    useEffect(() => {\n        if (!img.current) {\n            return;\n        }\n        img.current.onerror = () => {\n            if (!img.current) {\n                return;\n            }\n            img.current.src = \"/images/default.jpg\";\n        };\n    }, [img]);\n\n    let title = image.label;\n    if (!title) {\n        title = image.phrases[0];\n    }\n\n    const upscaleLevel = getUpscaleLevel(image.width!, image.height!);\n\n    // if open, show modal with image\n    return (\n        <Modal show={true} onHide={onClose} size=\"xl\">\n            <Modal.Header closeButton>\n                <Modal.Title>{title}</Modal.Title>\n            </Modal.Header>\n            <Modal.Body>\n                <img\n                    ref={img}\n                    style={{\n                        maxWidth: \"100%\",\n                        maxHeight: \"1024px\",\n                        display: \"block\",\n                        marginLeft: \"auto\",\n                        marginRight: \"auto\",\n                        filter: image.nsfw && !showNSFW ? \"blur(30px)\" : \"\",\n                    }}\n                    id={`image-popup-${image.id}`}\n                    src={src}\n                    alt={image.label}\n                />\n                {/* List these fields: status, iterations, phrases */}\n                <div className=\"row\">\n                    <div className=\"col-lg-12\"></div>\n                </div>\n                {/* controls */}\n                <div className=\"row\">\n                    <div className=\"col-lg-12\">\n                        <div\n                            className=\"image-popup-controls\"\n                            style={{ marginTop: \"40px\" }}\n                        >\n                            {statusBadge(image.status)}\n                            <div style={{ float: \"right\" }}>\n                                {onFork &&\n                                    (image.status === ImageStatusEnum.Saved ||\n                                        image.status ===\n                                            ImageStatusEnum.Completed) && (\n                                        <button\n                                            className=\"btn btn-secondary btn-sm image-popup-button\"\n                                            onClick={() => onFork(image)}\n                                            style={{ marginRight: \"5px\" }}\n                                        >\n                                            <i className=\"fas fa-code-branch\"></i>\n                                            &nbsp;VARIATIONS\n                                        </button>\n                                    )}\n                                {onDelete && (\n                                    <button\n                                        className=\"btn btn-danger btn-sm image-popup-delete-button\"\n                                        onClick={() =>\n                                            onDelete && onDelete(image)\n                                        }\n                                        style={{ marginRight: \"5px\" }}\n                                    >\n                                        <i className=\"fas fa-trash-alt\"></i>\n                                        &nbsp;DELETE\n                                    </button>\n                                )}\n                                {onEdit && (\n                                    <button\n                                        className=\"btn btn-primary btn-sm image-popup-button\"\n                                        onClick={() => onEdit && onEdit(image)}\n                                        style={{ marginRight: \"5px\" }}\n                                    >\n                                        <i className=\"fas fa-edit\"></i>\n                                        &nbsp;EDIT\n                                    </button>\n                                )}\n                                {onUpscale && upscaleLevel < 2 && (\n                                    <button\n                                        className=\"btn btn-primary btn-sm image-popup-button\"\n                                        onClick={() =>\n                                            onUpscale && onUpscale(image)\n                                        }\n                                        style={{ marginRight: \"5px\" }}\n                                    >\n                                        <i className=\"fas fa-search-plus\"></i>\n                                        &nbsp;UPSCALE\n                                    </button>\n                                )}\n                                {image.nsfw && (\n                                    <button\n                                        className=\"btn btn-primary btn-sm image-popup-button\"\n                                        onClick={() => setShowNSFW(!showNSFW)}\n                                        style={{ marginRight: \"5px\" }}\n                                    >\n                                        <i className=\"fas fa-eye\"></i>\n                                        &nbsp;{showNSFW ? \"HIDE\" : \"SHOW\"}\n                                    </button>\n                                )}\n                            </div>\n                        </div>\n                        <div\n                            className=\"image-popup-controls\"\n                            style={{ marginTop: \"28px\", marginBottom: \"85px\" }}\n                        >\n                            <div>\n                                Similarity to prompt: {(score * 200).toFixed(2)}\n                                %\n                            </div>\n                            <div>\n                                Image dimensions: {image.width} x {image.height}\n                            </div>\n                            {image.nsfw && (\n                                <>\n                                    <div>\n                                        {/* alert warning icon */}\n                                        <i\n                                            className=\"fas fa-exclamation-triangle\"\n                                            style={{\n                                                color: \"orange\",\n                                                fontSize: \"18px\",\n                                                position: \"relative\",\n                                                top: \"2px\",\n                                            }}\n                                        ></i>\n                                        &nbsp;May contain NSFW content\n                                    </div>\n                                    {onNSFW && (\n                                        <a\n                                            href=\"javascript:void(0)\"\n                                            onClick={() =>\n                                                onNSFW(image, false)\n                                            }\n                                        >\n                                            Mark as Safe for Work\n                                        </a>\n                                    )}\n                                </>\n                            )}\n                            {!image.nsfw && (\n                                <>\n                                    <div>\n                                        {/* green check icon */}\n                                        <i\n                                            className=\"fas fa-check\"\n                                            style={{\n                                                color: \"green\",\n                                                fontSize: \"18px\",\n                                                position: \"relative\",\n                                                top: \"2px\",\n                                            }}\n                                        ></i>\n                                        &nbsp;Safe for Work\n                                    </div>\n                                    {onNSFW && (\n                                        <a\n                                            href=\"javascript:void(0)\"\n                                            onClick={() =>\n                                                onNSFW(image, true)\n                                            }\n                                        >\n                                            Mark as Not Safe for Work\n                                        </a>\n                                    )}\n                                </>\n                            )}\n                        </div>\n                    </div>\n                </div>\n            </Modal.Body>\n        </Modal>\n    );\n};\n","import React, { FC, useEffect, useRef, useState } from \"react\";\nimport { Modal } from \"react-bootstrap\";\nimport { propTypes } from \"react-bootstrap/esm/Image\";\n\ninterface Props {\n    show: boolean;\n    title?: string;\n}\n\n// Show modal with child contents\nexport const BusyModal: FC<Props> = ({ show, title, children }) => {\n    return (\n        <Modal show={show} backdrop=\"static\" keyboard={false}>\n            <Modal.Header closeButton>\n                <Modal.Title>{title || \"Processing\"}</Modal.Title>\n            </Modal.Header>\n            <Modal.Body>\n                <div className=\"d-flex justify-content-center\">\n                    <div className=\"spinner-border\" role=\"status\">\n                        <span className=\"sr-only\">{children || \"Please Wait...\"}</span>\n                    </div>\n                </div>\n            </Modal.Body>\n        </Modal>\n    );\n}","import React, { FC, useEffect, useState } from \"react\";\nimport moment from \"moment\";\nimport { Image, ImageStatusEnum } from \"../client/api\";\n\ninterface Props {\n    pendingCount: number;\n    processingCount: number;\n    onClick?: () => void;\n}\n\nexport const PendingImagesThumbnail: FC<Props> = ({\n    pendingCount,\n    processingCount,\n    onClick,\n}) => {\n    const [hover, setHover] = useState(false);\n\n    // on mouse in/out, set hover state\n    const onMouseEnter = () => setHover(true);\n    const onMouseLeave = () => setHover(false);\n    let icon = (\n        <i style={{ marginTop: \"20px\" }} className=\"fa fa-hourglass-half\"></i>\n    );\n\n    if (processingCount > 0) {\n        icon = (\n            <i style={{ marginTop: \"20px\" }} className=\"fa fa-cog fa-spin\"></i>\n        );\n    }\n\n    return (\n        <div\n            onMouseEnter={onMouseEnter}\n            onMouseLeave={onMouseLeave}\n            style={{\n                backgroundImage: `url(/images/default.jpg)`,\n                backgroundSize: \"contain\",\n                width: \"128px\",\n                height: \"128px\",\n                margin: \"8px\",\n                float: \"left\",\n                cursor: \"pointer\",\n            }}\n            onClick={onClick}\n        >\n            {hover && (\n                <div\n                    style={{\n                        background: \"rgba(255, 255, 255, 0.5)\",\n                        color: \"black\",\n                        width: \"100%\",\n                        height: \"100%\",\n                        lineHeight: \"1\",\n                        fontSize: \"20px\",\n                    }}\n                >\n                    <br/>\n                    {pendingCount > 0 && (\n                        <div style={{ marginBottom: \"24px\" }}>\n                            {pendingCount} pending\n                        </div>\n                    )}\n                    {processingCount > 0 && (\n                        <div>{processingCount} processing</div>\n                    )}\n                </div>\n            )}\n            {!hover && (\n                <div\n                    style={{\n                        background: \"rgba(255, 255, 255, 0.3)\",\n                        color: \"#555\",\n                        width: \"100%\",\n                        height: \"100%\",\n                        fontSize: \"80px\",\n                    }}\n                >\n                    {icon}\n                </div>\n            )}\n        </div>\n    );\n};\n","import React, {FC, useEffect, useState} from \"react\";\nimport { Modal } from \"react-bootstrap\";\nimport { Image } from \"../client/api\";\n\ninterface Props {\n    images: Image[];\n    onDeleteImage: (image: Image) => void;\n    onCancel: () => void;\n    show: boolean;\n}\n\nexport const PendingImages: FC<Props> = ({\n    images,\n    onDeleteImage,\n    onCancel,\n    show,\n}) => {\n\n    function imageIcon(image: Image) {\n        if (image.status === \"pending\") {\n            return <i className=\"fa fa-hourglass-half\"></i>;\n        } else if (image.status === \"processing\") {\n            return <i className=\"fa fa-cog fa-spin\"></i>;\n        }\n    }\n\n    const truncate = (phrases: string) => {\n        if (phrases.length > 35) {\n            return phrases.substring(0, 35) + \"...\";\n        }\n        return phrases;\n    }\n\n    // refactor from table to div layout\n    const pendingDiv = (\n        <div>\n            <div style={{marginBottom: \"8px\"}}>\n                <div style={{display: \"inline-block\", width: \"100px\"}}>\n                    Status\n                </div>\n                <div style={{display: \"inline-block\", width: \"250px\"}}>\n                    Phrases\n                </div>\n                <div style={{display: \"inline-block\", width: \"100px\"}}>\n                    Action\n                </div>\n            </div>\n            {images.map((image) => (\n                <div key={image.id} style={{marginBottom: \"8px\"}}>\n                    <div style={{display: \"inline-block\", width: \"100px\"}}>\n                        {imageIcon(image)}&nbsp;{image.status}\n                    </div>\n                    <div style={{display: \"inline-block\", width: \"250px\"}}>\n                        {/* if more than 30 chars, truncate with ellipsis*/}\n                        {truncate(image.phrases.join(\", \"))}\n                    </div>\n                    <div style={{display: \"inline-block\", width: \"100px\"}}>\n                        <button\n                            className=\"btn btn-danger btn-sm image-popup-delete-button\"\n                            onClick={() => onDeleteImage(image)}\n                        >\n                            <i className=\"fa fa-trash\"></i>&nbsp;Delete\n                        </button>\n                    </div>\n                </div>\n            ))}\n        </div>\n    );\n\n    return (\n        <Modal show={show} onHide={onCancel}>\n            <Modal.Header closeButton>\n                <Modal.Title>Pending Images</Modal.Title>\n            </Modal.Header>\n            <Modal.Body>\n                {pendingDiv}\n            </Modal.Body>\n            <Modal.Footer>\n                <button className=\"btn btn-secondary\" onClick={onCancel}>\n                    Close\n                </button>\n            </Modal.Footer>\n        </Modal>\n    );\n};","// V2 page\nimport React, { FC, useState, useEffect } from \"react\";\nimport { useParams, useHistory, Link } from \"react-router-dom\";\nimport moment from \"moment\";\nimport ScrollToTop from \"react-scroll-to-top\";\nimport { AIBrushApi } from \"../client\";\nimport { CreateImageInput, Image, ImageStatusEnum } from \"../client/api\";\nimport { ImageThumbnail } from \"../components/ImageThumbnail\";\nimport { ImagePrompt, defaultArgs } from \"../components/ImagePrompt\";\n\nimport InfiniteScroll from \"react-infinite-scroll-component\";\nimport { ImagePopup } from \"../components/ImagePopup\";\nimport { BusyModal } from \"../components/BusyModal\";\nimport { PendingImagesThumbnail } from \"../components/PendingImagesThumbnail\";\nimport { PendingImages } from \"../components/PendingImages\";\n\ninterface Props {\n    api: AIBrushApi;\n    assetsUrl: string;\n}\n\nexport const Homepage: FC<Props> = ({ api, assetsUrl }) => {\n    const [creating, setCreating] = useState(false);\n    const [selectedImage, setSelectedImage] = useState<Image | null>(null);\n    const [parentImage, setParentImage] = useState<Image | null>(null);\n\n    const [showPendingImages, setShowPendingImages] = useState(false);\n\n    const [images, setImages] = useState<Array<Image>>([]);\n    const [err, setErr] = useState<string | null>(null);\n    const [hasMore, setHasMore] = useState<boolean>(true);\n    const [search, setSearch] = useState<string>(\"\");\n    const [searchDebounce, setSearchDebounce] = useState<string>(\"\");\n\n    const { id } = useParams<{ id?: string }>();\n    const history = useHistory();\n\n    useEffect(() => {\n        let handle = setTimeout(() => {\n            setSearch(searchDebounce);\n        }, 500);\n        return () => {\n            clearTimeout(handle);\n        };\n    }, [searchDebounce]);\n\n    useEffect(() => {\n        if (id) {\n            // check if the image is already loaded\n            const image = images.find((image) => image.id === id);\n            if (image) {\n                setSelectedImage(image);\n            }\n            // refresh\n            api.getImage(id).then((image) => {\n                setSelectedImage(image.data);\n            });\n        } else {\n            setSelectedImage(null);\n        }\n    }, [id]);\n\n    const onSubmit = async (input: CreateImageInput) => {\n        setCreating(true);\n        setParentImage(null);\n        setErr(null);\n        window.scrollTo(0, 0);\n        try {\n            await api.createImage(input);\n        } catch (e: any) {\n            console.error(e);\n            setErr(\"Error creating image\");\n        } finally {\n            setCreating(false);\n        }\n    };\n\n    const onEditNewImage = async (input: CreateImageInput) => {\n        setCreating(true);\n        setParentImage(null);\n        setErr(null);\n        window.scrollTo(0, 0);\n        try {\n            const newImages = await api.createImage(input);\n            if (newImages.data.images) {\n                const image = newImages.data.images![0];\n                history.push(`/image-editor/${image.id}`);\n            }\n        } catch (e: any) {\n            console.error(e);\n            setErr(\"Error creating image\");\n        } finally {\n            setCreating(false);\n        }\n    };\n\n    const onNSFW = (image: Image, nsfw: boolean) => {\n        api.updateImage(image.id, { nsfw }).then((res) => {\n            setImages((images) => {\n                return images.map((i) => {\n                    if (i.id === image.id) {\n                        return res.data;\n                    }\n                    return i;\n                });\n            });\n            setSelectedImage(res.data);\n        });\n    };\n\n    const onUpscale = async (image: Image) => {\n        setCreating(true);\n        setErr(null);\n        window.scrollTo(0, 0);\n        try {\n            const imageInput = defaultArgs();\n            imageInput.parent = image.id;\n            imageInput.label = image.label;\n            imageInput.phrases = image.phrases;\n            imageInput.negative_phrases = image.negative_phrases;\n            imageInput.width = image.width! * 2;\n            imageInput.height = image.height! * 2;\n            imageInput.model = \"swinir\";\n            imageInput.count = 1;\n\n            const newImages = await api.createImage(imageInput);\n            setImages((images) => {\n                // there is a race condition where poll images can fire before this callback\n                // so double-check to avoid duplicates\n                const imagesToAdd = (newImages.data.images || []).filter(\n                    (image) => {\n                        return !images.find((i) => i.id === image.id);\n                    }\n                );\n                return [...imagesToAdd, ...images].sort(sortImages);\n            });\n            history.push(\"/\");\n        } catch (e: any) {\n            console.error(e);\n            setErr(\"Error creating image\");\n        } finally {\n            setCreating(false);\n        }\n    };\n\n    useEffect(() => {\n        if (!api) {\n            return;\n        }\n        const loadImages = async () => {\n            console.log(\"Initial load images\");\n            // clear error\n            setErr(null);\n            setHasMore(true);\n            try {\n                const cursor = moment().add(1, \"minutes\").valueOf();\n                const resp = await api.listImages(cursor, search, 100, \"desc\");\n                if (resp.data.images) {\n                    console.log(\"Initial load images\", resp.data.images.length);\n                    setImages(\n                        resp.data.images\n                            .filter((image) => !image.deleted_at)\n                            .sort(sortImages)\n                    );\n                }\n                return 0;\n            } catch (err) {\n                setErr(\"Could not load images\");\n                console.error(err);\n            }\n        };\n        loadImages();\n    }, [api, search]);\n\n    useEffect(() => {\n        if (!api) {\n            return;\n        }\n\n        const pollImages = async (images: Array<Image>) => {\n            // clear error\n            setErr(null);\n            // set cursor to max updated_at from images\n            const cursor = images.reduce((max, image) => {\n                return Math.max(max, image.updated_at);\n            }, 0);\n\n            try {\n                const resp = await api.listImages(\n                    cursor + 1,\n                    search,\n                    100,\n                    \"asc\"\n                );\n                if (resp.data.images) {\n                    // split resp.data.images into \"new\" and \"updated\" lists\n                    // image is \"new\" if it's not in images\n                    const newImages = resp.data.images.filter((image) => {\n                        return images.findIndex((i) => i.id === image.id) < 0;\n                    });\n                    const updatedImages = resp.data.images.filter((image) => {\n                        return images.findIndex((i) => i.id === image.id) >= 0;\n                    });\n                    setImages((images) => {\n                        const deletedIds: { [key: string]: boolean } = {};\n                        for (let image of newImages) {\n                            if (image.deleted_at) {\n                                deletedIds[image.id] = true;\n                                console.log(\n                                    `Deleting image ${image.id} from list`\n                                );\n                            }\n                        }\n                        for (let image of updatedImages) {\n                            if (image.deleted_at) {\n                                deletedIds[image.id] = true;\n                                console.log(\n                                    `Deleting image ${image.id} from list`\n                                );\n                            }\n                        }\n                        images = images.filter(\n                            (image) => !deletedIds[image.id]\n                        );\n                        return [\n                            ...images.map((image) => {\n                                const updatedImage = updatedImages.find(\n                                    (i) => i.id === image.id\n                                );\n                                if (updatedImage) {\n                                    return updatedImage;\n                                }\n                                return image;\n                            }),\n                            ...newImages.filter((image) => !image.deleted_at),\n                        ].sort(sortImages);\n                    });\n                }\n                return images;\n            } catch (err) {\n                setErr(\"Could not load images\");\n                console.error(err);\n            }\n        };\n\n        const timerHandle = setInterval(() => {\n            pollImages(images);\n        }, 5000);\n        return () => {\n            clearInterval(timerHandle);\n        };\n    }, [api, images, search]);\n\n    useEffect(() => {\n        // de-duplicate images by id\n        // first check if there are any duplicates\n        // I know, I should figure out where the duplicates are coming from,\n        // but I'm lazy.\n        const ids = images.map((image) => image.id);\n        const uniqueIds = new Set(ids);\n        if (ids.length !== uniqueIds.size) {\n            setImages((images) => {\n                // there are duplicates\n                const uniqueImages = images.filter((image, index) => {\n                    return ids.indexOf(image.id) === index;\n                });\n                return uniqueImages.sort(sortImages);\n            });\n        }\n    }, [images]);\n\n    const isPendingOrProcessing = (image: Image) => {\n        return (\n            image.status === ImageStatusEnum.Pending ||\n            image.status === ImageStatusEnum.Processing\n        );\n    };\n\n    const sortImages = (a: Image, b: Image) => {\n        // pending and processing images always come first\n        if (isPendingOrProcessing(a) && !isPendingOrProcessing(b)) {\n            return -1;\n        } else if (!isPendingOrProcessing(a) && isPendingOrProcessing(b)) {\n            return 1;\n        }\n        // if the parent is the same, sort by score descending\n        // otherwise, sort by updated_at\n        if (\n            a.parent === b.parent &&\n            a.phrases.join(\"|\") == b.phrases.join(\"|\") &&\n            a.status !== ImageStatusEnum.Pending &&\n            b.status !== ImageStatusEnum.Pending\n        ) {\n            // if the score is the same, sort by updated_at\n            let aScore = a.score;\n            let bScore = b.score;\n            // working around a bug where negative score was assigned\n            // for an empty negative prompt.\n            if (a.phrases.join(\"\").trim() !== \"\") {\n                aScore = aScore - a.negative_score;\n            }\n            if (b.phrases.join(\"\").trim() !== \"\") {\n                bScore = bScore - b.negative_score;\n            }\n            if (aScore == bScore) {\n                return b.updated_at - a.updated_at;\n            }\n            return bScore - aScore;\n        }\n\n        return b.updated_at - a.updated_at;\n    };\n\n    const onLoadMore = async () => {\n        // get the minimum updated_at from images\n        let minUpdatedAt = moment().valueOf();\n        images.forEach((image) => {\n            minUpdatedAt = Math.min(minUpdatedAt, image.updated_at);\n        });\n        // load images in descending order from updated_at\n        const resp = await api.listImages(\n            minUpdatedAt - 1,\n            search,\n            100,\n            \"desc\"\n        );\n        if (resp.data.images && resp.data.images.length > 0) {\n            // combine images with new images and sort by updated_at descending\n            setImages((images) =>\n                [...images, ...(resp.data.images || [])]\n                    .filter((image) => !image.deleted_at)\n                    .sort(sortImages)\n            );\n        } else {\n            setHasMore(false);\n        }\n    };\n\n    const onDelete = async (image: Image) => {\n        try {\n            await api.deleteImage(image.id);\n        } catch (e) {\n            console.error(e);\n            setErr(\"Error deleting image\");\n        }\n    };\n\n    const onFork = async (image: Image) => {\n        setParentImage(image);\n        // setSelectedImage(null);\n        history.push(\"/\");\n        window.scrollTo(0, 0);\n    };\n\n    const onEdit = async (image: Image) => {\n        history.push(`/image-editor/${image.id}`);\n    };\n\n    const onThumbnailClicked = (image: Image) => {\n        // setSelectedImage(image);\n        history.push(`/images/${image.id}`);\n    };\n\n    const handleCancelFork = () => {\n        setParentImage(null);\n        window.scrollTo(0, 0);\n    };\n\n    const completedOrSavedImages = images.filter((image) => {\n        return (\n            image.status === ImageStatusEnum.Completed ||\n            image.status === ImageStatusEnum.Saved\n        );\n    });\n\n    const pendingOrProcessingImages = images.filter(\n        (image) =>\n            image.status === ImageStatusEnum.Pending ||\n            image.status === ImageStatusEnum.Processing\n    );\n\n    const pendingImages = pendingOrProcessingImages.filter(\n        (image) => image.status === ImageStatusEnum.Pending\n    );\n\n    const processingImages = pendingOrProcessingImages.filter(\n        (image) => image.status === ImageStatusEnum.Processing\n    );\n\n    return (\n        <>\n            <h1 style={{ fontSize: \"40px\", textAlign: \"left\" }}>\n                Welcome to AiBrush\n            </h1>\n\n            <ImagePrompt\n                assetsUrl={assetsUrl}\n                creating={creating}\n                onSubmit={onSubmit}\n                onEdit={onEditNewImage}\n                parent={parentImage}\n                onCancel={() => handleCancelFork()}\n            />\n            <hr />\n\n            <div className=\"homepage-images\" style={{ marginTop: \"48px\" }}>\n                <div style={{ textAlign: \"left\" }}>\n                    <div className=\"input-group\" style={{marginBottom: \"16px\"}}>\n                        <input\n                            style={{\n                                // marginBottom: \"16px\",\n                                color: \"white\",\n                                backgroundColor: \"black\",\n                                border: \"1px solid white\",\n                                // paddingLeft: \"30px\",\n                                width: \"80%\",\n                                marginRight: \"16px\",\n                            }}\n                            value={searchDebounce}\n                            type=\"search\"\n                            className=\"form-control\"\n                            placeholder=\"Search...\"\n                            onChange={(e) => setSearchDebounce(e.target.value)}\n                        />\n\n                        <div\n                            style={{\n                                float: \"right\",\n                            }}\n                        >\n                            <Link to=\"/deleted-images\">\n                                {/* <i className=\"fas fa-trash\" style={{color: \"white\"}}></i> */}\n                                <button className=\"btn btn-danger image-popup-delete-button\">\n                                    <i className=\"fas fa-trash\"></i> Trash\n                                </button>\n                            </Link>\n                        </div>\n                    </div>\n                </div>\n                <InfiniteScroll\n                    dataLength={images.length}\n                    next={onLoadMore}\n                    hasMore={hasMore}\n                    loader={<h4>Loading...</h4>}\n                >\n                    {pendingOrProcessingImages.length > 0 && (\n                        <PendingImagesThumbnail\n                            pendingCount={\n                                pendingImages.length\n                            }\n                            processingCount={processingImages.length}\n                            onClick={() => {\n                                setShowPendingImages(true);\n                            }}\n                        />\n                    )}\n                    {completedOrSavedImages.map((image) => (\n                        <ImageThumbnail\n                            key={image.id}\n                            image={image}\n                            assetsUrl={assetsUrl}\n                            onClick={onThumbnailClicked}\n                        />\n                    ))}\n                </InfiniteScroll>\n            </div>\n\n            {selectedImage && (\n                <ImagePopup\n                    assetsUrl={assetsUrl}\n                    image={selectedImage}\n                    onClose={() => history.push(\"/\")}\n                    onDelete={(image) => {\n                        onDelete(image);\n                        setImages(images.filter((i) => i.id !== image.id));\n                        history.push(\"/\");\n                    }}\n                    onFork={(image) => {\n                        onFork(image);\n                        history.push(\"/\");\n                    }}\n                    onEdit={(image) => {\n                        onEdit(image);\n                    }}\n                    onUpscale={(image) => {\n                        onUpscale(image);\n                    }}\n                    onNSFW={onNSFW}\n                />\n            )}\n            <ScrollToTop />\n            <BusyModal show={creating} title=\"Creating images\">\n                <p>Please wait while we create your image.</p>\n            </BusyModal>\n            <PendingImages\n                images={pendingOrProcessingImages}\n                onCancel={() => setShowPendingImages(false)}\n                show={showPendingImages}\n                onDeleteImage={(image) => {\n                    onDelete(image);\n                    setImages(images.filter((i) => i.id !== image.id));\n                }}\n            />\n        </>\n    );\n};\n","import React, { useState, useEffect } from \"react\";\nimport * as axios from \"axios\";\nimport { BrowserRouter, Switch, Route, Link } from \"react-router-dom\";\nimport \"./App.css\";\nimport \"./bootstrap.min.css\";\nimport { AIBrushApi, LoginResult, FeatureList } from \"./client/api\";\nimport { getConfig } from \"./config\";\nimport { Login } from \"./pages/Login\";\nimport { TokenRefresher } from \"./components/TokenRefresher\";\nimport { Healthchecker } from \"./components/Healthchecker\";\nimport { WorkerConfigPage } from \"./pages/WorkerConfig\";\nimport { Admin } from \"./pages/admin/Admin\";\nimport { ImageEditor } from \"./pages/image-editor/ImageEditor\";\nimport { DeletedImages } from \"./pages/DeletedImages\";\n\n// V2 UI\nimport { Homepage } from \"./pages/Homepage\";\n\nconst config = getConfig();\nconst httpClient = axios.default;\nconst client = new AIBrushApi(\n  undefined,\n  localStorage.getItem(\"apiUrl\") || config.apiUrl,\n  httpClient\n);\n\nfunction updateHttpClient(loginResult: LoginResult) {\n  if (loginResult.accessToken) {\n    httpClient.defaults.headers.common[\n      \"Authorization\"\n    ] = `Bearer ${loginResult.accessToken}`;\n  }\n}\n\nfunction App() {\n  const [credentials, setCredentials] = useState<LoginResult | null>(null);\n  const [assetsUrl, setAssetsUrl] = useState<string>(\"/api/images\");\n  const [isAdmin, setIsAdmin] = useState<boolean>(false);\n  const [features, setFeatures] = useState<FeatureList | null>(null);\n\n  const onLogout = () => {\n    setCredentials(null);\n    localStorage.removeItem(\"credentials\");\n    httpClient.defaults.headers.common[\"Authorization\"] = undefined;\n  };\n\n  const init = async () => {\n    console.log(\"App.init\");\n    client\n      .getAssetsUrl()\n      .then((result) => setAssetsUrl(result.data.assets_url));\n    client.getFeatures().then((result) => setFeatures(result.data));\n    const storedCredentials = localStorage.getItem(\"credentials\");\n    if (storedCredentials) {\n      // attempt to refresh token\n      try {\n        const credentials = JSON.parse(storedCredentials) as LoginResult;\n        const result = await client.refresh({\n          refreshToken: credentials.refreshToken,\n        });\n        setCredentials(result.data);\n        // save to storage\n        localStorage.setItem(\"credentials\", JSON.stringify(result.data));\n        updateHttpClient(result.data);\n        const isAdmin = await client.isAdmin();\n        setIsAdmin(!!isAdmin.data.is_admin);\n      } catch (e) {\n        console.log(e);\n      }\n    }\n  };\n\n  const onLogin = async (credentials: LoginResult) => {\n    localStorage.setItem(\"credentials\", JSON.stringify(credentials));\n    setCredentials(credentials);\n    updateHttpClient(credentials);\n  };\n\n  useEffect(() => {\n    init();\n  }, []);\n\n  return (\n    <div className=\"App\">\n      <TokenRefresher\n        api={client}\n        credentials={credentials as LoginResult}\n        onCredentialsRefreshed={onLogin}\n      />\n      <Healthchecker api={client} />\n\n      <BrowserRouter>\n        {/* if credentials are not set, show Login component */}\n        {!credentials && (\n          <Login httpClient={httpClient} client={client} onLogin={onLogin} />\n        )}\n        {credentials && <div className=\"container\">\n          <div className=\"row\">\n            <div className=\"col-lg-12\">\n              {/* if credentials are set, show a bootstrap logout button a the far top right corner div */}\n              {credentials && (\n                <>\n                  <button\n                    className=\"btn btn-primary top-button\"\n                    onClick={() => onLogout()}\n                  >\n                    {/* font awesome logout icon */}\n                    <i className=\"fas fa-sign-out-alt\"></i>\n                  </button>\n                  {/* home button */}\n                  <Link className=\"btn btn-primary top-button\" to=\"/\">\n                    {/* font awesome home icon */}\n                    <i className=\"fas fa-home\"></i>\n                  </Link>\n                  {/* Link to github project at https://github.com/wolfgangmeyers/aibrush-2 */}\n                  <a\n                    className=\"btn btn-primary top-button\"\n                    href=\"https://github.com/wolfgangmeyers/aibrush-2\"\n                    target=\"_blank\"\n                  >\n                    {/* font awesome github icon */}\n                    <i className=\"fab fa-github\"></i>\n                  </a>\n                </>\n              )}\n            </div>\n          </div>\n\n          {/* if credentials are set, show the rest of the app */}\n          \n          <Switch>\n            <Route path=\"/\" exact={true}>\n              {/* <MainMenu isAdmin={isAdmin} /> */}\n              <Homepage api={client} assetsUrl={assetsUrl} />\n            </Route>\n            <Route path=\"/images/:id\">\n              <Homepage api={client} assetsUrl={assetsUrl} />\n            </Route>\n            <Route path=\"/image-editor/:id\">\n              <ImageEditor api={client} assetsUrl={assetsUrl} />\n            </Route>\n            <Route path=\"/worker-config\">\n              <WorkerConfigPage api={client} />\n            </Route>\n            <Route path=\"/deleted-images\">\n              <DeletedImages api={client} assetsUrl={assetsUrl} />\n            </Route>\n            {isAdmin && (\n              <>\n                <Route path=\"/admin\">\n                  <Admin api={client} />\n                </Route>\n              </>\n            )}\n          </Switch>\n          <div className=\"row\" style={{ marginTop: \"100px\", padding: \"50px\" }}>\n            <div className=\"col-lg-12\">\n              {/* show external popout pages to terms and privacy policy, if they are present in the features */}\n              {features && features.privacy_uri && (\n                <a href={features.privacy_uri} target=\"_blank\">\n                  Privacy Policy\n                </a>\n              )}\n              {features && features.terms_uri && (\n                <a\n                  href={features.terms_uri}\n                  target=\"_blank\"\n                  style={{ marginLeft: \"20px\" }}\n                >\n                  Terms of Service\n                </a>\n              )}\n            </div>\n          </div>\n        </div>}\n      </BrowserRouter>\n    </div>\n  );\n}\n\nexport default App;\n","export interface Config {\n    apiUrl: string;\n}\n\nexport function getConfig(): Config {\n    // if (process.env.REACT_APP_ENV === \"prod\") {\n    //     return {\n    //         apiUrl: \"https://aibrush.ngrok.io\"\n    //     };\n    // } else if (process.env.REACT_APP_ENV === \"alt\") {\n    //     return {\n    //         apiUrl: \"\"\n    //     };\n    // } else {\n    //     return {\n    //         apiUrl: \"http://localhost:3000\"\n    //     };\n    // }\n    return {\n        apiUrl: \"\"\n    };\n}\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n","import { Renderer } from \"./renderer\";\n\nexport class ZoomHelper {\n\n    constructor(private renderer: Renderer) {}\n\n    onWheel(event: WheelEvent) {\n        const originalZoom = this.renderer.getZoom();\n        let zoom = this.renderer.getZoom();\n        let offsetX = this.renderer.getOffsetX();\n        let offsetY = this.renderer.getOffsetY();\n\n        let canvasPoint = this.translateMouseToCanvasCoordinates(\n            event.offsetX,\n            event.offsetY\n        );\n        // console.log(\"x: \" + x + \", y: \" + y);\n        \n        if (event.deltaY < 0) {\n            zoom += 0.1 * zoom;\n        } else {\n            zoom -= 0.1 * zoom;\n        }\n        zoom = Math.max(0.1, Math.min(zoom, 8.0));\n\n        let xDiff = canvasPoint.x - -offsetX;\n        let yDiff = canvasPoint.y - -offsetY;\n\n        // offsetX = canvasPoint.x - xDiff * (zoom / originalZoom);\n        // offsetY = canvasPoint.y - yDiff * (zoom / originalZoom);\n        offsetX -= xDiff * (zoom / originalZoom) - xDiff;\n        offsetY -= yDiff * (zoom / originalZoom) - yDiff;\n\n        this.renderer.updateZoomAndOffset(zoom, offsetX, offsetY);\n    }\n\n    onPan(event: React.MouseEvent<HTMLCanvasElement, MouseEvent>) {\n        let movementX = event.movementX;\n        let movementY = event.movementY;\n        // translate offset to canvas coordinates\n        let rect = (\n            event.target as HTMLCanvasElement\n        ).getBoundingClientRect();\n        movementX = (movementX / rect.width) * this.renderer.getWidth();\n        movementY = (movementY / rect.height) * this.renderer.getHeight();\n\n        let zoom = this.renderer.getZoom();\n        let offsetX = this.renderer.getOffsetX();\n        let offsetY = this.renderer.getOffsetY();\n\n        offsetX += movementX / zoom;\n        offsetY += movementY / zoom;\n\n        this.renderer.updateZoomAndOffset(zoom, offsetX, offsetY);\n    }\n\n    translateMouseToCanvasCoordinates(mouseX: number, mouseY: number, zoom?: number, offsetX?: number, offsetY?: number) {\n        let x = mouseX;\n        let y = mouseY;\n        // adjust for zoom\n        zoom = zoom || this.renderer.getZoom();\n        offsetX = offsetX || this.renderer.getOffsetX();\n        offsetY = offsetY || this.renderer.getOffsetY();\n        x = x / zoom;\n        y = y / zoom;\n\n        // translate offset to canvas coordinates\n        let rect = this.renderer.getCanvas().getBoundingClientRect();\n\n        x = (x / rect.width) * this.renderer.getWidth();\n        y = (y / rect.height) * this.renderer.getHeight();\n\n        x = Math.round(x - offsetX);\n        y = Math.round(y - offsetY);\n\n        return { x: x, y: y };\n    }\n\n    translateCanvasToMouseCoordinates(x: number, y: number, zoom?: number, offsetX?: number, offsetY?: number) {\n        zoom = zoom || this.renderer.getZoom();\n        offsetX = offsetX || this.renderer.getOffsetX();\n        offsetY = offsetY || this.renderer.getOffsetY();\n        x = x + offsetX;\n        y = y + offsetY;\n        x = x * zoom;\n        y = y * zoom;\n\n        // translate offset to canvas coordinates\n        let rect = this.renderer.getCanvas().getBoundingClientRect();\n        x = Math.round((x / this.renderer.getWidth()) * rect.width);\n        y = Math.round((y / this.renderer.getHeight()) * rect.height);\n\n        return { x: x, y: y };\n    }\n}","import { aspectRatios } from \"./aspecRatios\";\n\nexport function getUpscaleLevel(width: number, height: number): number {\n    let upscaleLevel = 0;\n    for (let i = 0; i < aspectRatios.length; i++) {\n        const aspectRatio = aspectRatios[i];\n        if (width === aspectRatio.width && height === aspectRatio.height) {\n            return upscaleLevel;\n        }\n    }\n    width /= 2;\n    height /= 2;\n    upscaleLevel++;\n    for (let i = 0; i < aspectRatios.length; i++) {\n        const aspectRatio = aspectRatios[i];\n        if (width === aspectRatio.width && height === aspectRatio.height) {\n            return upscaleLevel;\n        }\n    }\n    width /= 2;\n    height /= 2;\n    upscaleLevel++;\n    for (let i = 0; i < aspectRatios.length; i++) {\n        const aspectRatio = aspectRatios[i];\n        if (width === aspectRatio.width && height === aspectRatio.height) {\n            return upscaleLevel;\n        }\n    }\n    return -1;\n}\n","import React, { FC, useEffect, useState } from \"react\";\nimport { CreateImageInput, CreateImageInputStatusEnum, Image } from \"../client\";\nimport {\n    aspectRatios, DEFAULT_ASPECT_RATIO, getClosestAspectRatio, upscale, compareSize, AspectRatio\n} from \"../lib/aspecRatios\";\nimport loadImage from \"blueimp-load-image\";\nimport { AspectRatioSelector } from \"./AspectRatioSelector\";\nimport { getUpscaleLevel } from \"../lib/upscale\";\n\ninterface Props {\n    parent: Image | null;\n    creating: boolean;\n    assetsUrl: string;\n    onSubmit: (input: CreateImageInput) => void;\n    // go straight to editor without variations\n    onEdit: (input: CreateImageInput) => void;\n    onCancel: () => void;\n}\n\nexport function defaultArgs(): CreateImageInput {\n    return {\n        phrases: [\"a painting of a happy corgi wearing sunglasses\"],\n        negative_phrases: [],\n        label: \"\",\n        iterations: 50,\n        encoded_image: \"\",\n        encoded_npy: \"\",\n        encoded_mask: \"\",\n        enable_video: false,\n        enable_zoom: false,\n        zoom_frequency: 10,\n        zoom_scale: 0.99,\n        zoom_shift_x: 0,\n        zoom_shift_y: 0,\n        model: \"stable_diffusion_text2im\",\n        glid_3_xl_clip_guidance: false,\n        glid_3_xl_clip_guidance_scale: 150,\n        glid_3_xl_skip_iterations: 0,\n        width: 512,\n        height: 512,\n        stable_diffusion_strength: 0.75,\n        count: 4,\n    };\n}\n\nexport const ImagePrompt: FC<Props> = ({\n    parent,\n    creating,\n    assetsUrl,\n    onSubmit,\n    onCancel,\n    onEdit,\n}) => {\n    const [prompt, setPrompt] = useState<string>(\"\");\n    const [negativePrompt, setNegativePrompt] = useState<string>(\"\");\n    const [count, setCount] = useState<number>(4);\n    const [variationStrength, setVariationStrength] = useState<number>(0.75);\n    const [aspectRatio, setAspectRatio] =\n        useState<number>(DEFAULT_ASPECT_RATIO);\n    const [parentId, setParentId] = useState<string | null>(null);\n    const [advancedView, setAdvancedView] = useState<boolean>(false);\n    const [encodedImage, setEncodedImage] = useState<string>(\"\");\n    const defaultAspectRatio = aspectRatios[DEFAULT_ASPECT_RATIO];\n    \n    const [aspectRatioDetails, setAspectRatioDetails] = useState<AspectRatio>(aspectRatios[DEFAULT_ASPECT_RATIO]);\n\n    // const aspectRatioDetails = aspectRatios[aspectRatio];\n\n    const resetState = () => {\n        setPrompt(\"\");\n        setNegativePrompt(\"\");\n        setCount(4);\n        setAdvancedView(false);\n        setParentId(null);\n        setVariationStrength(0.75);\n        setAspectRatio(DEFAULT_ASPECT_RATIO);\n        setAspectRatioDetails(aspectRatios[DEFAULT_ASPECT_RATIO]);\n        setEncodedImage(\"\");\n    };\n\n    const handleSubmit = async (e: React.FormEvent<HTMLFormElement>) => {\n        e.preventDefault();\n        const args = defaultArgs();\n        args.phrases = [prompt || \"\"];\n        args.negative_phrases = [negativePrompt || \"\"];\n        args.count = count;\n        args.parent = parentId || undefined;\n        args.stable_diffusion_strength = variationStrength;\n        if (parent) {\n            const bestMatch = getClosestAspectRatio(parent.width!, parent.height!);\n            args.width = bestMatch.width;\n            args.height = bestMatch.height;\n            args.nsfw = parent.nsfw;\n        } else {\n            const bestMatch = getClosestAspectRatio(aspectRatioDetails.width, aspectRatioDetails.height);\n            args.width = bestMatch.width;\n            args.height = bestMatch.height;\n        }\n        if (encodedImage) {\n            args.encoded_image = encodedImage;\n        }\n\n        resetState();\n        onSubmit(args);\n    };\n\n    const handleEdit = () => {\n        if (!encodedImage) {\n            console.error(\"Cannot edit without existing image\")\n        }\n        const args = defaultArgs();\n        args.phrases = [prompt || \"\"];\n        args.negative_phrases = [negativePrompt || \"\"];\n        args.count = 1;\n        args.parent = parentId || undefined;\n        args.stable_diffusion_strength = variationStrength;\n        args.status = CreateImageInputStatusEnum.Completed;\n        args.width = aspectRatioDetails.width;\n        args.height = aspectRatioDetails.height;\n        if (parent) {\n            args.nsfw = parent.nsfw;\n        }\n        if (encodedImage) {\n            args.encoded_image = encodedImage;\n        }\n\n        resetState();\n        onEdit(args);\n    }\n\n    const handleCancel = () => {\n        resetState();\n        onCancel();\n    };\n\n    const onImageSelected = async (e: React.ChangeEvent<HTMLInputElement>) => {\n        const file = e.target.files && e.target.files[0];\n        if (!file) {\n            return;\n        }\n        loadImage(\n            file,\n            (img: Event | HTMLImageElement | HTMLCanvasElement) => {\n                if (!(img instanceof HTMLCanvasElement)) {\n                    return;\n                }\n                // try to match width and height to a supported aspect ratio\n                const width = img.width;\n                const height = img.height;\n                let bestMatch = getClosestAspectRatio(width, height);\n                while (compareSize(upscale(bestMatch), width, height) <= 0) {\n                    bestMatch = upscale(bestMatch);\n                    if (getUpscaleLevel(bestMatch.width, bestMatch.height) >= 2) {\n                        break;\n                    }\n                }\n                console.log(\"best match\", bestMatch);\n\n\n                const canvas = document.createElement(\"canvas\");\n                canvas.width = bestMatch.width;\n                canvas.height = bestMatch.height;\n                const ctx = canvas.getContext(\"2d\");\n                if (!ctx) {\n                    return;\n                }\n                ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\n\n                // convert image to base64\n                // const canvas = img as HTMLCanvasElement\n                const dataUrl = canvas.toDataURL(\"image/jpeg\");\n                const base64 = dataUrl.split(\",\")[1];\n                setEncodedImage(base64);\n                // get the index of the best match\n                setAspectRatio(\n                    aspectRatios.findIndex(\n                        (a) => a.id === bestMatch.id\n                    )\n                );\n                setAspectRatioDetails(bestMatch);\n                // remove canvas\n                canvas.remove();\n            },\n            {\n                maxWidth: 4096,\n                maxHeight: 4096,\n                canvas: true,\n            }\n        );\n    };\n\n    useEffect(() => {\n        if (parent) {\n            setPrompt(parent.phrases.join(\", \"));\n            setNegativePrompt(parent.negative_phrases.join(\", \"));\n            setCount(4);\n            setParentId(parent.id);\n            setAdvancedView(true);\n            setVariationStrength(parent.stable_diffusion_strength);\n            setEncodedImage(\"\");\n        } else {\n            resetState();\n        }\n    }, [parent]);\n\n    return (\n        <form onSubmit={handleSubmit}>\n            <div className=\"homepage-prompt\">\n                <div className=\"input-group\">\n                    <input\n                        className=\"form-control\"\n                        placeholder=\"What would you like to create?\"\n                        value={prompt}\n                        onChange={(e) => setPrompt(e.target.value)}\n                    />\n\n                    <div className=\"input-group-append\">\n                        <button\n                            type=\"submit\"\n                            className=\"btn btn-secondary light-button\"\n                            style={{ marginLeft: \"8px\" }}\n                            disabled={!prompt || creating}\n                        >\n                            {/* paintbrush button */}\n                            {!creating && (\n                                <i className=\"fas fa-paint-brush\"></i>\n                            )}\n                            {/* spinner button */}\n                            {creating && (\n                                <i className=\"fas fa-spinner fa-spin\"></i>\n                            )}\n                        </button>\n                    </div>\n                </div>\n                <div\n                    style={{\n                        marginTop: \"24px\",\n                    }}\n                >\n                    <a\n                        href=\"javascript:void(0)\"\n                        onClick={() => setAdvancedView(!advancedView)}\n                        style={{\n                            color: \"white\",\n                            textDecoration: \"underline\",\n                        }}\n                    >\n                        Advanced\n                    </a>\n                    &nbsp;\n                    {advancedView ? (\n                        <i className=\"fas fa-chevron-up\"></i>\n                    ) : (\n                        <i className=\"fas fa-chevron-down\"></i>\n                    )}\n                </div>\n                {advancedView && (\n                    <div className=\"homepage-prompt-advanced\">\n                        {parent && !encodedImage && (\n                            <div className=\"form-group\">\n                                <label>Parent Image</label>\n                                {/* ${assetsUrl}/${image.id}.image.jpg?updated_at=${image.updated_at} */}\n                                <img\n                                    style={{\n                                        display: \"block\",\n                                        marginLeft: \"auto\",\n                                        marginRight: \"auto\",\n                                        maxWidth: \"100%\",\n                                    }}\n                                    src={`${assetsUrl}/${parentId}.image.jpg?updated_at=${parent.updated_at}`}\n                                />\n                            </div>\n                        )}\n                        {encodedImage && (\n                            <div className=\"form-group\">\n                                <label>Init Image</label>\n                                <img\n                                    style={{\n                                        display: \"block\",\n                                        marginLeft: \"auto\",\n                                        marginRight: \"auto\",\n                                        maxWidth: \"100%\",\n                                    }}\n                                    src={`data:image/jpeg;base64,${encodedImage}`}\n                                />\n                            </div>\n                        )}\n                        {!parent && !encodedImage && (\n                            <AspectRatioSelector\n                                aspectRatio={aspectRatio}\n                                onChange={aspectRatioId => {\n                                    setAspectRatio(aspectRatioId);\n                                    setAspectRatioDetails(\n                                        aspectRatios[aspectRatioId]\n                                    );\n                                }}\n                            />\n                        )}\n                        <div className=\"form-group\">\n                            <div\n                                style={{\n                                    display: \"block\",\n                                    maxWidth: encodedImage ? \"350px\" : \"180px\",\n                                    marginTop: \"40px\",\n                                    marginRight: \"auto\",\n                                    marginLeft: \"auto\",\n                                }}\n                            >\n                                <label\n                                    id=\"loadimage-wrapper\"\n                                    className={`btn btn-primary `}\n                                    style={{ display: \"inline\" }}\n                                >\n                                    {/* upload image */}\n                                    <i className=\"fas fa-upload\"></i>&nbsp;\n                                    {encodedImage || parent\n                                        ? \"Replace Image\"\n                                        : \"Upload Image\"}\n                                    <input\n                                        id=\"loadimage\"\n                                        type=\"file\"\n                                        style={{ display: \"none\" }}\n                                        onChange={onImageSelected}\n                                    />\n                                </label>\n                                {encodedImage && (\n                                    <label\n                                        className=\"btn btn-secondary\"\n                                        onClick={() => setEncodedImage(\"\")}\n                                        style={{ display: \"inline\" }}\n                                    >\n                                        {/* remove image */}\n                                        <i className=\"fas fa-trash\"></i>&nbsp;\n                                        Remove Image\n                                    </label>\n                                )}\n                            </div>\n                        </div>\n                        <div className=\"form-group\">\n                            {/* negative prompt */}\n                            <label htmlFor=\"negativePrompt\">\n                                Negative Prompt\n                            </label>\n                            <input\n                                type=\"text\"\n                                className=\"form-control\"\n                                id=\"negativePrompt\"\n                                placeholder=\"What would you like to avoid?\"\n                                value={negativePrompt}\n                                onChange={(e) =>\n                                    setNegativePrompt(e.target.value)\n                                }\n                            />\n                            <span className=\"helptext\">\n                                Try descriptive words like \"blurry\" or\n                                \"distorted\"\n                            </span>\n                        </div>\n                        <div className=\"form-group\">\n                            <label htmlFor=\"count\">Count: {count}</label>\n                            {/* range slider from 1 to 20 */}\n                            <input\n                                type=\"range\"\n                                className=\"form-control-range\"\n                                id=\"count\"\n                                min=\"1\"\n                                max=\"20\"\n                                value={count}\n                                onChange={(e) =>\n                                    setCount(parseInt(e.target.value))\n                                }\n                            />\n                            <span className=\"helptext\">\n                                This is how many images you want to generate\n                            </span>\n                        </div>\n                        {(parentId || encodedImage) && (\n                            <div className=\"form-group\">\n                                {/* variation strength */}\n                                <label htmlFor=\"variationStrength\">\n                                    Variation Strength:&nbsp;\n                                    {(variationStrength * 100).toFixed(0)}%\n                                </label>\n                                <input\n                                    type=\"range\"\n                                    className=\"form-control-range\"\n                                    id=\"variationStrength\"\n                                    min=\"0.05\"\n                                    max=\"0.95\"\n                                    step=\"0.05\"\n                                    value={variationStrength}\n                                    onChange={(e) =>\n                                        setVariationStrength(\n                                            parseFloat(e.target.value)\n                                        )\n                                    }\n                                />\n                                <span className=\"helptext\">\n                                    This is how much variation you want to see\n                                    from the parent image\n                                </span>\n                            </div>\n                        )}\n                        {advancedView && (\n                            <div\n                                className=\"form-group\"\n                                style={{ minHeight: \"20px\" }}\n                            >\n                                <div className=\"float-right\">\n                                    {parent && (\n                                        <button\n                                            type=\"button\"\n                                            className=\"btn btn-secondary light-button\"\n                                            onClick={handleCancel}\n                                        >\n                                            <i className=\"fas fa-times\"></i>\n                                            &nbsp;CANCEL\n                                        </button>\n                                    )}\n                                    <button\n                                        type=\"submit\"\n                                        className=\"btn btn-primary\"\n                                        style={{ marginLeft: \"8px\" }}\n                                        disabled={!prompt || creating}\n                                    >\n                                        {/* paintbrush button */}\n                                        {!creating && (\n                                            <i className=\"fas fa-paint-brush\"></i>\n                                        )}\n                                        {/* spinner button */}\n                                        {creating && (\n                                            <i className=\"fas fa-spinner fa-spin\"></i>\n                                        )}\n                                        &nbsp;PAINT\n                                    </button>\n                                    {encodedImage && (\n                                        <button\n                                            type=\"button\"\n                                            className=\"btn btn-secondary light-button\"\n                                            onClick={handleEdit}\n                                            style={{ marginLeft: \"8px\" }}\n                                            disabled={!prompt || creating}\n                                        >\n                                            <i className=\"fas fa-edit\"></i>\n                                            &nbsp;EDIT\n                                        </button>\n                                    )}\n                                </div>\n                            </div>\n                        )}\n                    </div>\n                )}\n            </div>\n        </form>\n    );\n};\n","import React, { FC, useEffect, useRef, useState } from \"react\";\n\nimport { aspectRatios, DEFAULT_ASPECT_RATIO, getClosestAspectRatio } from \"../lib/aspecRatios\";\n\ninterface Props {\n    aspectRatio: number;\n    onChange: (aspectRatio: number) => void;\n    disabled?: boolean;\n}\n\nexport const AspectRatioSelector: FC<Props> = ({ aspectRatio, onChange, disabled }) => {\n    const aspectRatioDetails = aspectRatios[aspectRatio];\n    return (\n        <div className=\"form-group\">\n            <div\n                style={{\n                    minHeight: \"140px\",\n                    display: \"flex\",\n                    alignItems: \"center\",\n                }}\n            >\n                {/* aspect ratio slider, goes from 0 -> aspectRatios.length - 1 */}\n                <div\n                    style={{\n                        width: aspectRatioDetails.width / 8,\n                        height: aspectRatioDetails.height / 8,\n                        // dotted line options: dotted, dashed, solid, double, groove, ridge, inset, outset, none, hidden\n                        border: \"1px dashed white\",\n                        margin: \"auto\",\n                    }}\n                ></div>\n            </div>\n            <label style={{width: \"100%\"}}>\n                Aspect Ratio\n                <small className=\"form-text text-muted\" style={{float: \"right\"}}>\n                    {aspectRatioDetails.displayName}\n                </small>\n            </label>\n            <input\n                type=\"range\"\n                disabled={disabled}\n                className=\"form-control-range\"\n                min={0}\n                max={aspectRatios.length - 1}\n                value={aspectRatio}\n                onChange={(e) => {\n                    onChange(parseInt(e.target.value));\n                }}\n            />\n        </div>\n    );\n};\n","import React, { useState, useEffect } from \"react\";\nimport { Renderer } from \"./renderer\";\nimport { Cursor, Rect } from \"./models\";\nimport { Tool, BaseTool } from \"./tool\";\nimport { AspectRatioSelector } from \"../../components/AspectRatioSelector\";\nimport { getUpscaleLevel } from \"../../lib/upscale\";\nimport {\n    DEFAULT_ASPECT_RATIO,\n    aspectRatios,\n    getClosestAspectRatio,\n} from \"../../lib/aspecRatios\";\nimport { ZoomHelper } from \"./zoomHelper\";\n\nexport class SelectionTool extends BaseTool implements Tool {\n    private renderer: Renderer;\n    private zoomHelper: ZoomHelper;\n    private selectionOverlay: Rect | undefined;\n    private selectionOverlayPreview: Rect | undefined;\n\n    // private selectionWidth: number = 512;\n    // private selectionHeight: number = 512;\n\n    private panning = false;\n\n    // TODO: size modifier to make the selection overlay smaller\n\n    constructor(renderer: Renderer) {\n        super(\"select\");\n        this.renderer = renderer;\n        this.zoomHelper = new ZoomHelper(renderer);\n    }\n\n    // TODO: smaller/larger, aspect ratios?\n    updateArgs(args: any) {\n        super.updateArgs(args);\n        // this.selectionWidth = args.selectionWidth || 512;\n        // this.selectionHeight = args.selectionHeight || 512;\n        this.selectionOverlay = args.selectionOverlay || {\n            x: 0,\n            y: 0,\n            width: 512,\n            height: 512,\n        };\n        this.sync();\n    }\n\n    private sync(): void {\n        this.renderer.setSelectionOverlay(this.selectionOverlay);\n        this.renderer.setSelectionOverlayPreview(this.selectionOverlayPreview);\n    }\n\n    onMouseDown(event: React.MouseEvent<HTMLCanvasElement, MouseEvent>) {\n        if (this.selectionOverlayPreview && event.button === 0) {\n            this.selectionOverlay = this.selectionOverlayPreview;\n            this.selectionOverlayPreview = undefined;\n            this.sync();\n            this.updateArgs({\n                ...this.getArgs(),\n                selectionOverlay: this.selectionOverlay,\n            });\n        } else if (event.button === 1) {\n            this.panning = true;\n        }\n    }\n\n    onMouseMove(event: React.MouseEvent<HTMLCanvasElement, MouseEvent>) {\n        const imageWidth = this.renderer.getWidth();\n        const imageHeight = this.renderer.getHeight();\n        if (this.panning) {\n            this.zoomHelper.onPan(event);\n        } else {\n            let { x, y } = this.zoomHelper.translateMouseToCanvasCoordinates(\n                event.nativeEvent.offsetX,\n                event.nativeEvent.offsetY\n            );\n\n            // round to the nearest 16 pixels\n            x = Math.round(x / 16) * 16;\n            y = Math.round(y / 16) * 16;\n            // offset by -256 to center the rect\n            x -= 256;\n            y -= 256;\n            // clamp to the canvas\n            x = Math.max(\n                0,\n                Math.min(x, imageWidth - this.selectionOverlay!.width)\n            );\n            y = Math.max(\n                0,\n                Math.min(y, imageHeight - this.selectionOverlay!.height)\n            );\n            x = Math.min(x, imageWidth - this.selectionOverlay!.width);\n            y = Math.min(y, imageHeight - this.selectionOverlay!.height);\n\n            this.selectionOverlayPreview = {\n                x: x,\n                y: y,\n                width: this.selectionOverlay!.width,\n                height: this.selectionOverlay!.height,\n            };\n            this.sync();\n        }\n    }\n\n    onMouseUp(event: React.MouseEvent<HTMLCanvasElement, MouseEvent>) {\n        this.panning = false;\n    }\n\n    onMouseLeave(event: React.MouseEvent<HTMLCanvasElement, MouseEvent>) {\n        this.selectionOverlayPreview = undefined;\n        this.panning = false;\n        this.sync();\n    }\n\n    // onKeyDown(event: KeyboardEvent) {\n    //     // TODO\n    // }\n\n    // onKeyUp(event: KeyboardEvent) {\n    //     // TODO\n    // }\n\n    onWheel(event: WheelEvent) {\n        this.zoomHelper.onWheel(event);\n    }\n\n    destroy() {\n        // this.renderer.setSelectionOverlay(undefined);\n        this.renderer.setSelectionOverlayPreview(undefined);\n        return true;\n    }\n}\n\ninterface ControlsProps {\n    renderer: Renderer;\n    tool: Tool;\n}\n\nexport const Controls: React.FC<ControlsProps> = ({ renderer, tool }) => {\n    const upscaleLevel = getUpscaleLevel(\n        renderer.getWidth(),\n        renderer.getHeight()\n    );\n    const [aspectRatio, setAspectRatio] = useState(DEFAULT_ASPECT_RATIO);\n    const [size, setSize] = useState(1);\n\n    useEffect(() => {\n        const upscaleLevel = getUpscaleLevel(\n            renderer.getWidth(),\n            renderer.getHeight()\n        );\n        // lock aspect ratio to image\n        if (upscaleLevel === 0) {\n            const aspectRatio = getClosestAspectRatio(\n                renderer.getWidth(),\n                renderer.getHeight()\n            );\n            setAspectRatio(aspectRatio.id);\n            tool.updateArgs({\n                // selectionWidth: aspectRatio.width,\n                // selectionHeight: aspectRatio.height,\n                selectionOverlay: {\n                    x: 0,\n                    y: 0,\n                    width: aspectRatio.width,\n                    height: aspectRatio.height,\n                },\n            });\n        } else {\n            const args = tool.getArgs();\n            if (args.selectionOverlay) {\n                // restore args\n                const aspectRatio = getClosestAspectRatio(\n                    args.selectionOverlay.width,\n                    args.selectionOverlay.height\n                );\n                setAspectRatio(aspectRatio.id);\n                setSize(args.selectionOverlay.width / aspectRatio.width);\n                tool.updateArgs(args);\n            } else {\n                // set default args\n                args.selectionOverlay = {\n                    x: 0,\n                    y: 0,\n                    width: aspectRatios[aspectRatio].width,\n                    height: aspectRatios[aspectRatio].height,\n                };\n                tool.updateArgs(args);\n            }\n        }\n    }, [tool]);\n\n    function onChange(aspectRatioId: number, size: number) {\n        const args = tool.getArgs();\n        const aspectRatio = aspectRatios[aspectRatioId];\n        if (args.selectionOverlay) {\n            const xDiff = args.selectionOverlay.width - aspectRatio.width * size;\n            const yDiff = args.selectionOverlay.height - aspectRatio.height * size;\n            args.selectionOverlay.width = Math.round(aspectRatio.width * size);\n            args.selectionOverlay.height = Math.round(aspectRatio.height * size);\n            args.selectionOverlay.x += xDiff / 2;\n            args.selectionOverlay.y += yDiff / 2;\n            // clamp to canvas\n            args.selectionOverlay.x = Math.round(Math.max(\n                0,\n                Math.min(\n                    args.selectionOverlay.x,\n                    renderer.getWidth() - args.selectionOverlay.width\n                )\n            ));\n            args.selectionOverlay.y = Math.round(Math.max(\n                0,\n                Math.min(\n                    args.selectionOverlay.y,\n                    renderer.getHeight() - args.selectionOverlay.height\n                )\n            ));\n        }\n        tool.updateArgs({\n            selectionOverlay: args.selectionOverlay,\n        });\n    }\n\n    return (\n        <>\n            {upscaleLevel > 0 && (\n                <AspectRatioSelector\n                    aspectRatio={aspectRatio}\n                    onChange={(aspectRatioId) => {\n                        onChange(aspectRatioId, size);\n                        setAspectRatio(aspectRatioId);\n                    }}\n                />\n            )}\n            <div className=\"form-group\">\n                <label htmlFor=\"size\" style={{ width: \"100%\" }}>\n                    Size\n                    <small\n                        className=\"form-text text-muted\"\n                        style={{ float: \"right\" }}\n                    >\n                        {Math.round(size * 100)}%\n                    </small>\n                </label>\n                {/* range from 0.1 to 1 */}\n                <input\n                    type=\"range\"\n                    className=\"form-control-range\"\n                    id=\"size\"\n                    min=\"0.2\"\n                    max=\"1\"\n                    step=\"0.1\"\n                    value={size}\n                    onChange={(event) => {\n                        onChange(aspectRatio, parseFloat(event.target.value));\n                        setSize(parseFloat(event.target.value));\n                    }}\n                />\n            </div>\n        </>\n    );\n};\n","import React, { FC, useState, useEffect, useRef } from \"react\";\nimport { loadImageAsync } from \"../../lib/loadImage\";\n\nimport { sleep } from \"../../lib/sleep\";\nimport { defaultArgs } from \"../../components/ImagePrompt\";\nimport { Tool, BaseTool } from \"./tool\";\nimport { Renderer } from \"./renderer\";\nimport { Cursor, Rect } from \"./models\";\nimport {\n    AIBrushApi,\n    CreateImageInput,\n    Image as APIImage,\n    ImageList,\n    ImageStatusEnum,\n} from \"../../client\";\nimport { ZoomHelper } from \"./zoomHelper\";\nimport { getClosestAspectRatio } from \"../../lib/aspecRatios\";\nimport { featherEdges, fixRedShift } from \"../../lib/imageutil\";\n\ntype EnhanceToolState = \"default\" | \"busy\" | \"confirm\" | \"erase\";\n\n// eraser width modifier adds a solid core with a feather edge\n// equal to the what is used on enhanced selections\nconst eraserWidthModifier = 1.3;\n\ninterface ImageWithData extends APIImage {\n    data?: ImageData;\n}\n\nexport class EnhanceTool extends BaseTool implements Tool {\n    private renderer: Renderer;\n    private zoomHelper: ZoomHelper;\n\n    private prompt: string = \"\";\n    private count: number = 4;\n    private variationStrength: number = 0.35;\n\n    private _state: EnhanceToolState = \"default\";\n    private stateHandler: (state: EnhanceToolState) => void = () => {};\n    private selectionControlsListener: (show: boolean) => void = () => {};\n\n    private imageData: Array<ImageData> = [];\n    private selectedImageDataIndex: number = -1;\n    private selectedImageData: ImageData | null = null;\n    private panning = false;\n    private erasing = false;\n    private progressListener?: (progress: number) => void;\n    private errorListener?: (error: string | null) => void;\n\n    onError(handler: (error: string | null) => void) {\n        this.errorListener = handler;\n    }\n\n    private notifyError(error: string | null) {\n        if (this.errorListener) {\n            this.errorListener(error);\n        }\n    }\n\n    get state(): EnhanceToolState {\n        return this._state;\n    }\n\n    private set state(state: EnhanceToolState) {\n        this._state = state;\n        this.stateHandler(state);\n        if (state == \"confirm\") {\n            this.selectionControlsListener(true);\n        } else {\n            this.selectionControlsListener(false);\n        }\n    }\n\n    constructor(renderer: Renderer) {\n        super(\"enhance\");\n        this.renderer = renderer;\n        this.zoomHelper = new ZoomHelper(renderer);\n    }\n\n    onMouseDown(event: React.MouseEvent<HTMLCanvasElement, MouseEvent>) {\n        let { x, y } = this.zoomHelper.translateMouseToCanvasCoordinates(\n            event.nativeEvent.offsetX,\n            event.nativeEvent.offsetY\n        );\n        if (event.button === 1) {\n            this.panning = true;\n            return;\n        }\n        if (this.state == \"erase\" && this.selectedImageData) {\n            this.erasing = true;\n            // clone selected ImageData\n            this.selectedImageData = new ImageData(\n                this.selectedImageData.data.slice(),\n                this.selectedImageData.width,\n                this.selectedImageData.height\n            );\n\n            this.erasePoint(x, y);\n        }\n    }\n\n    // TODO: on erase cancel and on erase confirm\n    // either restore the image data from the array\n    // or overwrite the array with the new image data\n\n    private erasePoint(x: number, y: number) {\n        const selectionOverlay = this.renderer.getSelectionOverlay()!;\n        const baseWidth = Math.min(\n            selectionOverlay.width,\n            selectionOverlay.height\n        );\n        const eraserRadius = Math.floor(baseWidth / 8 * eraserWidthModifier);\n\n        const relX = x - selectionOverlay.x;\n        const relY = y - selectionOverlay.y;\n        const imageData = this.selectedImageData!;\n\n        const startX = Math.max(0, relX - eraserRadius);\n        const startY = Math.max(0, relY - eraserRadius);\n        const endX = Math.min(imageData.width, relX + eraserRadius);\n        const endY = Math.min(imageData.height, relY + eraserRadius);\n\n        \n        // relX=64.28541697636388, relY=64.24464312259761, startX=0.28541697636387653, startY=0.24464312259760845, endX=128.28541697636388, endY=128.2446431225976\n\n        for (let i = startX; i < endX; i++) {\n            for (let j = startY; j < endY; j++) {\n                const index = (j * imageData.width + i) * 4;\n                const distance = Math.sqrt(\n                    Math.pow(i - relX, 2) + Math.pow(j - relY, 2)\n                );\n                if (distance < eraserRadius) {\n                    // set alpha to a linear gradient from the center,\n                    // 100% in the middle and 0% at the edge\n                    const alphaPct = (distance / eraserRadius) * eraserWidthModifier - (eraserWidthModifier - 1);\n\n                    const alpha = Math.min(Math.floor(\n                        alphaPct * 255\n                    ), imageData.data[index + 3]);\n                    imageData.data[index + 3] = alpha;\n                }\n            }\n        }\n        this.renderer.setEditImage(imageData);\n    }\n\n    private updateCursor(x: number, y: number) {\n        if (this.state == \"erase\" && this.selectedImageData) {\n            const selectionOverlay = this.renderer.getSelectionOverlay()!;\n            const baseWidth = Math.min(\n                selectionOverlay.width,\n                selectionOverlay.height\n            );\n            const featherWidth = Math.floor(baseWidth / 8);\n            this.renderer.setCursor({\n                color: \"white\",\n                radius: featherWidth * eraserWidthModifier,\n                type: \"circle\",\n                x,\n                y,\n            });\n        } else {\n            this.renderer.setCursor({\n                color: \"white\",\n                radius: 10,\n                type: \"crosshairs\",\n                x,\n                y,\n            });\n        }\n        \n    }\n\n    onMouseMove(event: React.MouseEvent<HTMLCanvasElement, MouseEvent>) {\n        let { x, y } = this.zoomHelper.translateMouseToCanvasCoordinates(\n            event.nativeEvent.offsetX,\n            event.nativeEvent.offsetY\n        );\n        if (this.panning) {\n            this.zoomHelper.onPan(event);\n        }\n        \n        this.updateCursor(x, y);\n        if (this.erasing) {\n            this.erasePoint(x, y);\n        }\n    }\n\n    onMouseUp(event: React.MouseEvent<HTMLCanvasElement, MouseEvent>) {\n        this.panning = false;\n        this.erasing = false;\n        let { x, y } = this.zoomHelper.translateMouseToCanvasCoordinates(\n            event.nativeEvent.offsetX,\n            event.nativeEvent.offsetY\n        );\n    }\n\n    onMouseLeave(event: React.MouseEvent<HTMLCanvasElement, MouseEvent>): void {\n        this.panning = false;\n        this.erasing = false;\n    }\n\n    onWheel(event: WheelEvent) {\n        this.zoomHelper.onWheel(event);\n        let { x, y } = this.zoomHelper.translateMouseToCanvasCoordinates(\n            event.offsetX,\n            event.offsetY\n        );\n        this.updateCursor(x, y);\n    }\n\n    updateArgs(args: any) {\n        this.prompt = args.prompt || \"\";\n        this.count = args.count || 4;\n        this.variationStrength = args.variationStrength || 0.75;\n    }\n\n    onChangeState(handler: (state: EnhanceToolState) => void) {\n        this.stateHandler = handler;\n    }\n\n    onShowSelectionControls(listener: (show: boolean) => void): void {\n        this.selectionControlsListener = listener;\n    }\n\n    onProgress(listener: (progress: number) => void): void {\n        this.progressListener = listener;\n    }\n\n    private loadImageData(\n        api: AIBrushApi,\n        imageId: string,\n        baseImage: APIImage,\n        baseImageData: ImageData,\n        selectionOverlay: Rect\n    ): Promise<ImageData> {\n        return new Promise((resolve, reject) => {\n            api.getImageData(imageId, {\n                responseType: \"arraybuffer\",\n            }).then((resp) => {\n                const binaryImageData = Buffer.from(resp.data, \"binary\");\n                const base64ImageData = binaryImageData.toString(\"base64\");\n                const src = `data:image/jpeg;base64,${base64ImageData}`;\n                const imageElement = new Image();\n                imageElement.src = src;\n                imageElement.onload = () => {\n                    const canvas = document.createElement(\"canvas\");\n                    canvas.width = selectionOverlay.width;\n                    canvas.height = selectionOverlay.height;\n                    const ctx = canvas.getContext(\"2d\");\n                    if (!ctx) {\n                        reject(new Error(\"Failed to get canvas context\"));\n                        return;\n                    }\n                    ctx.drawImage(imageElement, 0, 0, selectionOverlay.width, selectionOverlay.height);\n                    const imageData = ctx.getImageData(\n                        0,\n                        0,\n                        selectionOverlay.width,\n                        selectionOverlay.height\n                    );\n                    // Is there a better way to fix this? This often causes\n                    // a visible rectangle difference in coloring. :/\n\n                    // fixRedShift(baseImageData, imageData);\n                    featherEdges(\n                        selectionOverlay,\n                        baseImage.width!,\n                        baseImage.height!,\n                        imageData\n                    );\n                    resolve(imageData);\n                    // remove canvas\n                    canvas.remove();\n                };\n            });\n        });\n    }\n\n    cancel() {\n        if (this.state == \"erase\") {\n            this.state = \"confirm\";\n            this.selectedImageData = this.imageData[this.selectedImageDataIndex];\n            this.renderer.setEditImage(this.selectedImageData);\n        } else {\n            this.state = \"default\";\n            this.imageData = [];\n            this.renderer.setEditImage(null);\n        }\n    }\n\n    erase() {\n        this.state = \"erase\";\n    }\n\n    async submit(api: AIBrushApi, image: APIImage) {\n        this.notifyError(null);\n        const selectionOverlay = this.renderer.getSelectionOverlay();\n        const encodedImage = this.renderer.getEncodedImage(selectionOverlay!);\n        if (!encodedImage) {\n            console.error(\"No selection\");\n            return;\n        }\n        const baseImageData = this.renderer.getImageData(selectionOverlay!)!;\n        const input: CreateImageInput = defaultArgs();\n        input.label = \"\";\n        input.encoded_image = encodedImage;\n        input.parent = image.id;\n        input.phrases = [this.prompt || image.phrases[0]];\n        input.negative_phrases = image.negative_phrases;\n        input.stable_diffusion_strength = this.variationStrength;\n        input.count = this.count;\n\n        const closestAspectRatio = getClosestAspectRatio(selectionOverlay!.width, selectionOverlay!.height);\n        input.width = closestAspectRatio.width;\n        input.height = closestAspectRatio.height;\n        input.temporary = true;\n\n        this.state = \"busy\";\n        let resp: ImageList | null = null;\n        try {\n            resp = (await api.createImage(input)).data;\n        } catch (err) {\n            console.error(\"Error creating images\", err);\n            this.notifyError(\"Failed to create image\");\n            this.state = \"default\";\n            return;\n        }\n        let newImages: Array<ImageWithData> | undefined = resp.images;\n        if (!newImages || newImages.length === 0) {\n            this.state = \"default\";\n            throw new Error(\"No images returned\");\n        }\n        let completed = false;\n\n\n        while (!completed) {\n            let completeCount = 0;\n            await sleep(1000);\n            // poll for completion\n            for (let i = 0; i < newImages!.length; i++) {\n                if (newImages![i].status === ImageStatusEnum.Completed) {\n                    completeCount++;\n                    continue;\n                }\n                try {\n                    const imageResp = await api.getImage(newImages![i].id);\n                    if (imageResp.data.status === ImageStatusEnum.Completed) {\n                        newImages![i] = imageResp.data;\n                        completeCount++;\n                        const imageData = await this.loadImageData(\n                            api,\n                            newImages![i].id,\n                            image,\n                            baseImageData,\n                            selectionOverlay!\n                        )\n                        newImages![i].data = imageData;\n                    }\n                } catch (err) {\n                    // gracefully leave out the result...\n                    console.error(err);\n                    completeCount++;\n                }\n            }\n            if (completeCount === newImages!.length) {\n                completed = true;\n            }\n            if (this.progressListener) {\n                this.progressListener(completeCount / newImages!.length);\n            }\n        }\n        // sort images by score descending\n        newImages!.sort((a, b) => {\n            return b.score - a.score;\n        });\n\n        this.imageData = [];\n        for (let i = 0; i < newImages!.length; i++) {\n            if (newImages![i].data) {\n                this.imageData.push(newImages![i].data as ImageData);\n            }\n        }\n        if (this.imageData.length === 0) {\n            this.state = \"default\";\n            this.notifyError(\"No images returned\");\n            return;\n        }\n        this.renderer.setEditImage(this.imageData[0]);\n        this.selectedImageDataIndex = 0;\n        this.selectedImageData = this.imageData[0];\n        this.state = \"confirm\";\n    }\n\n    select(direction: \"left\" | \"right\") {\n        if (direction == \"left\") {\n            this.selectedImageDataIndex--;\n            if (this.selectedImageDataIndex < -1) {\n                this.selectedImageDataIndex = this.imageData.length - 1;\n            }\n        }\n        if (direction == \"right\") {\n            this.selectedImageDataIndex++;\n            if (this.selectedImageDataIndex >= this.imageData.length) {\n                this.selectedImageDataIndex = -1;\n            }\n        }\n        if (this.selectedImageDataIndex === -1) {\n            this.selectedImageData = null;\n        } else {\n            this.selectedImageData =\n                this.imageData[this.selectedImageDataIndex];\n        }\n        this.renderer.setEditImage(this.selectedImageData);\n    }\n\n    onSaveImage(listener: (encodedImage: string) => void): void {\n        this.saveListener = listener;\n    }\n\n    confirm() {\n        this.renderer.commitSelection();\n        this.state = \"default\";\n        this.imageData = [];\n        const encodedImage = this.renderer.getEncodedImage(null);\n        if (encodedImage && this.saveListener) {\n            this.saveListener(encodedImage);\n        }\n    }\n\n    destroy(): boolean {\n        this.renderer.setCursor(undefined);\n        return true;\n    }\n}\n\ninterface ControlsProps {\n    api: AIBrushApi;\n    image: APIImage;\n    renderer: Renderer;\n    tool: EnhanceTool;\n}\n\nexport const EnhanceControls: FC<ControlsProps> = ({\n    api,\n    image,\n    renderer,\n    tool,\n}) => {\n    const [count, setCount] = useState(4);\n    const [variationStrength, setVariationStrength] = useState(0.35);\n    const [prompt, setPrompt] = useState(image.phrases[0]);\n    const [state, setState] = useState<EnhanceToolState>(tool.state);\n    const [progress, setProgress] = useState(0);\n    const [error, setError] = useState<string | null>(null);\n\n    tool.onChangeState(setState);\n    tool.onProgress(setProgress);\n    tool.onError(setError);\n\n    if (state == \"busy\") {\n        return (\n            <div style={{ marginTop: \"16px\" }}>\n                <i className=\"fa fa-spinner fa-spin\"></i>&nbsp; Enhancing...<br/>\n                {/* bootstrap progress bar */}\n                <div className=\"progress\" style={{ height: \"20px\", marginTop: \"16px\" }}>\n                    <div\n                        className=\"progress-bar\"\n                        role=\"progressbar\"\n                        style={{ width: `${progress * 100}%` }}\n                        aria-valuenow={progress * 100}\n                        aria-valuemin={0}\n                        aria-valuemax={100}\n                    >\n                        {Math.round(progress * 100)}%\n                    </div>\n                </div>\n            </div>\n        );\n    }\n    if (state == \"confirm\" || state == \"erase\") {\n        return (\n            <div style={{ marginTop: \"16px\" }}>\n                <button\n                    className=\"btn btn-primary\"\n                    onClick={() => {\n                        tool.cancel();\n                    }}\n                >\n                    {/* cancel icon */}\n                    <i className=\"fa fa-times\"></i>&nbsp;\n                    Revert\n                </button>\n                <button\n                    className=\"btn btn-primary\"\n                    onClick={() => tool.confirm()}\n                    style={{ marginLeft: \"8px\" }}\n                >\n                    {/* save icon */}\n                    <i className=\"fa fa-save\"></i>&nbsp;\n                    Save\n                </button>\n                {/* erase button */}\n                {state == \"confirm\" && <button\n                    className=\"btn btn-primary\"\n                    onClick={() => tool.erase()}\n                    style={{ marginLeft: \"8px\" }}\n                >\n                    <i className=\"fa fa-eraser\"></i>&nbsp;\n                    Erase\n                </button>}\n            </div>\n        );\n    }\n    return (\n        <div style={{ marginTop: \"16px\" }}>\n            {error && (\n                <div className=\"alert alert-danger\" role=\"alert\">\n                    {/* dismiss button */}\n                    <button\n                        type=\"button\"\n                        className=\"close\"\n                        data-dismiss=\"alert\"\n                        aria-label=\"Close\"\n                        onClick={() => setError(null)}\n                    >\n                        <span aria-hidden=\"true\">&times;</span>\n                    </button>\n                    {error}\n                </div>\n            )}\n            {/* prompt */}\n            <div className=\"form-group\">\n                <label htmlFor=\"prompt\">Prompt</label>\n                <input\n                    type=\"text\"\n                    className=\"form-control\"\n                    id=\"prompt\"\n                    value={prompt}\n                    onChange={(e) => {\n                        setPrompt(e.target.value);\n                    }}\n                />\n                <small className=\"form-text text-muted\">\n                    Customize the text prompt here\n                </small>\n            </div>\n            <div className=\"form-group\">\n                <label htmlFor=\"count\">Count: {count}</label>\n                <input\n                    type=\"range\"\n                    className=\"form-control-range\"\n                    id=\"count\"\n                    min=\"1\"\n                    max=\"10\"\n                    step=\"1\"\n                    value={count}\n                    onChange={(e) => {\n                        setCount(parseInt(e.target.value));\n                    }}\n                />\n                <small className=\"form-text text-muted\">\n                    Number of enhancement options\n                </small>\n            </div>\n            <div className=\"form-group\">\n                <label htmlFor=\"variation-strength\">\n                    Variation Strength: {Math.round(variationStrength * 100)}%\n                </label>\n                <input\n                    type=\"range\"\n                    className=\"form-control-range\"\n                    id=\"variation-strength\"\n                    min=\"0\"\n                    max=\"1\"\n                    step=\"0.05\"\n                    value={variationStrength}\n                    onChange={(e) => {\n                        setVariationStrength(parseFloat(e.target.value));\n                    }}\n                />\n                <small className=\"form-text text-muted\">\n                    How much variation to use\n                </small>\n            </div>\n            <div className=\"form-group\">\n                <button\n                    className=\"btn btn-primary\"\n                    onClick={() => {\n                        tool.updateArgs({\n                            count,\n                            variationStrength,\n                            prompt,\n                        });\n                        tool.submit(api, image);\n                    }}\n                >\n                    Enhance\n                </button>\n            </div>\n        </div>\n    );\n};\n","import React, { FC, useState, useEffect } from \"react\";\nimport { Renderer } from \"./renderer\";\nimport { BaseTool, Tool } from \"./tool\";\nimport { ZoomHelper } from \"./zoomHelper\";\n\nexport class SmudgeTool extends BaseTool implements Tool {\n    private renderer: Renderer;\n    private zoomHelper: ZoomHelper;\n\n    private brushSize = 10;\n    private brushOpacity = 0.2;\n\n    private lastX = 0;\n    private lastY = 0;\n    private panning = false;\n    private smudging = false;\n    private _dirty = false;\n\n    set dirty(dirty: boolean) {\n        this._dirty = dirty;\n        if (this.dirtyListener) {\n            this.dirtyListener(dirty);\n        }\n    }\n\n    get dirty() {\n        return this._dirty;\n    }\n\n    private dirtyListener?: (dirty: boolean) => void;\n\n    constructor(renderer: Renderer) {\n        super(\"smudge\");\n        this.renderer = renderer;\n        this.zoomHelper = new ZoomHelper(renderer);\n    }\n\n    private sync() {\n        this.renderer.setCursor({\n            type: \"circle\",\n            color: \"white\",\n            radius: this.brushSize / 2,\n            x: this.lastX,\n            y: this.lastY,\n        });\n    }\n\n    updateArgs(args: any) {\n        super.updateArgs(args);\n        this.brushSize = args.brushSize || 10;\n        this.brushOpacity = args.brushOpacity || 0.2;\n        this.sync();\n    }\n\n    onMouseMove(event: React.MouseEvent<HTMLCanvasElement, MouseEvent>): void {\n        let { x, y } = this.zoomHelper.translateMouseToCanvasCoordinates(\n            event.nativeEvent.offsetX,\n            event.nativeEvent.offsetY\n        );\n\n        if (this.panning) {\n            this.zoomHelper.onPan(event);\n        } else if (this.smudging) {\n            this.renderer.smudgeLine(\n                this.lastX,\n                this.lastY,\n                x,\n                y,\n                this.brushSize,\n                this.brushOpacity,\n            );\n            this.dirty = true;\n        }\n\n        this.lastX = x;\n        this.lastY = y;\n        this.sync();\n    }\n\n    onWheel(event: WheelEvent) {\n        this.zoomHelper.onWheel(event);\n        this.sync();\n    }\n\n    onMouseDown(event: React.MouseEvent<HTMLCanvasElement, MouseEvent>) {\n        if (event.button === 0) {\n            this.smudging = true;\n            if (!this.dirty) {\n                this.renderer.copyEditImageFromBaseImage();\n            }\n            this.dirty = true;\n        } else if (event.button === 1) {\n            this.panning = true;\n        }\n        this.sync();\n    }\n\n    onMouseUp(event: React.MouseEvent<HTMLCanvasElement, MouseEvent>) {\n        if (event.button === 0) {\n            this.smudging = false;\n        } else if (event.button === 1) {\n            this.panning = false;\n        }\n    }\n\n    onSaveImage(listener: (encodedImage: string) => void): void {\n        this.saveListener = listener;\n    }\n\n    onDirty(listener: (dirty: boolean) => void): void {\n        this.dirtyListener = listener;\n    }\n\n    cancel() {\n        // kind of a hack, clears the selection layer\n        this.renderer.setEditImage(null);\n        this.dirty = false;\n    }\n\n    confirm() {\n        this.renderer.commitSelection();\n        const encodedImage = this.renderer.getEncodedImage(null);\n        if (encodedImage && this.saveListener) {\n            this.saveListener(encodedImage);\n        }\n        this.dirty = false;\n    }\n\n    destroy(): boolean {\n        if (\n            !this.dirty ||\n            window.confirm(\"Are you sure you want to discard your changes?\")\n        ) {\n            this.renderer.setCursor(undefined);\n            this.renderer.setEditImage(null);\n            return true;\n        }\n        return false;\n    }\n}\n\ninterface Props {\n    renderer: Renderer;\n    tool: SmudgeTool;\n}\n\nexport const SmudgeControls: FC<Props> = ({ renderer, tool }) => {\n    const [brushSize, setBrushSize] = useState(10);\n    const [brushOpacity, setBrushOpacity] = useState(0.2);\n    const [dirty, setDirty] = useState(false);\n\n    tool.onDirty(setDirty);\n\n    useEffect(() => {\n        tool.updateArgs({\n            brushSize,\n            brushOpacity,\n        });\n    }, [brushSize, brushOpacity]);\n\n    return (\n        <div style={{ marginTop: \"16px\" }}>\n            <div className=\"form-group\">\n                <label style={{ width: \"100%\" }}>\n                    Brush size\n                    <small\n                        className=\"form-text text-muted\"\n                        style={{ float: \"right\" }}\n                    >\n                        {brushSize}px\n                    </small>\n                </label>\n                <input\n                    type=\"range\"\n                    className=\"form-control-range\"\n                    min=\"1\"\n                    max=\"100\"\n                    value={brushSize}\n                    onChange={(e) => setBrushSize(parseInt(e.target.value))}\n                />\n            </div>\n            <div className=\"form-group\">\n                <label style={{ width: \"100%\" }}>\n                    Brush opacity\n                    <small\n                        className=\"form-text text-muted\"\n                        style={{ float: \"right\" }}\n                    >\n                        {Math.round(brushOpacity * 100)}%\n                    </small>\n                </label>\n                <input\n                    type=\"range\"\n                    className=\"form-control-range\"\n                    min=\"0\"\n                    max=\"1\"\n                    step=\"0.01\"\n                    value={brushOpacity}\n                    onChange={(e) => setBrushOpacity(parseFloat(e.target.value))}\n                />\n            </div>\n            {dirty && (\n                <div className=\"form-group\" style={{ marginTop: \"16px\" }}>\n                    <button\n                        className=\"btn btn-secondary\"\n                        onClick={() => tool.cancel()}\n                    >\n                        Revert\n                    </button>\n                    <button\n                        className=\"btn btn-primary\"\n                        onClick={() => tool.confirm()}\n                        style={{ marginLeft: \"8px\" }}\n                    >\n                        Save\n                    </button>\n                </div>\n            )}\n        </div>\n    );\n};\n","import React, { FC, useState, useEffect } from \"react\";\n\ninterface Props {\n    selectedColor: string;\n    color: string;\n    onClick: (color: string) => void;\n}\n\nexport const PaletteButton: FC<Props> = ({ selectedColor, color, onClick }) => {\n    let className = \"palette-button\";\n    if (selectedColor === color) {\n        className += \" selected\";\n    } else if (color == \"#000000\") {\n        className += \" black\";\n    }\n    return (\n        <div\n            className={className}\n            style={{ backgroundColor: color }}\n            onClick={() => onClick(color)}\n        ></div>\n    );\n};\n","import React, { FC, useState, useEffect } from \"react\";\nimport { ChromePicker } from \"react-color\";\n\n// class ButtonExample extends React.Component {\n//   state = {\n//     displayColorPicker: false,\n//   };\n\n//   handleClick = () => {\n//     this.setState({ displayColorPicker: !this.state.displayColorPicker })\n//   };\n\n//   handleClose = () => {\n//     this.setState({ displayColorPicker: false })\n//   };\n\n//   render() {\n//     const popover = {\n//       position: 'absolute',\n//       zIndex: '2',\n//     }\n//     const cover = {\n//       position: 'fixed',\n//       top: '0px',\n//       right: '0px',\n//       bottom: '0px',\n//       left: '0px',\n//     }\n//     return (\n//       <div>\n//         <button onClick={ this.handleClick }>Pick Color</button>\n//         { this.state.displayColorPicker ? <div style={ popover }>\n//           <div style={ cover } onClick={ this.handleClose }/>\n//           <ChromePicker />\n//         </div> : null }\n//       </div>\n//     )\n//   }\n// }\n\ninterface Props {\n    color: string;\n    onColorSelected: (color: string) => void;\n}\n\nexport const ColorPicker: FC<Props> = ({ color, onColorSelected }) => {\n    const [displayColorPicker, setDisplayColorPicker] = useState(false);\n    const [tmpColor, setTmpColor] = useState(color);\n\n    const handleClick = () => {\n        setDisplayColorPicker(!displayColorPicker);\n        if (displayColorPicker) {\n            onColorSelected(tmpColor);\n        }\n    };\n\n    const handleClose = () => {\n        setDisplayColorPicker(false);\n        if (displayColorPicker) {\n            onColorSelected(tmpColor);\n        }\n    };\n\n    const popover: React.CSSProperties = {\n        position: \"absolute\",\n        zIndex: 2,\n    };\n    const cover: React.CSSProperties = {\n        position: \"fixed\",\n        top: \"0px\",\n        right: \"0px\",\n        bottom: \"0px\",\n        left: \"0px\",\n    };\n\n    return (\n        <>\n            <button className=\"color-picker\" onClick={handleClick}>\n                <i className=\"fas fa-plus\" />\n            </button>\n            {displayColorPicker ? (\n                <div style={popover}>\n                    <div style={cover} onClick={handleClose} />\n                    <ChromePicker\n                        color={tmpColor}\n                        onChange={(color) => setTmpColor(color.hex)}\n                        onChangeComplete={(color) => setTmpColor(color.hex)}\n                    />\n                </div>\n            ) : null}\n        </>\n    );\n};\n","import React, { FC, useEffect, useState } from \"react\";\nimport { ChromePicker } from \"react-color\";\n\nimport { Renderer } from \"./renderer\";\nimport { BaseTool, Tool } from \"./tool\";\nimport { ZoomHelper } from \"./zoomHelper\";\nimport { PaletteButton } from \"./PaletteButton\";\nimport { ColorPicker } from \"./ColorPicker\";\n\nconst defaultColors = [\n    \"#FFFFFF\",\n    \"#5A2C02\",\n    \"#386EB6\",\n    \"#6B31A1\",\n    \"#CB2C26\",\n    \"#000000\",\n    \"#888888\",\n    \"#50B050\",\n    \"#FBDB37\",\n    \"#E88D2D\",\n];\n\nexport class PencilTool extends BaseTool implements Tool {\n    private renderer: Renderer;\n    private zoomHelper: ZoomHelper;\n\n    private brushSize = 10;\n    private brushColor = defaultColors[0];\n    private palette: string[] = [...defaultColors];\n\n    private panning = false;\n    private isDrawing = false;\n    private lastX = 0;\n    private lastY = 0;\n    private colorPicking = false;\n    private lastPickedColor = \"#000000\";\n    private _dirty = false;\n\n    set dirty(dirty: boolean) {\n        this._dirty = dirty;\n        if (this.dirtyListener) {\n            this.dirtyListener(dirty);\n        }\n    }\n\n    get dirty() {\n        return this._dirty;\n    }\n\n\n    private dirtyListener?: (dirty: boolean) => void;\n    private colorPickedListener?: (color: string) => void;\n\n    constructor(renderer: Renderer) {\n        super(\"pencil\");\n        this.renderer = renderer;\n        this.zoomHelper = new ZoomHelper(renderer);\n    }\n\n    private sync() {\n        if (this.colorPicking) {\n            this.renderer.setCursor({\n                x: this.lastX,\n                y: this.lastY,\n                radius: this.renderer.getWidth() / 20,\n                color: this.lastPickedColor,\n                type: \"colorpicker\",\n            })\n        } else {\n            this.renderer.setCursor({\n                x: this.lastX,\n                y: this.lastY,\n                radius: this.brushSize / 2,\n                color: this.brushColor,\n                type: \"circle-fill\",\n            });\n        }\n        \n    }\n\n    updateArgs(args: any) {\n        super.updateArgs(args);\n        this.brushSize = args.brushSize || 10;\n        this.brushColor = args.brushColor || defaultColors[0];\n        this.palette = args.palette || [...defaultColors];\n        this.sync();\n    }\n\n    onMouseDown(event: React.MouseEvent<HTMLCanvasElement, MouseEvent>) {\n        if (this.colorPicking) {\n            return;\n        }\n        if (event.button === 0) {\n            let { x, y } = this.zoomHelper.translateMouseToCanvasCoordinates(\n                event.nativeEvent.offsetX,\n                event.nativeEvent.offsetY\n            );\n            this.renderer.drawPoint(x, y, this.brushSize, this.brushColor);\n            this.isDrawing = true;\n            this.lastX = x;\n            this.lastY = y;\n            this.dirty = true;\n        } else if (event.button === 1) {\n            this.panning = true;\n        }\n        this.sync();\n    }\n\n    onMouseMove(event: React.MouseEvent<HTMLCanvasElement, MouseEvent>): void {\n        let { x, y } = this.zoomHelper.translateMouseToCanvasCoordinates(\n            event.nativeEvent.offsetX,\n            event.nativeEvent.offsetY\n        );\n        if (this.colorPicking) {\n            this.lastPickedColor = this.renderer.getPixel(x, y);\n        } else if (this.panning) {\n            this.zoomHelper.onPan(event);\n        } else {\n            let { x, y } = this.zoomHelper.translateMouseToCanvasCoordinates(\n                event.nativeEvent.offsetX,\n                event.nativeEvent.offsetY\n            );\n            if (this.isDrawing) {\n                this.renderer.drawLine(\n                    this.lastX,\n                    this.lastY,\n                    x,\n                    y,\n                    this.brushSize,\n                    this.brushColor\n                );\n                this.dirty = true;\n            }\n        }\n        this.lastX = x;\n        this.lastY = y;\n        this.sync();\n    }\n\n    onMouseUp(event: React.MouseEvent<HTMLCanvasElement, MouseEvent>): void {\n        if (event.button === 0) {\n            this.isDrawing = false;\n            if (this.colorPicking) {\n                this.colorPicking = false;\n                this.brushColor = this.lastPickedColor;\n                if (this.colorPickedListener) {\n                    this.colorPickedListener(this.lastPickedColor);\n                }\n            }\n        } else if (event.button === 1) {\n            this.panning = false;\n        }\n        this.sync();\n    }\n\n    onWheel(event: WheelEvent) {\n        this.zoomHelper.onWheel(event);\n        this.sync();\n    }\n\n    cancel() {\n        // kind of a hack, clears the selection layer\n        this.renderer.setEditImage(null);\n        this.dirty = false;\n    }\n\n    confirm() {\n        this.renderer.commitSelection();\n        const encodedImage = this.renderer.getEncodedImage(null);\n        if (encodedImage && this.saveListener) {\n            this.saveListener(encodedImage);\n        }\n        this.dirty = false;\n    }\n\n    onSaveImage(listener: (encodedImage: string) => void): void {\n        this.saveListener = listener;\n    }\n\n    onDirty(listener: (dirty: boolean) => void): void {\n        this.dirtyListener = listener;\n    }\n\n    destroy(): boolean {\n        if (!this.dirty || window.confirm(\"Are you sure you want to discard your changes?\")) {\n            this.renderer.setCursor(undefined);\n            this.renderer.setEditImage(null);\n            return true;\n        }\n        return false;\n    }\n\n    beginColorpicker(): void {\n        this.colorPicking = true;\n        this.sync();\n    }\n\n    onColorPicked(listener: (color: string) => void): void {\n        this.colorPickedListener = listener;\n    }\n}\n\ninterface ControlsProps {\n    renderer: Renderer;\n    tool: PencilTool;\n}\n\nconst MAX_PALETTE_SIZE = 30;\n\nfunction addToPalette(palette: string[], color: string): string[] {\n    if (palette.indexOf(color) === -1) {\n        // insert at the beginning\n        palette = [color, ...palette];\n    }\n    if (palette.length > MAX_PALETTE_SIZE) {\n        palette = palette.slice(0, MAX_PALETTE_SIZE);\n    }\n    return palette;\n}\n\nexport const Controls: FC<ControlsProps> = ({ renderer, tool }) => {\n    const [brushSize, setBrushSize] = useState(10);\n    const [brushColor, setBrushColor] = useState(defaultColors[0]);\n    const [palette, setPalette] = useState(defaultColors);\n    const [dirty, setDirty] = useState(false);\n\n    tool.onDirty(setDirty);\n\n    useEffect(() => {\n        tool.updateArgs({\n            brushSize,\n            brushColor,\n            palette,\n        });\n    }, [brushSize, brushColor, palette]);\n\n    const onColorSelected = (color: string) => {\n        setBrushColor(color);\n        setPalette(addToPalette(palette, color));\n    };\n\n    tool.onColorPicked(onColorSelected);\n\n    return (\n        <div style={{ marginTop: \"16px\" }}>\n            <div className=\"form-group\">\n                <label style={{width: \"100%\"}}>\n                    Brush size\n                    <small className=\"form-text text-muted\" style={{float: \"right\"}}>\n                        {brushSize}px\n                    </small>\n                </label>\n                <input\n                    type=\"range\"\n                    className=\"form-control-range\"\n                    min=\"1\"\n                    max=\"100\"\n                    value={brushSize}\n                    onChange={(e) => setBrushSize(parseInt(e.target.value))}\n                />\n            </div>\n            <div\n                style={{\n                    display: \"flex\",\n                    flexDirection: \"row\",\n                    flexWrap: \"wrap\",\n                }}\n            >\n                {palette.map((color, i) => (\n                    <PaletteButton\n                        key={i}\n                        selectedColor={brushColor}\n                        color={color}\n                        onClick={(color) => setBrushColor(color)}\n                    />\n                ))}\n                {/* <div\n                    className=\"color-picker\"\n                    style={{ textAlign: \"center\", backgroundColor: \"#ccc\" }}\n                >\n                    <i className=\"fas fa-eye-dropper\" />\n                </div> */}\n                <button\n                    className=\"color-picker\"\n                    onClick={() => tool.beginColorpicker()}\n                >\n                    <i className=\"fas fa-eye-dropper\" />\n                </button>\n                <ColorPicker\n                    color={brushColor}\n                    onColorSelected={(color) => onColorSelected(color)}\n                />\n            </div>\n            {dirty && (\n                <div className=\"form-group\" style={{ marginTop: \"16px\" }}>\n                    <button\n                        className=\"btn btn-secondary\"\n                        onClick={() => tool.cancel()}\n                    >\n                        Revert\n                    </button>\n                    <button\n                        className=\"btn btn-primary\"\n                        onClick={() => tool.confirm()}\n                        style={{ marginLeft: \"8px\" }}\n                    >\n                        Save\n                    </button>\n                </div>\n            )}\n        </div>\n    );\n};\n\n// TODO list:\n// reset to initial colors\n// color picker\n// eyedropper\n// color history\n\n// zoom/pan\n// actual drawing\n// undo/redo\n// save\n// revert\n"],"sourceRoot":""}